<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>System Notes</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2016-05-12T14:25:55.584Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Wu Dong</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Journal-guided Resynchronization for Software RAID</title>
    <link href="http://yoursite.com/2016/05/12/journal-guided-resync-for-sraid/"/>
    <id>http://yoursite.com/2016/05/12/journal-guided-resync-for-sraid/</id>
    <published>2016-05-12T14:24:38.000Z</published>
    <updated>2016-05-12T14:25:55.584Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x8BE5;&amp;#x6587;&amp;#x7AE0;&amp;#x4E3B;&amp;#x8981;&amp;#x8BB2;&amp;#x628A;&amp;#x65E5;&amp;#x5FD7;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF08;&amp;#x5982;ext3&amp;#xFF09;&amp;#x4E0E;&amp;#x5E95;&amp;#x5C42;&amp;#x7684;&amp;#x8F6F;raid&amp;#x7ED3;&amp;#x5408;&amp;#x8D77;&amp;#x6765;&amp;#xFF0C;&amp;#x5F15;&amp;#x5165;declared mode&amp;#xFF0C;&amp;#x5728;&amp;#x5199;&amp;#x5165;&amp;#x6570;&amp;#x636E;&amp;#x524D;&amp;#xFF0C;&amp;#x5148;&amp;#x8BB0;&amp;#x5F55;&amp;#x65E5;&amp;#x5FD7;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5728;&amp;#x610F;&amp;#x5916;&amp;#x5D29;&amp;#x6E83;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x80FD;&amp;#x591F;&amp;#x6839;&amp;#x636E;&amp;#x65E5;&amp;#x5FD7;&amp;#x6765;&amp;#x5224;&amp;#x65AD;&amp;#x54EA;&amp;#x4E9B;&amp;#x6570;&amp;#x636E;&amp;#x662F;&amp;#x4E0D;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x51CF;&amp;#x5C11;&amp;#x4E86;&amp;#x5168;&amp;#x91CF;&amp;#x540C;&amp;#x6B65;&amp;#xFF0C;&amp;#x7F29;&amp;#x77ED;&amp;#x4E86;&amp;#x5904;&amp;#x4E8E;&amp;#x6545;&amp;#x969C;&amp;#x6062;&amp;#x590D;&amp;#x72B6;&amp;#x6001;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x5B9E;&amp;#x73B0;&amp;#x8FD9;&amp;#x4E2A;&amp;#x529F;&amp;#x80FD;&amp;#xFF0C;&amp;#x4E3A;&amp;#x8F6F;raid&amp;#x589E;&amp;#x52A0;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;&amp;#x63A5;&amp;#x53E3;&amp;#xFF0C;verify read&amp;#xFF0C;&amp;#x5728;&amp;#x6536;&amp;#x5230;&amp;#x8FD9;&amp;#x79CD;&amp;#x8BF7;&amp;#x6C42;&amp;#x65F6;&amp;#xFF0C;&amp;#x5148;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x6821;&amp;#x9A8C;&amp;#x5224;&amp;#x65AD;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x4E0D;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x5219;&amp;#x91CD;&amp;#x5199;&amp;#x955C;&amp;#x50CF;&amp;#x6216;&amp;#x6821;&amp;#x9A8C;&amp;#x6570;&amp;#x636E;&amp;#x6765;&amp;#x4FDD;&amp;#x6301;&amp;#x4E00;&amp;#x81F4;&amp;#x3002;&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x628A;&amp;#x65E5;&amp;#x5FD7;&amp;#x8BB0;&amp;#x5F55;&amp;#x5230;&amp;#x8BE5;&amp;#x9635;&amp;#x5217;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4F1A;&amp;#x964D;&amp;#x4F4E;&amp;#x9635;&amp;#x5217;&amp;#x7684;&amp;#x6027;&amp;#x80FD;&amp;#xFF0C;&amp;#x9AD8;&amp;#x7AEF;&amp;#x9635;&amp;#x5217;&amp;#x4E00;&amp;#x822C;&amp;#x662F;&amp;#x91C7;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;NVRAM&amp;#x6765;&amp;#x8BB0;&amp;#x5F55;&amp;#x65E5;&amp;#x5FD7;&amp;#xFF0C;&lt;br&gt;&amp;#x53E6;&amp;#x4E00;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x628A;&amp;#x65E5;&amp;#x5FD7;&amp;#x8BB0;&amp;#x5F55;&amp;#x5230;&amp;#x9635;&amp;#x5217;&amp;#x7684;bitmap&amp;#x4E2D;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x6837;&amp;#x90FD;&amp;#x4F1A;&amp;#x5F71;&amp;#x54CD;&amp;#x6027;&amp;#x80FD;&amp;#x3002;&amp;#xFF08;&amp;#x5C31;&amp;#x662F;mdraid&amp;#x7684;bitmap&amp;#x673A;&amp;#x5236;&amp;#xFF0C;&lt;a href=&quot;http://www.linuxsymposium.org/archives/OLS/Reprints-2003/LinuxSymposium2003.pdf#page=109&amp;#xFF09;&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.linuxsymposium.org/archives/OLS/Reprints-2003/LinuxSymposium2003.pdf#page=109&amp;#xFF09;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x7BC7;&amp;#x6587;&amp;#x7AE0;&amp;#x4E3B;&amp;#x8981;&amp;#x8BB2;&amp;#x7684;&amp;#x5C31;&amp;#x662F;&amp;#x5229;&amp;#x7528;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x6062;&amp;#x590D;&amp;#x673A;&amp;#x5236;&amp;#xFF0C;&amp;#x6765;&amp;#x89E3;&amp;#x51B3;&amp;#x8F6F;raid&amp;#x5D29;&amp;#x6E83;&amp;#x65F6;&amp;#x5168;&amp;#x91CF;&amp;#x540C;&amp;#x6B65;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x662F;&amp;#x57FA;&amp;#x4E8E;&amp;#x65E5;&amp;#x5FD7;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF08;&amp;#x5982;ext3&amp;#x4E4B;&amp;#x7C7B;&amp;#x7684;&amp;#xFF09;&amp;#xFF0C;&amp;#x5728;&amp;#x5199;&amp;#x6570;&amp;#x636E;&amp;#x5230;&amp;#x78C1;&amp;#x76D8;&amp;#x4E4B;&amp;#x524D;&amp;#xFF0C;&amp;#x5148;&amp;#x8BB0;&amp;#x5F55;&amp;#x65E5;&amp;#x5FD7;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x5199;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x5199;&amp;#x6210;&amp;#x529F;&amp;#x540E;&amp;#x518D;&amp;#x8BB0;&amp;#x5F55;commit&amp;#x65E5;&amp;#x5FD7;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x5728;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5D29;&amp;#x6E83;&amp;#x65F6;&amp;#x53EF;&amp;#x4EE5;&amp;#x6839;&amp;#x636E;&amp;#x65E5;&amp;#x5FD7;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x6062;&amp;#x590D;&amp;#xFF0C;&amp;#x65E5;&amp;#x5FD7;&amp;#x4E2D;&amp;#x5DF2;&amp;#x7ECF;commit&amp;#x6210;&amp;#x529F;&amp;#x7684;&amp;#x662F;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x6062;&amp;#x590D;&amp;#x7684;&amp;#x3002;&lt;br&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x5229;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;&amp;#x673A;&amp;#x5236;&amp;#xFF0C;&amp;#x4E3A;&amp;#x8F6F;raid&amp;#x5F15;&amp;#x5165;veryfy read&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x6062;&amp;#x590D;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5411;&amp;#x8F6F;raid&amp;#x53D1;veryfy read&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5728;buffer head&amp;#x4E2D;&amp;#x589E;&amp;#x52A0;&amp;#x4E00;&amp;#x4E2A;raid synchronize&amp;#x7684;&amp;#x6807;&amp;#x8BB0;&amp;#xFF0C;&amp;#x8F6F;raid&amp;#x5728;&amp;#x6536;&amp;#x5230;&amp;#x5E26;&amp;#x6709;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6807;&amp;#x8BB0;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x65F6;&amp;#xFF0C;&amp;#x624D;&amp;#x8FDB;&amp;#x884C;&amp;#x68C0;&amp;#x67E5;&amp;#xFF08;raid1&amp;#x662F;&amp;#x68C0;&amp;#x67E5;&amp;#x6E90;&amp;#x76D8;&amp;#x548C;&amp;#x955C;&amp;#x50CF;&amp;#x76D8;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x662F;&amp;#x5426;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;raid5&amp;#x662F;&amp;#x68C0;&amp;#x67E5;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#x548C;&amp;#x7531;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x8BA1;&amp;#x7B97;&amp;#x7684;&amp;#x6821;&amp;#x9A8C;&amp;#x503C;&amp;#x662F;&amp;#x5426;&amp;#x4E00;&amp;#x81F4;&amp;#xFF09;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;&amp;#x5C31;&amp;#x8FDB;&amp;#x884C;&amp;#x540C;&amp;#x6B65;&amp;#xFF08;raid1&amp;#x8BA9;&amp;#x5404;&amp;#x4E2A;&amp;#x955C;&amp;#x50CF;&amp;#x76D8;&amp;#x7684;&amp;#x5BF9;&amp;#x5E94;&amp;#x6570;&amp;#x636E;&amp;#x4E00;&amp;#x6837;&amp;#xFF0C;raid5&amp;#x662F;&amp;#x5C06;&amp;#x65B0;&amp;#x8BA1;&amp;#x7B97;&amp;#x7684;&amp;#x6821;&amp;#x9A8C;&amp;#x503C;&amp;#x5199;&amp;#x5165;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#x4E2D;&amp;#xFF09;&amp;#x3002;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x907F;&amp;#x514D;&amp;#x4E86;&amp;#x8F6F;raid&amp;#x5D29;&amp;#x6E83;&amp;#x65F6;&amp;#xFF0C;&amp;#x5168;&amp;#x76D8;&amp;#x626B;&amp;#x63CF;&amp;#x8FDB;&amp;#x884C;&amp;#x6BD4;&amp;#x5BF9;&amp;#x4E86;&amp;#x3002;&lt;br&gt;&amp;#x5C40;&amp;#x9650;&amp;#x5728;&amp;#x4E8E;&amp;#xFF1A;&lt;br&gt;1&amp;#xFF09;&amp;#x5FC5;&amp;#x987B;&amp;#x662F;&amp;#x57FA;&amp;#x4E8E;&amp;#x65E5;&amp;#x5FD7;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x5FC5;&amp;#x987B;&amp;#x662F;&amp;#x8F6F;raid&amp;#x4E0A;&amp;#x5EFA;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8F6F;raid&amp;#x4E0A;&amp;#x6CA1;&amp;#x6709;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x800C;&amp;#x76F4;&amp;#x63A5;&amp;#x88F8;&amp;#x76D8;&amp;#x4F7F;&amp;#x7528;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x4E0D;&amp;#x9002;&amp;#x7528;&amp;#x3002;&lt;br&gt;2&amp;#xFF09;&amp;#x5BF9;&amp;#x4E8E;&amp;#x8DE8;&amp;#x7F51;&amp;#x7EDC;&amp;#x7684;&amp;#x8F6F;raid&amp;#xFF08;&amp;#x4F7F;&amp;#x7528;iscsi&amp;#x6216;nbd&amp;#x7B49;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF09;&amp;#xFF0C;&amp;#x6587;&amp;#x7AE0;&amp;#x4E2D;&amp;#x7684;&amp;#x5728;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E0A;&amp;#x52A0;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;synchronize&amp;#x6807;&amp;#x8BB0;&amp;#x8FD8;&amp;#x4E0D;&amp;#x4E00;&amp;#x5B9A;&amp;#x53EF;&amp;#x884C;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x9700;&amp;#x8981;iscsi&amp;#x534F;&amp;#x8BAE;&amp;#x6216;nbd&amp;#x91CC;&amp;#x6709;&amp;#x7A7A;&amp;#x95F2;&amp;#x5B57;&amp;#x6BB5;&amp;#x7528;&amp;#x4E8E;&amp;#x5B58;&amp;#x653E;synchronize&amp;#x6807;&amp;#x8BB0;&amp;#x624D;&amp;#x884C;&amp;#x3002;&lt;br&gt;&amp;#x503C;&amp;#x5F97;&amp;#x501F;&amp;#x9274;&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#xFF1A;&lt;br&gt;1&amp;#xFF09;&amp;#x80FD;&amp;#x591F;&amp;#x6839;&amp;#x636E;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x7C7B;&amp;#x578B;&amp;#x6765;&amp;#x5224;&amp;#x65AD;&amp;#x662F;&amp;#x5426;&amp;#x8FDB;&amp;#x884C;&amp;#x8F6F;raid&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x6062;&amp;#x590D;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x662F;&amp;#x8FDB;&amp;#x884C;&amp;#x5168;&amp;#x76D8;&amp;#x626B;&amp;#x63CF;&amp;#xFF1B;&lt;br&gt;2&amp;#xFF09;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E91;&amp;#x786C;&amp;#x76D8;&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x76EE;&amp;#x524D;&amp;#x91C7;&amp;#x7528;&amp;#x7684;bitmap&amp;#x673A;&amp;#x5236;&amp;#x5176;&amp;#x5B9E;&amp;#x5C31;&amp;#x662F;&amp;#x628A;&amp;#x65E5;&amp;#x5FD7;&amp;#x8BB0;&amp;#x5F55;&amp;#x5230;bitmap&amp;#x4E2D;&amp;#xFF08;&amp;#x6587;&amp;#x7AE0;&amp;#x4E2D;&amp;#x4E5F;&amp;#x6709;&amp;#x63D0;&amp;#x5230;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x5728;&amp;#x6574;&amp;#x4E2A;&amp;#x673A;&amp;#x623F;&amp;#x65AD;&amp;#x7535;&amp;#x91CD;&amp;#x542F;&amp;#x8FD9;&amp;#x79CD;&amp;#x6781;&amp;#x7AEF;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;bitmap&amp;#x4E5F;&amp;#x4E22;&amp;#x5931;&amp;#x4E0D;&amp;#x53EF;&amp;#x7528;&amp;#x4E86;&amp;#xFF0C;&amp;#x76EE;&amp;#x524D;&amp;#x5C31;&amp;#x53EA;&amp;#x80FD;&amp;#x5168;&amp;#x76D8;&amp;#x626B;&amp;#x63CF;&amp;#x8FDB;&amp;#x884C;&amp;#x540C;&amp;#x6B65;&amp;#xFF08;&amp;#x8FD9;&amp;#x91CC;&amp;#x7684;&amp;#x5168;&amp;#x76D8;&amp;#x626B;&amp;#x63CF;&amp;#x8FDB;&amp;#x884C;&amp;#x540C;&amp;#x6B65;&amp;#x662F;&amp;#x76F4;&amp;#x63A5;&amp;#x5C06;&amp;#x4E00;&amp;#x5757;&amp;#x76D8;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5B8C;&amp;#x5168;&amp;#x62F7;&amp;#x8D1D;&amp;#x5230;&amp;#x53E6;&amp;#x4E00;&amp;#x5757;&amp;#x76D8;&amp;#xFF0C;&amp;#x8FD8;&amp;#x662F;&amp;#x9700;&amp;#x8981;&amp;#x6839;&amp;#x636E;chunk&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x8FDB;&amp;#x884C;&amp;#x6BD4;&amp;#x5BF9;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x4E00;&amp;#x6837;&amp;#x7684;&amp;#xFF0C;&amp;#x5C31;&amp;#x4E0D;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x62F7;&amp;#x8D1D;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x4E5F;&amp;#x5FC5;&amp;#x987B;&amp;#x5148;&amp;#x4ECE;&amp;#x4E24;&amp;#x4E2A;&amp;#x955C;&amp;#x50CF;&amp;#x4E2D;&amp;#x90FD;&amp;#x8BFB;&amp;#x51FA;&amp;#x6570;&amp;#x636E;&amp;#x6765;&amp;#xFF0C;&amp;#x76EE;&amp;#x524D;&amp;#x8BA4;&amp;#x4E3A;&amp;#x662F;&amp;#x7B2C;&amp;#x4E8C;&amp;#x79CD;&amp;#xFF09;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x6211;&amp;#x4EEC;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;extern bitmap&amp;#xFF0C;&amp;#x8FD9;&amp;#x79CD;&amp;#x6781;&amp;#x7AEF;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;bitmap&amp;#x4E0D;&amp;#x53EF;&amp;#x7528;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;intern bitmap&amp;#xFF0C;&amp;#x90A3;&amp;#x5BF9;&amp;#x4E8E;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x4E5F;&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0D;&amp;#x7528;&amp;#x5168;&amp;#x91CF;&amp;#x540C;&amp;#x6B65;&amp;#x7684;&amp;#xFF0C;&amp;#x53EA;&amp;#x4E0D;&amp;#x8FC7;intern bitmap&amp;#x662F;&amp;#x5B58;&amp;#x653E;&amp;#x5728;&amp;#x9635;&amp;#x5217;&amp;#x672C;&amp;#x8EAB;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6B63;&amp;#x5E38;&amp;#x8BF7;&amp;#x6C42;&amp;#x6765;&amp;#x8BF4;&amp;#x5F00;&amp;#x9500;&amp;#x8F83;&amp;#x5927;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x8BE5;&amp;#x6587;&amp;#x7AE0;&amp;#x4E3B;&amp;#x8981;&amp;#x8BB2;&amp;#x628A;&amp;#x65E5;&amp;#x5FD7;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF08;&amp;#x5982;ext3&amp;#xFF09;&amp;#x4E
    
    </summary>
    
      <category term="paper" scheme="http://yoursite.com/categories/paper/"/>
    
    
      <category term="paper" scheme="http://yoursite.com/tags/paper/"/>
    
  </entry>
  
  <entry>
    <title>文件系统磁盘布局与I/O映射</title>
    <link href="http://yoursite.com/2016/05/12/fs-io-map/"/>
    <id>http://yoursite.com/2016/05/12/fs-io-map/</id>
    <published>2016-05-12T14:09:16.000Z</published>
    <updated>2016-05-12T14:22:07.811Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4E3B;&amp;#x8981;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&amp;#x8FDB;&amp;#x884C;&amp;#x6982;&amp;#x8981;&amp;#x7684;&amp;#x68B3;&amp;#x7406;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x6B64;&amp;#x57FA;&amp;#x7840;&amp;#x4E0A;&amp;#x5206;&amp;#x6790;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x673A;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;a href=&quot;#1-&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;/a&gt;1.&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&lt;/h1&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C42;&amp;#x9762;&amp;#x6765;&amp;#x9610;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0E;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5173;&amp;#x7CFB;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot;&gt;&lt;a href=&quot;#1-1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot; class=&quot;headerlink&quot; title=&quot;1.1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot;&gt;&lt;/a&gt;1.1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&lt;/h2&gt;&lt;p&gt;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5728;&amp;#x8BBF;&amp;#x95EE;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;&amp;#x90FD;&amp;#x4F1A;&amp;#x5148;&amp;#x6253;&amp;#x5F00;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#xFF0C;&amp;#x90FD;&amp;#x4F1A;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x8868;&amp;#x793A;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;&amp;#x4E0D;&amp;#x80FD;&amp;#x76F4;&amp;#x63A5;&amp;#x8BBF;&amp;#x95EE;&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;,&amp;#x800C;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x7684;&amp;#x7D22;&amp;#x5F15;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A;&amp;#x6574;&amp;#x6570;&amp;#xFF09;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x7D22;&amp;#x5F15;&amp;#x5C31;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x3002;&amp;#x5F53;&amp;#x8C03;&amp;#x7528;open &amp;#x6253;&amp;#x5F00;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x6216;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;,&amp;#x5185;&amp;#x6838;&amp;#x5206;&amp;#x914D;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x5E76;&amp;#x8FD4;&amp;#x56DE;&amp;#x7ED9;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;,&amp;#x8BE5;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x9879;&amp;#x4E2D;&amp;#x7684;&amp;#x6307;&amp;#x9488;&amp;#x6307;&amp;#x5411;&amp;#x65B0;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x8868;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E00;&amp;#x9879;&amp;#x90FD;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x6307;&amp;#x9488;&amp;#xFF0C;&amp;#x6307;&amp;#x5411;&amp;#x4E00;&amp;#x4E2A;&amp;#x7528;&amp;#x4E8E;&amp;#x63CF;&amp;#x8FF0;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x2013;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E2D;&amp;#x63CF;&amp;#x8FF0;&amp;#x4E86;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6253;&amp;#x5F00;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF0C;&amp;#x8BFB;&amp;#x5199;&amp;#x4F4D;&amp;#x7F6E;&amp;#x7B49;&amp;#x91CD;&amp;#x8981;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x5F53;&amp;#x8FDB;&amp;#x7A0B;&amp;#x6253;&amp;#x5F00;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;&amp;#xFF0C;&amp;#x5185;&amp;#x6838;&amp;#x5C31;&amp;#x4F1A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;file&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;&amp;#x9700;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x662F;&amp;#xFF0C;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E0D;&amp;#x662F;&amp;#x4E13;&amp;#x5C5E;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x7684;&amp;#xFF0C;&amp;#x4E0D;&amp;#x540C;&amp;#x8FDB;&amp;#x7A0B;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x4E2D;&amp;#x7684;&amp;#x6307;&amp;#x9488;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5411;&amp;#x76F8;&amp;#x540C;&amp;#x7684;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x5171;&amp;#x4EAB;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;file&amp;#x5BF9;&amp;#x8C61;&amp;#x6709;&amp;#x5F15;&amp;#x7528;&amp;#x8BA1;&amp;#x6570;&amp;#xFF0C;&amp;#x8BB0;&amp;#x5F55;&amp;#x4E86;&amp;#x5F15;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5BF9;&amp;#x8C61;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x5F53;&amp;#x5F15;&amp;#x7528;&amp;#x8BA1;&amp;#x6570;&amp;#x4E3A;0&amp;#x65F6;&amp;#xFF0C;&amp;#x5185;&amp;#x6838;&amp;#x624D;&amp;#x9500;&amp;#x6BC1;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x67D0;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x5173;&amp;#x95ED;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x4E0D;&amp;#x5F71;&amp;#x54CD;&amp;#x4E0E;&amp;#x4E4B;&amp;#x5171;&amp;#x4EAB;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;file&amp;#x5BF9;&amp;#x8C61;&amp;#x7684;&amp;#x8FDB;&amp;#x7A0B;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E2D;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6307;&amp;#x9488;&amp;#xFF0C;&amp;#x6307;&amp;#x5411;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x4EE3;&amp;#x8868;&amp;#x4E00;&amp;#x4E2A;&amp;#x72EC;&amp;#x7ACB;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x8DEF;&amp;#x5F84;&amp;#x88AB;&amp;#x6253;&amp;#x5F00;&amp;#x591A;&amp;#x6B21;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4F1A;&amp;#x5EFA;&amp;#x7ACB;&amp;#x591A;&amp;#x4E2A;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x4F46;&amp;#x5B83;&amp;#x4EEC;&amp;#x90FD;&amp;#x6307;&amp;#x5411;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;inode&amp;#x5BF9;&amp;#x8C61;&amp;#x4EE3;&amp;#x8868;&amp;#x4E00;&amp;#x4E2A;&amp;#x72EC;&amp;#x7ACB;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;inode &amp;#x5BF9;&amp;#x8C61;&amp;#x5305;&amp;#x542B;&amp;#x4E86;&amp;#x6700;&amp;#x7EC8;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x8FDB;&amp;#x884C;&amp;#x64CD;&amp;#x4F5C;&amp;#x6240;&amp;#x9700;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x5982;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7C7B;&amp;#x578B;&amp;#x3001;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#x65B9;&amp;#x6CD5;&amp;#x3001;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6743;&amp;#x9650;&amp;#x3001;&amp;#x8BBF;&amp;#x95EE;&amp;#x65E5;&amp;#x671F;&amp;#x7B49;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/inode.png&quot; alt=&quot;inode&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-2&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;a href=&quot;#1-2&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot; class=&quot;headerlink&quot; title=&quot;1.2&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;/a&gt;1.2&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&lt;/h2&gt;&lt;p&gt;&amp;#x5728;&amp;#x4E86;&amp;#x89E3;&amp;#x4E86;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0E;inode&amp;#x7684;&amp;#x5BF9;&amp;#x5E94;&amp;#x5173;&amp;#x7CFB;&amp;#x540E;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x9610;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0E;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x5148;&amp;#x7406;&amp;#x89E3;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&amp;#x3002;&amp;#x4E0B;&amp;#x56FE;&amp;#x662F;ext2/ext3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/fs2disk.png&quot; alt=&quot;fs2disk&quot;&gt;&lt;br&gt;ext3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C06;&amp;#x5176;&amp;#x6240;&amp;#x7BA1;&amp;#x7406;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x6216;&amp;#x8005;&amp;#x5206;&amp;#x533A;(&amp;#x5F15;&amp;#x5BFC;&amp;#x5757;&amp;#x9664;&amp;#x5916;)&amp;#x4E2D;&amp;#x7684;&amp;#x5757;&amp;#x5212;&amp;#x5206;&amp;#x5230;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x5757;&amp;#x7EC4;&amp;#x4E2D;&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x7EC4;&amp;#x5927;&amp;#x5C0F;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x5F53;&amp;#x7136;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x4E2A;&amp;#x5757;&amp;#x7EC4;&amp;#x6240;&amp;#x7BA1;&amp;#x7406;&amp;#x7684;&amp;#x5757;&amp;#x53EF;&amp;#x80FD;&amp;#x4F1A;&amp;#x5C11;&amp;#x4E00;&amp;#x4E9B;&amp;#xFF0C;&amp;#x5176;&amp;#x5927;&amp;#x5C0F;&amp;#x5728;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x521B;&amp;#x5EFA;&amp;#x65F6;&amp;#x51B3;&amp;#x5B9A;&amp;#xFF0C;&amp;#x4E3B;&amp;#x8981;&amp;#x53D6;&amp;#x51B3;&amp;#x4E8E;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x7EC4;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E2A;&amp;#x5757;&amp;#x4F4D;&amp;#x56FE;&amp;#x5757;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;inode&amp;#x4F4D;&amp;#x56FE;&amp;#x5757;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x5757;&amp;#x7528;&amp;#x4E8E;&amp;#x63CF;&amp;#x8FF0; inode &amp;#x8868;&amp;#x548C;&amp;#x7528;&amp;#x4E8E;&amp;#x5B58;&amp;#x50A8;&amp;#x6587;&amp;#x4EF6;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#xFF0C;&amp;#x9664;&amp;#x6B64;&amp;#x4E4B;&amp;#x5916;&amp;#xFF0C;&amp;#x8FD8;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x5305;&amp;#x542B;&amp;#x8D85;&amp;#x7EA7;&amp;#x5757;&amp;#x548C;&amp;#x6240;&amp;#x6709;&amp;#x5757;&amp;#x7EC4;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x3002;&lt;br&gt;&amp;#x5757;&amp;#x4F4D;&amp;#x56FE;&amp;#x7528;&amp;#x4E8E;&amp;#x63CF;&amp;#x8FF0;&amp;#x8BE5;&amp;#x5757;&amp;#x7EC4;&amp;#x6240;&amp;#x7BA1;&amp;#x7406;&amp;#x7684;&amp;#x5757;&amp;#x7684;&amp;#x5206;&amp;#x914D;&amp;#x72B6;&amp;#x6001;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x67D0;&amp;#x4E2A;&amp;#x5757;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x4F4D;&amp;#x672A;&amp;#x7F6E;&amp;#x4F4D;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4EE3;&amp;#x8868;&amp;#x8BE5;&amp;#x5757;&amp;#x672A;&amp;#x5206;&amp;#x914D;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x8FDB;&amp;#x884C;&amp;#x5206;&amp;#x914D;&amp;#x4F7F;&amp;#x7528;&amp;#x3002;inode&amp;#x4F4D;&amp;#x56FE;&amp;#x7528;&amp;#x4E8E;&amp;#x63CF;&amp;#x8FF0;&amp;#x8BE5;&amp;#x5757;&amp;#x7EC4;&amp;#x6240;&amp;#x7BA1;&amp;#x7406;&amp;#x7684;inode&amp;#x7684;&amp;#x5206;&amp;#x914D;&amp;#x72B6;&amp;#x6001;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;inode&amp;#x5BF9;&amp;#x5E94;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4E2D;&amp;#x552F;&amp;#x4E00;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x53F7;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;inode&amp;#x4F4D;&amp;#x56FE;&amp;#x4E2D;&amp;#x76F8;&amp;#x5E94;&amp;#x4F4D;&amp;#x7F6E;&amp;#x4F4D;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4EE3;&amp;#x8868;&amp;#x8BE5;inode&amp;#x5DF2;&amp;#x7ECF;&amp;#x5206;&amp;#x914D;&amp;#x51FA;&amp;#x53BB;&amp;#xFF1B;&amp;#x5426;&amp;#x5219;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x6620;&amp;#x5C04;&quot;&gt;&lt;a href=&quot;#1-3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x6620;&amp;#x5C04;&quot; class=&quot;headerlink&quot; title=&quot;1.3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x6620;&amp;#x5C04;&quot;&gt;&lt;/a&gt;1.3&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x6620;&amp;#x5C04;&lt;/h2&gt;&lt;p&gt;&amp;#x4E0B;&amp;#x9762;&amp;#x5C31;&amp;#x6765;&amp;#x9610;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0E;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x5173;&amp;#x7CFB;&amp;#x3002;&lt;br&gt;ext2/ext3&amp;#x91C7;&amp;#x7528;&amp;#x7684;&amp;#x662F;&amp;#x76F4;&amp;#x63A5;+&amp;#x95F4;&amp;#x63A5;&amp;#x65B9;&amp;#x5F0F;&amp;#x6765;&amp;#x5B58;&amp;#x50A8;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5730;&amp;#x5740;&amp;#x6620;&amp;#x5C04;&amp;#xFF1A;&amp;#x5176;&amp;#x4E2D;0~11&amp;#x662F;&amp;#x5B58;&amp;#x50A8;&amp;#x7528;&amp;#x6237;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x53F7;(&amp;#x76F4;&amp;#x63A5;&amp;#x5BFB;&amp;#x5740;)&amp;#xFF0C;12&amp;#x662F;&amp;#x5B58;&amp;#x50A8;&amp;#x4E00;&amp;#x7EA7;&amp;#x5730;&amp;#x5740;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x5730;&amp;#x5740;(&amp;#x4E00;&amp;#x7EA7;&amp;#x95F4;&amp;#x63A5;&amp;#x5BFB;&amp;#x5740;)&amp;#xFF0C;&amp;#x5730;&amp;#x5740;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x4E2D;&amp;#x7684;&amp;#x6BCF;&amp;#x4E00;&amp;#x9879;&amp;#x90FD;&amp;#x662F;&amp;#x53E6;&amp;#x5916;&amp;#x4E00;&amp;#x4E2A;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x53F7;&amp;#x3002;13&amp;#x5B58;&amp;#x50A8;&amp;#x4E8C;&amp;#x7EA7;&amp;#x5730;&amp;#x5740;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x5730;&amp;#x5740;&amp;#xFF0C;14&amp;#x5B58;&amp;#x50A8;&amp;#x4E09;&amp;#x7EA7;&amp;#x5730;&amp;#x5740;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x5730;&amp;#x5740;&amp;#x3002;&amp;#x8FD9;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x5BF9;&amp;#x4E8E;&amp;#x5C0F;&amp;#x6587;&amp;#x4EF6;&amp;#x6BD4;&amp;#x8F83;&amp;#x5408;&amp;#x9002;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x5927;&amp;#x6587;&amp;#x4EF6;&amp;#x6765;&amp;#x8BF4;&amp;#x8981;&amp;#x7ECF;&amp;#x8FC7;&amp;#x5F88;&amp;#x591A;&amp;#x6B21;&amp;#x95F4;&amp;#x63A5;&amp;#x5BFB;&amp;#x5740;&amp;#xFF0C;&amp;#x6548;&amp;#x7387;&amp;#x5F88;&amp;#x4F4E;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/ext3-map.png&quot; alt=&quot;ext3-map&quot;&gt;&lt;br&gt;&amp;#x800C;ext4&amp;#x5219;&amp;#x91C7;&amp;#x7528;&amp;#x7684;&amp;#x662F;extents&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF1A;[logicalStartBlock,physicalStartBlock, blockCount]&amp;#x3002;ext4&amp;#x4E2D;&amp;#x4E00;&amp;#x4E2A;inode&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;256Bytes&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x4E00;&amp;#x4E2A;inode&amp;#x80FD;&amp;#x5BB9;&amp;#x7EB3;&amp;#x7684;extent&amp;#x6709;&amp;#x9650;&amp;#xFF0C;&amp;#x5F53;&amp;#x6587;&amp;#x4EF6;&amp;#x589E;&amp;#x5927;&amp;#x5230;&amp;#x4E00;&amp;#x5B9A;&amp;#x7A0B;&amp;#x5EA6;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;extent&amp;#x65E0;&amp;#x6CD5;&amp;#x4EE5;&amp;#x6570;&amp;#x7EC4;&amp;#x5F62;&amp;#x5F0F;&amp;#x5B58;&amp;#x653E;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x4EE5;B+tree&amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#x5B58;&amp;#x653E;&amp;#x3002;&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;ext3&amp;#x7684;&amp;#x95F4;&amp;#x63A5;&amp;#x6620;&amp;#x5C04;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;extents&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x589E;&amp;#x52A0;&amp;#x4E86;&amp;#x5927;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6548;&amp;#x7387;&amp;#x5E76;&amp;#x51CF;&amp;#x5C11;&amp;#x4E86;&amp;#x5206;&amp;#x88C2;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/ext4-map.png&quot; alt=&quot;ext4-map&quot;&gt;&lt;br&gt;&amp;#x901A;&amp;#x8FC7;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x9610;&amp;#x8FF0;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x77E5;&amp;#x9053;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x548C;&amp;#x5177;&amp;#x4F53;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x7684;&amp;#x5BF9;&amp;#x5E94;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x95EE;&amp;#x9898;&amp;#x6765;&amp;#x4E86;&amp;#xFF1A;&amp;#x7528;&amp;#x6237;&amp;#x4EE5;4KB&amp;#x5927;&amp;#x5C0F;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x5199;&amp;#x4E00;&amp;#x4E2A;I/O&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x78C1;&amp;#x76D8;&amp;#x6765;&amp;#x8BF4;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;I/O&amp;#x5417;&amp;#xFF1F;&amp;#x5982;&amp;#x679C;&amp;#x91C7;&amp;#x7528;direct&amp;#x65B9;&amp;#x5F0F;&amp;#x5462;&amp;#xFF1F;&amp;#x5982;&amp;#x679C;&amp;#x662F;16KB&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x7528;&amp;#x6237;I/O&amp;#x5462;&amp;#xFF1F;&amp;#x4E0B;&amp;#x9762;&amp;#x5C31;&amp;#x4ECE;&amp;#x6587;&amp;#x4EF6;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x673A;&amp;#x5236;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x9610;&amp;#x8FF0;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-&amp;#x6587;&amp;#x4EF6;I-O&amp;#x5230;&amp;#x5757;I-O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&quot;&gt;&lt;a href=&quot;#2-&amp;#x6587;&amp;#x4EF6;I-O&amp;#x5230;&amp;#x5757;I-O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x6587;&amp;#x4EF6;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&quot;&gt;&lt;/a&gt;2.&amp;#x6587;&amp;#x4EF6;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&lt;/h1&gt;&lt;p&gt;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x521B;&amp;#x5EFA;&amp;#x65F6;&amp;#x4F1A;&amp;#x6307;&amp;#x5B9A;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;512,1024,2048,4096&amp;#x5B57;&amp;#x8282;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x4F1A;&amp;#x6839;&amp;#x636E;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x548C;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x5207;&amp;#x5206;&amp;#x6210;&amp;#x5404;&amp;#x4E2A;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#xFF0C;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C31;&amp;#x4F1A;&amp;#x4E3A;&amp;#x8FD9;&amp;#x4E9B;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x5206;&amp;#x914D;&amp;#x7A7A;&amp;#x95F2;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#xFF08;ext4&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x662F;&amp;#x5EF6;&amp;#x8FDF;&amp;#x5206;&amp;#x914D;&amp;#x7684;&amp;#xFF09;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5BF9;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x8FDB;&amp;#x884C;&amp;#x8BFB;&amp;#x5199;&amp;#x65F6;&amp;#xFF0C;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C31;&amp;#x4F1A;&amp;#x6839;&amp;#x636E;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x627E;&amp;#x5230;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4E0B;&amp;#x53D1;io&amp;#x8BF7;&amp;#x6C42;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5C42;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7528;&amp;#x6237;&amp;#x8C03;&amp;#x7528;read()&amp;#x6216;write()&amp;#x7CFB;&amp;#x7EDF;&amp;#x8C03;&amp;#x7528;&amp;#x8FDB;&amp;#x884C;io&amp;#x8BFB;&amp;#x5199;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;buf&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x8FDB;&amp;#x7A0B;&amp;#x7A7A;&amp;#x95F4;&amp;#x7684;&amp;#x865A;&amp;#x62DF;&amp;#x5730;&amp;#x5740;&amp;#xFF0C;&amp;#x5728;&amp;#x5185;&amp;#x6838;&amp;#x5904;&amp;#x7406;&amp;#x65F6;&amp;#x5C06;&amp;#x865A;&amp;#x62DF;&amp;#x5185;&amp;#x5B58;&amp;#x6620;&amp;#x5C04;&amp;#x5230;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x7F13;&amp;#x5B58;I/O&amp;#xFF0C;&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;&amp;#x7528;&amp;#x6237;&amp;#x7F13;&amp;#x51B2;&amp;#x5230;&amp;#x5185;&amp;#x6838;&amp;#x7F13;&amp;#x5B58;&amp;#xFF08;page cache&amp;#xFF09;&amp;#x7684;&amp;#x62F7;&amp;#x8D1D;&amp;#xFF0C;&amp;#x800C;Direct I/O&amp;#x5219;&amp;#x53EF;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x8BA9;&amp;#x5185;&amp;#x6838;&amp;#x6001;&amp;#x6620;&amp;#x5C04;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x865A;&amp;#x62DF;&amp;#x5185;&amp;#x5B58;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x9875;&amp;#xFF0C;&amp;#x5C11;&amp;#x4E86;&amp;#x4E00;&amp;#x6B21;&amp;#x62F7;&amp;#x8D1D;&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#x3002;&amp;#x5728;&amp;#x4ECE;&amp;#x6587;&amp;#x4EF6;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x5904;&amp;#x7406;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x7F13;&amp;#x5B58;I/O&amp;#x7684;&amp;#x5237;&amp;#x810F;&amp;#x9875;&amp;#x548C;Direct I/O&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x7C7B;&amp;#x4F3C;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4EE5;Direct I/O&amp;#x8FDB;&amp;#x884C;&amp;#x7B80;&amp;#x8981;&amp;#x5206;&amp;#x6790;&amp;#xFF0C;&amp;#x8BE6;&amp;#x7EC6;&amp;#x7684;&amp;#x53EF;&amp;#x4EE5;&amp;#x53BB;&amp;#x770B;&amp;#x5185;&amp;#x6838;&amp;#x4EE3;&amp;#x7801;&amp;#x91CC;&amp;#x7684;submit_page_action&amp;#xFF0C;__bio_add_page&amp;#x7B49;&amp;#x51FD;&amp;#x6570;&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;Direct I/O&amp;#x65F6;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;buffer&amp;#x548C;&amp;#x8BFB;&amp;#x5199;&amp;#x7684;&amp;#x957F;&amp;#x5EA6;&amp;#x9700;&amp;#x8981;512&amp;#x5B57;&amp;#x8282;&amp;#x7684;&amp;#x6574;&amp;#x6570;&amp;#x500D;&amp;#x5BF9;&amp;#x9F50;&amp;#xFF0C;&amp;#x4E4B;&amp;#x6240;&amp;#x4EE5;&amp;#x8FD9;&amp;#x6837;&amp;#x8981;&amp;#x6C42;&amp;#xFF0C;&amp;#x662F;&amp;#x56E0;&amp;#x4E3A;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5728;&amp;#x5E95;&amp;#x5C42;&amp;#x6784;&amp;#x9020;bio&amp;#x65F6;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x4F1A;&amp;#x56E0;&amp;#x4E3A;PageSize&amp;#x8FB9;&amp;#x754C;&amp;#x5E26;&amp;#x6765;&amp;#x989D;&amp;#x5916;&amp;#x7684;I/O&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x9700;&amp;#x8981;&amp;#x591A;&amp;#x6B21;&amp;#x4E0B;&amp;#x53D1;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x964D;&amp;#x4F4E;&amp;#x4E86;&amp;#x6548;&amp;#x7387;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;I/O&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x4F1A;&amp;#x53D8;&amp;#x6210;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x5757;I/O&amp;#xFF0C;&amp;#x53D6;&amp;#x51B3;&amp;#x4E8E;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x548C;&amp;#x7528;&amp;#x6237;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x7684;&amp;#x5BF9;&amp;#x9F50;&amp;#x957F;&amp;#x5EA6;&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x8BE5;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x662F;&amp;#x5426;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x4F8B;&amp;#x5B50;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;1&amp;#xFF09;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;1KB &amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x8D77;&amp;#x4E00;&amp;#x4E2A;4KB&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x7533;&amp;#x8BF7;&amp;#x7684;buffer&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x9875;&amp;#x4E2D;&amp;#xFF08;&amp;#x6216;&amp;#x8005;direc io&amp;#x4E0B;&amp;#x7684;&amp;#x6309;&amp;#x7167;4KB&amp;#x5BF9;&amp;#x9F50;&amp;#xFF09;&amp;#x3002;&amp;#x56FE;&amp;#x4E2D;&amp;#x7EFF;&amp;#x8272;&amp;#x548C;&amp;#x7EA2;&amp;#x8272;&amp;#x65B9;&amp;#x5757;&amp;#x91CC;&amp;#x7684;&amp;#x6570;&amp;#x5B57;&amp;#x8868;&amp;#x793A;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x771F;&amp;#x5B9E;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x7684;&amp;#x5757;&amp;#x53F7;&amp;#xFF0C;&amp;#x8981;&amp;#x8BFB;&amp;#x5199;&amp;#x7684;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;4KB&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x6309;&amp;#x7167;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x5207;&amp;#x5206;&amp;#xFF0C;&amp;#x5206;&amp;#x6210;4&amp;#x4E2A;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#xFF08;0~3&amp;#xFF09;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x903B;&amp;#x8F91;&amp;#x5757;0&amp;#x5BF9;&amp;#x5E94;&amp;#x7269;&amp;#x7406;&amp;#x5757;60&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x5757;1&amp;#x5BF9;&amp;#x5E94;&amp;#x7269;&amp;#x7406;&amp;#x5757;61&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x5757;2&amp;#x5BF9;&amp;#x5E94;&amp;#x7269;&amp;#x7406;&amp;#x5757;200&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x5757;3&amp;#x5BF9;&amp;#x5E94;&amp;#x7269;&amp;#x7406;&amp;#x5757;201&amp;#xFF08;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5BF9;&amp;#x5E94;&amp;#x5173;&amp;#x7CFB;&amp;#x662F;&amp;#x7531;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5206;&amp;#x914D;&amp;#x5757;&amp;#x65F6;&amp;#x786E;&amp;#x5B9A;&amp;#x7684;&amp;#xFF09;&amp;#x3002;&amp;#x903B;&amp;#x8F91;&amp;#x5757;0&amp;#x548C;1&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x56E0;&amp;#x4E3A;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;1KB&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x53EF;&amp;#x4EE5;&amp;#x653E;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;bio&amp;#x91CC;&amp;#xFF0C;&amp;#x800C;&amp;#x903B;&amp;#x8F91;&amp;#x5757;2&amp;#x548C;3&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x4E0E;&amp;#x903B;&amp;#x8F91;&amp;#x5757;0&amp;#x548C;1&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x4E0D;&amp;#x8FDE;&amp;#x7EED;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x80FD;&amp;#x653E;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;bio&amp;#x91CC;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x65B0;&amp;#x751F;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;bio&amp;#x3002;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;&amp;#x4E24;&amp;#x6B21;submit_bio&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;&amp;#x53BB;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x7ECF;&amp;#x8FC7;&amp;#x8C03;&amp;#x5EA6;&amp;#x5C42;&amp;#xFF08;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x548C;&amp;#x5176;&amp;#x4ED6;&amp;#x8BF7;&amp;#x6C42;&amp;#x8FDE;&amp;#x7EED;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF09;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x901A;&amp;#x8FC7;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x5C42;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/block-is-1kb_4kb-io-in-page.png&quot; alt=&quot;block-is-1kb_4kb-io-in-page&quot;&gt;&lt;br&gt;2&amp;#xFF09;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;1KB&amp;#xFF0C; &amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x8D77;&amp;#x4E00;&amp;#x4E2A;4KB&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x7533;&amp;#x8BF7;&amp;#x7684;buffer&amp;#x4E0D;&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x9875;&amp;#x4E2D;&amp;#xFF08;&amp;#x6216;&amp;#x8005;direc io&amp;#x4E0B;&amp;#x7684;&amp;#x6309;&amp;#x7167;1KB&amp;#x5BF9;&amp;#x9F50;&amp;#xFF09;&amp;#x3002;&amp;#x8BF7;&amp;#x6C42;&amp;#x843D;&amp;#x5230;&amp;#x4E24;&amp;#x4E2A;&amp;#x9875;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x56E0;&amp;#x4E3A;&amp;#x903B;&amp;#x8F91;&amp;#x5757;2&amp;#x548C;&amp;#x903B;&amp;#x8F91;&amp;#x5757;3&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x4E0D;&amp;#x8FDE;&amp;#x7EED;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x6784;&amp;#x9020;bio&amp;#x65F6;&amp;#x53D8;&amp;#x6210;&amp;#x4E86;3&amp;#x4E2A;bio&amp;#xFF08;&amp;#x5982;&amp;#x679C;&amp;#x4E24;&amp;#x4E2A;&amp;#x9875;&amp;#x4E2D;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;&amp;#x5219;&amp;#x4F1A;&amp;#x653E;&amp;#x5230;&amp;#x4E00;&amp;#x4E2A;bio&amp;#x91CC;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;bio&amp;#x53EF;&amp;#x4EE5;&amp;#x5305;&amp;#x542B;&amp;#x591A;&amp;#x4E2A;&amp;#x9875;&amp;#xFF09;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#x5C31;&amp;#x4F1A;&amp;#x6709;3&amp;#x6B21;submit_bio&amp;#x7684;&amp;#x8C03;&amp;#x7528;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/block-is-1kb_4kb-io-not-in-page.png&quot; alt=&quot;block-is-1kb_4kb-io-not-in-page&quot;&gt;&lt;br&gt;3&amp;#xFF09;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;4KB &amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x8D77;&amp;#x4E00;&amp;#x4E2A;4KB&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x7533;&amp;#x8BF7;&amp;#x7684;buffer&amp;#x5728;&amp;#x4E00;&amp;#x4E2A;&amp;#x9875;&amp;#x4E2D;&amp;#xFF08;&amp;#x6216;&amp;#x8005;direc io&amp;#x4E0B;&amp;#x7684;&amp;#x6309;&amp;#x7167;4KB&amp;#x5BF9;&amp;#x9F50;&amp;#xFF09;&amp;#x3002;&amp;#x8FD9;&amp;#x91CC;&amp;#x521A;&amp;#x597D;&amp;#x4E00;&amp;#x4E2A;&amp;#x9875;&amp;#x91CC;&amp;#x53EA;&amp;#x6709;1&amp;#x4E2A;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x6B21;submti_bio&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/fs-io-map/block-is-4kb_4kb-io-in-page.png&quot; alt=&quot;block-is-4kb_4kb-io-in-page&quot;&gt;&lt;br&gt;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x51E0;&amp;#x4E2A;&amp;#x793A;&amp;#x4F8B;&amp;#x5C31;&amp;#x89E3;&amp;#x91CA;&amp;#x4E86;&amp;#x7B2C;3&amp;#x8282;&amp;#x672B;&amp;#x5C3E;&amp;#x63D0;&amp;#x51FA;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;I/O&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x4F1A;&amp;#x53D8;&amp;#x6210;&amp;#x591A;&amp;#x5C11;&amp;#x4E2A;&amp;#x5757;I/O&amp;#xFF0C;&amp;#x53D6;&amp;#x51B3;&amp;#x4E8E;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x548C;&amp;#x7528;&amp;#x6237;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x7684;&amp;#x5BF9;&amp;#x9F50;&amp;#x957F;&amp;#x5EA6;&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x8BE5;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x5757;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x5757;&amp;#x662F;&amp;#x5426;&amp;#x8FDE;&amp;#x7EED;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;a href=&quot;#3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;/a&gt;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&lt;/h1&gt;&lt;p&gt;1.&amp;#x300A;&amp;#x6DF1;&amp;#x5165;&amp;#x7406;&amp;#x89E3;linux&amp;#x5185;&amp;#x6838;&amp;#x300B;&lt;br&gt;2.&amp;#x300A;Linux&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x300B;&lt;br&gt;3.&amp;#x300A;unix&amp;#x9AD8;&amp;#x7EA7;&amp;#x73AF;&amp;#x5883;&amp;#x7F16;&amp;#x7A0B;&amp;#x300B;&lt;br&gt;4.Linux&amp;#x5185;&amp;#x6838;&amp;#x6E90;&amp;#x7801;3.10.45&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4E3B;&amp;#x8981;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&amp;#x8FDB;&amp;#x884C;&amp;#x6982;&amp;#x8981;&amp;#x7684;&amp;#x68B3;&amp;#x7406;&amp;#xFF0C;&amp;#x5E76;&amp;#x5728;&amp;#x6B64;&amp;#x57FA;&amp;#x7840;&amp;#x4E0A;&amp;#x5206;&amp;#x6790;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;I/O&amp;#x5230;&amp;#x5757;I/O&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x673A;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;a href=&quot;#1-&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&quot;&gt;&lt;/a&gt;1.&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x78C1;&amp;#x76D8;&amp;#x5E03;&amp;#x5C40;&lt;/h1&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C42;&amp;#x9762;&amp;#x6765;&amp;#x9610;&amp;#x8FF0;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0E;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5173;&amp;#x7CFB;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot;&gt;&lt;a href=&quot;#1-1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot; class=&quot;headerlink&quot; title=&quot;1.1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&quot;&gt;&lt;/a&gt;1.1&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E0E;inode&lt;/h2&gt;&lt;p&gt;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5728;&amp;#x8BBF;&amp;#x95EE;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;&amp;#x90FD;&amp;#x4F1A;&amp;#x5148;&amp;#x6253;&amp;#x5F00;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x5728;&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#xFF0C;&amp;#x90FD;&amp;#x4F1A;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x8868;&amp;#x793A;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;&amp;#x4E0D;&amp;#x80FD;&amp;#x76F4;&amp;#x63A5;&amp;#x8BBF;&amp;#x95EE;&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;,&amp;#x800C;&amp;#x53EA;&amp;#x80FD;&amp;#x4F7F;&amp;#x7528;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x7684;&amp;#x7D22;&amp;#x5F15;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A;&amp;#x6574;&amp;#x6570;&amp;#xFF09;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x7D22;&amp;#x5F15;&amp;#x5C31;&amp;#x88AB;&amp;#x79F0;&amp;#x4E3A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x3002;&amp;#x5F53;&amp;#x8C03;&amp;#x7528;open &amp;#x6253;&amp;#x5F00;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x6216;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;,&amp;#x5185;&amp;#x6838;&amp;#x5206;&amp;#x914D;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x5E76;&amp;#x8FD4;&amp;#x56DE;&amp;#x7ED9;&amp;#x7528;&amp;#x6237;&amp;#x7A0B;&amp;#x5E8F;,&amp;#x8BE5;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x9879;&amp;#x4E2D;&amp;#x7684;&amp;#x6307;&amp;#x9488;&amp;#x6307;&amp;#x5411;&amp;#x65B0;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x8868;&amp;#x4E2D;&amp;#x6BCF;&amp;#x4E00;&amp;#x9879;&amp;#x90FD;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x6307;&amp;#x9488;&amp;#xFF0C;&amp;#x6307;&amp;#x5411;&amp;#x4E00;&amp;#x4E2A;&amp;#x7528;&amp;#x4E8E;&amp;#x63CF;&amp;#x8FF0;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x2013;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E2D;&amp;#x63CF;&amp;#x8FF0;&amp;#x4E86;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6253;&amp;#x5F00;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF0C;&amp;#x8BFB;&amp;#x5199;&amp;#x4F4D;&amp;#x7F6E;&amp;#x7B49;&amp;#x91CD;&amp;#x8981;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x5F53;&amp;#x8FDB;&amp;#x7A0B;&amp;#x6253;&amp;#x5F00;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x65F6;&amp;#xFF0C;&amp;#x5185;&amp;#x6838;&amp;#x5C31;&amp;#x4F1A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;file&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;&amp;#x9700;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x662F;&amp;#xFF0C;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E0D;&amp;#x662F;&amp;#x4E13;&amp;#x5C5E;&amp;#x4E8E;&amp;#x67D0;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x7684;&amp;#xFF0C;&amp;#x4E0D;&amp;#x540C;&amp;#x8FDB;&amp;#x7A0B;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x8868;&amp;#x4E2D;&amp;#x7684;&amp;#x6307;&amp;#x9488;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5411;&amp;#x76F8;&amp;#x540C;&amp;#x7684;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x5171;&amp;#x4EAB;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6253;&amp;#x5F00;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;file&amp;#x5BF9;&amp;#x8C61;&amp;#x6709;&amp;#x5F15;&amp;#x7528;&amp;#x8BA1;&amp;#x6570;&amp;#xFF0C;&amp;#x8BB0;&amp;#x5F55;&amp;#x4E86;&amp;#x5F15;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5BF9;&amp;#x8C61;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x63CF;&amp;#x8FF0;&amp;#x7B26;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;&amp;#x53EA;&amp;#x6709;&amp;#x5F53;&amp;#x5F15;&amp;#x7528;&amp;#x8BA1;&amp;#x6570;&amp;#x4E3A;0&amp;#x65F6;&amp;#xFF0C;&amp;#x5185;&amp;#x6838;&amp;#x624D;&amp;#x9500;&amp;#x6BC1;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x67D0;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x5173;&amp;#x95ED;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x4E0D;&amp;#x5F71;&amp;#x54CD;&amp;#x4E0E;&amp;#x4E4B;&amp;#x5171;&amp;#x4EAB;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;file&amp;#x5BF9;&amp;#x8C61;&amp;#x7684;&amp;#x8FDB;&amp;#x7A0B;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;file&amp;#x5BF9;&amp;#x8C61;&amp;#x4E2D;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6307;&amp;#x9488;&amp;#xFF0C;&amp;#x6307;&amp;#x5411;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x4EE3;&amp;#x8868;&amp;#x4E00;&amp;#x4E2A;&amp;#x72EC;&amp;#x7ACB;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x8DEF;&amp;#x5F84;&amp;#x88AB;&amp;#x6253;&amp;#x5F00;&amp;#x591A;&amp;#x6B21;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x4F1A;&amp;#x5EFA;&amp;#x7ACB;&amp;#x591A;&amp;#x4E2A;file&amp;#x5BF9;&amp;#x8C61;&amp;#xFF0C;&amp;#x4F46;&amp;#x5B83;&amp;#x4EEC;&amp;#x90FD;&amp;#x6307;&amp;#x5411;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;dentry&amp;#x5BF9;&amp;#x8C61;&amp;#x3002;inode&amp;#x5BF9;&amp;#x8C61;&amp;#x4EE3;&amp;#x8868;&amp;#x4E00;&amp;#x4E2A;&amp;#x72EC;&amp;#x7ACB;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;inode &amp;#x5BF9;&amp;#x8C61;&amp;#x5305;&amp;#x542B;&amp;#x4E86;&amp;#x6700;&amp;#x7EC8;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x8FDB;&amp;#x884C;&amp;#x64CD;&amp;#x4F5C;&amp;#x6240;&amp;#x9700;&amp;#x7684;&amp;#x6240;&amp;#x6709;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x5982;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7C7B;&amp;#x578B;&amp;#x3001;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#x65B9;&amp;#x6CD5;&amp;#x3001;&amp;#x6587;&amp;#x4EF6;&amp;#x7684;&amp;#x6743;&amp;#x9650;&amp;#x3001;&amp;#x8BBF;&amp;#x95EE;&amp;#x65E5;&amp;#x671F;&amp;#x7B49;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="filesystem" scheme="http://yoursite.com/tags/filesystem/"/>
    
      <category term="io" scheme="http://yoursite.com/tags/io/"/>
    
  </entry>
  
  <entry>
    <title>linux块设备IO栈浅析</title>
    <link href="http://yoursite.com/2016/05/12/linux-io-stack/"/>
    <id>http://yoursite.com/2016/05/12/linux-io-stack/</id>
    <published>2016-05-12T13:54:13.000Z</published>
    <updated>2016-05-12T14:07:08.174Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x7B80;&amp;#x5355;&amp;#x6765;&amp;#x8BF4;&amp;#x5C31;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;&amp;#x7CFB;&amp;#x7EDF;&amp;#x63D0;&amp;#x4F9B;&amp;#x5B58;&amp;#x50A8;&amp;#x670D;&amp;#x52A1;&amp;#x3002;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x5206;&amp;#x591A;&amp;#x79CD;&amp;#x7C7B;&amp;#x578B;&amp;#xFF0C;&amp;#x6709;&amp;#x5355;&amp;#x673A;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x7F51;&amp;#x7EDC;&amp;#x5B58;&amp;#x50A8;&amp;#xFF08;&amp;#x5982;NAS&amp;#xFF0C;SAN&amp;#x7B49;&amp;#xFF09;&amp;#xFF0C;&amp;#x5206;&amp;#x5E03;&amp;#x5F0F;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF08;&amp;#x76EE;&amp;#x524D;&amp;#x4E3B;&amp;#x6D41;&amp;#x7684;&amp;#x5982;AWS&amp;#x7684;EBS&amp;#xFF0C;&amp;#x9752;&amp;#x4E91;&amp;#x7684;&amp;#x4E91;&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;&amp;#x963F;&amp;#x91CC;&amp;#x4E91;&amp;#x7684;&amp;#x4E91;&amp;#x78C1;&amp;#x76D8;&amp;#xFF0C;&amp;#x7F51;&amp;#x6613;&amp;#x4E91;&amp;#x786C;&amp;#x76D8;&amp;#x7B49;&amp;#xFF09;&amp;#x3002;&amp;#x901A;&amp;#x5E38;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&amp;#x5F62;&amp;#x5F0F;&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x770B;&amp;#x5230;&amp;#x7684;&amp;#x5C31;&amp;#x662F;&amp;#x7C7B;&amp;#x4F3C;&amp;#x4E8E;sda&amp;#xFF0C;sdb&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x672C;&amp;#x6587;&amp;#x4E3B;&amp;#x8981;&amp;#x4ECB;&amp;#x7ECD;Linux&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5BF9;Linux&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I/O&amp;#x6808;&amp;#x8FDB;&amp;#x884C;&amp;#x5206;&amp;#x6790;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&lt;/h1&gt;&lt;p&gt;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5C06;&amp;#x4FE1;&amp;#x606F;&amp;#x5B58;&amp;#x50A8;&amp;#x5728;&amp;#x56FA;&amp;#x5B9A;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x5757;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x90FD;&amp;#x6709;&amp;#x81EA;&amp;#x5DF1;&amp;#x7684;&amp;#x5730;&amp;#x5740;&amp;#x3002;&amp;#x5BF9;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x800C;&amp;#x8A00;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x4EE5;&amp;#x5B57;&amp;#x7B26;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5916;&amp;#x89C2;&amp;#x5C55;&amp;#x73B0;&amp;#x7684;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;/dev/sda&amp;#xFF0C;&amp;#x867D;&amp;#x7136;&amp;#x5BF9;&amp;#x8FD9;&amp;#x79CD;&amp;#x5B57;&amp;#x7B26;&amp;#x8BBE;&amp;#x5907;&amp;#x53EF;&amp;#x4EE5;&amp;#x6309;&amp;#x7167;&amp;#x5B57;&amp;#x8282;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x8BBF;&amp;#x95EE;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x5374;&amp;#x662F;&amp;#x4EE5;&amp;#x5757;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF08;&amp;#x6700;&amp;#x5C0F;512byte&amp;#xFF0C;&amp;#x5373;&amp;#x4E00;&amp;#x4E2A;&amp;#x6247;&amp;#x533A;&amp;#xFF09;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8F6C;&amp;#x6362;&amp;#x662F;&amp;#x7531;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#x3002;&lt;br&gt;        &amp;#x4E0B;&amp;#x9762;&amp;#x4ECB;&amp;#x7ECD;&amp;#x51E0;&amp;#x4E2A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&amp;#xFF1A;&lt;br&gt;        1&amp;#xFF09;&amp;#x6247;&amp;#x533A;&amp;#xFF1A;&amp;#x78C1;&amp;#x76D8;&amp;#x76D8;&amp;#x7247;&amp;#x4E0A;&amp;#x7684;&amp;#x6247;&amp;#x5F62;&amp;#x533A;&amp;#x57DF;&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x5316;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x7BA1;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x662F;&amp;#x786C;&amp;#x4EF6;&amp;#x8BBE;&amp;#x5907;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x4E00;&amp;#x822C;512Byte&amp;#xFF1B;&lt;br&gt;    2&amp;#xFF09;&amp;#x5757;&amp;#xFF1A;&amp;#x5757;&amp;#x662F;VFS&amp;#x548C;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x662F;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x6574;&amp;#x6570;&amp;#x500D;&amp;#xFF0C;&amp;#x683C;&amp;#x5F0F;&amp;#x5316;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5B9A;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;512,1024,2048,4096&amp;#x5B57;&amp;#x8282;&amp;#xFF09;&amp;#xFF1B;&lt;br&gt;       3&amp;#xFF09;&amp;#x6BB5;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x6216;&amp;#x8005;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x78C1;&amp;#x76D8;&amp;#x6247;&amp;#x533A;&amp;#x4E2D;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF1B;&amp;#x78C1;&amp;#x76D8;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;I/O&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;RAM&amp;#x5355;&amp;#x5143;&amp;#x4E4B;&amp;#x95F4;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x5185;&amp;#x5BB9;&amp;#xFF0C;&amp;#x5927;&amp;#x591A;&amp;#x6570;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x91C7;&amp;#x7528;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6BB5;&amp;#x5728;RAM&amp;#x4E2D;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x9875;&amp;#x6846;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x4E5F;&amp;#x662F;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;&amp;#x5408;&amp;#x5E76;&amp;#x5B83;&amp;#x4EEC;&amp;#xFF0C;&amp;#x4EA7;&amp;#x751F;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x533A;&amp;#x57DF;&amp;#x79F0;&amp;#x4E3A;&amp;#x7269;&amp;#x7406;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&amp;#x901A;&amp;#x5E38;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x662F;&amp;#x901A;&amp;#x8FC7;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6765;&amp;#x8BBF;&amp;#x95EE;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x6307;&amp;#x5B9A;&amp;#x504F;&amp;#x79FB;&amp;#x548C;&amp;#x5927;&amp;#x5C0F;&amp;#x6765;&amp;#x8BFB;&amp;#x5199;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&amp;#x5E38;&amp;#x89C1;&amp;#x7684;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x8BBE;&amp;#x5907;&amp;#x5C31;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#xFF0C;&amp;#x5728;Linux&amp;#x7CFB;&amp;#x7EDF;&amp;#x4E0B;&amp;#xFF0C;&amp;#x8FD8;&amp;#x63D0;&amp;#x4F9B;&amp;#x57FA;&amp;#x4E8E;&amp;#x5176;&amp;#x4ED6;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E4B;&amp;#x4E0A;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5982;Device Mapper&amp;#xFF0C;&amp;#x8F6F;RAID&amp;#x7B49;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;2-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I-O&amp;#x6808;&quot;&gt;&lt;a href=&quot;#2-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I-O&amp;#x6808;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I/O&amp;#x6808;&quot;&gt;&lt;/a&gt;2.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I/O&amp;#x6808;&lt;/h1&gt;&lt;h2 id=&quot;2-1&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#2-1&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;2.1&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;2.1&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&lt;/h2&gt;&lt;p&gt;&amp;#x4ECB;&amp;#x7ECD;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;I/O&amp;#x6808;&amp;#x4E4B;&amp;#x524D;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x5148;&amp;#x6765;&amp;#x4E86;&amp;#x89E3;&amp;#x4E00;&amp;#x4E0B;&amp;#x5757;I/O&amp;#x6808;&amp;#x7684;&amp;#x51E0;&amp;#x4E2A;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&amp;#x3002;&lt;br&gt;        1&amp;#xFF09;bio&amp;#xFF1A;bio&amp;#x662F;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;I/O&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x8868;&amp;#x793A;&amp;#x4E0A;&amp;#x5C42;&amp;#x63D0;&amp;#x4EA4;&amp;#x7684;I/O&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;bio&amp;#x5305;&amp;#x542B;&amp;#x591A;&amp;#x4E2A;page&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;page&amp;#x5FC5;&amp;#x987B;&amp;#x5BF9;&amp;#x5E94;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x4E00;&amp;#x6BB5;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x3002;&amp;#x7531;&amp;#x4E8E;&amp;#x6587;&amp;#x4EF6;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x5E76;&amp;#x4E0D;&amp;#x8FDE;&amp;#x7EED;&amp;#x5B58;&amp;#x653E;&amp;#xFF0C;&amp;#x6587;&amp;#x4EF6;I/O&amp;#x63D0;&amp;#x4EA4;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E4B;&amp;#x524D;&amp;#xFF0C;&amp;#x6781;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x88AB;&amp;#x62C6;&amp;#x6210;&amp;#x591A;&amp;#x4E2A;bio&amp;#x7ED3;&amp;#x6784;&amp;#xFF1B;&lt;br&gt;        2&amp;#xFF09;request&amp;#xFF1A;&amp;#x8868;&amp;#x793A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x5C42;I/O&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x7ECF;&amp;#x7531;I/O&amp;#x8C03;&amp;#x5EA6;&amp;#x5C42;&amp;#x8F6C;&amp;#x6362;&amp;#x540E;&amp;#x7684;I/O&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5C06;&amp;#x4F1A;&amp;#x53D1;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x5C42;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF1B;&lt;br&gt;        3&amp;#xFF09;request_queue&amp;#xFF1A; &amp;#x7EF4;&amp;#x62A4;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x5C42;I/O&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x961F;&amp;#x5217;&amp;#xFF0C;&amp;#x6240;&amp;#x6709;&amp;#x7684;request&amp;#x90FD;&amp;#x63D2;&amp;#x5165;&amp;#x5230;&amp;#x8BE5;&amp;#x961F;&amp;#x5217;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x78C1;&amp;#x76D8;&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;queue&amp;#xFF08;&amp;#x591A;&amp;#x4E2A;&amp;#x5206;&amp;#x533A;&amp;#x4E5F;&amp;#x53EA;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;&amp;#xFF09;&amp;#xFF1B;&lt;br&gt;        &amp;#x8FD9;3&amp;#x4E2A;&amp;#x7ED3;&amp;#x6784;&amp;#x7684;&amp;#x5173;&amp;#x7CFB;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x793A;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A;request_queue&amp;#x4E2D;&amp;#x5305;&amp;#x542B;&amp;#x591A;&amp;#x4E2A;request&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;request&amp;#x53EF;&amp;#x80FD;&amp;#x5305;&amp;#x542B;&amp;#x591A;&amp;#x4E2A;bio&amp;#xFF0C;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x5408;&amp;#x5E76;&amp;#x5C31;&amp;#x662F;&amp;#x6839;&amp;#x636E;&amp;#x5404;&amp;#x79CD;&amp;#x539F;&amp;#x5219;&amp;#x5C06;&amp;#x591A;&amp;#x4E2A;bio&amp;#x52A0;&amp;#x5165;&amp;#x5230;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;requesst&amp;#x4E2D;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/linux-io-stack/bio_req_queue.png&quot; alt=&quot;bio_req_queue&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-2-&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;a href=&quot;#2-2-&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&quot; class=&quot;headerlink&quot; title=&quot;2.2 &amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;/a&gt;2.2 &amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/05/12/linux-io-stack/io-stack.png&quot; alt=&quot;io-stack&quot;&gt;&lt;br&gt;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x662F;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;I/O&amp;#x6808;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x7684;&amp;#x7EA2;&amp;#x8272;&amp;#x6587;&amp;#x5B57;&amp;#x8868;&amp;#x793A;&amp;#x5173;&amp;#x952E;I/O&amp;#x8DEF;&amp;#x5F84;&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x3002;&lt;br&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x63CF;&amp;#x8FF0;I/O&amp;#x5904;&amp;#x7406;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF0C;&amp;#x5148;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E00;&amp;#x4E0B;Direct I/O&amp;#x548C;&amp;#x7F13;&amp;#x5B58;I/O&amp;#x7684;&amp;#x533A;&amp;#x522B;&amp;#xFF1A;&lt;br&gt;        1&amp;#xFF09;Direct I/O&amp;#x7ED5;&amp;#x8FC7;page cache&amp;#xFF0C;&amp;#x800C;&amp;#x7F13;&amp;#x5B58;I/O&amp;#x90FD;&amp;#x662F;&amp;#x5199;&amp;#x5230;page cache&amp;#x91CC;&amp;#x5C31;&amp;#x8868;&amp;#x793A;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x5B8C;&amp;#x6210;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7531;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x5237;&amp;#x810F;&amp;#x9875;&amp;#x673A;&amp;#x5236;&amp;#x628A;&amp;#x6570;&amp;#x636E;&amp;#x5237;&amp;#x5230;&amp;#x78C1;&amp;#x76D8;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7F13;&amp;#x5B58;I/O&amp;#xFF0C;&amp;#x6389;&amp;#x7535;&amp;#x65F6;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;page cache&amp;#x91CC;&amp;#x7684;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x672A;&amp;#x5237;&amp;#x5230;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#xFF0C;&amp;#x9020;&amp;#x6210;&amp;#x6570;&amp;#x636E;&amp;#x4E22;&amp;#x5931;&amp;#xFF1B;&lt;br&gt;        2&amp;#xFF09;&amp;#x7F13;&amp;#x5B58;I/O&amp;#x673A;&amp;#x5236;&amp;#x4E2D;&amp;#xFF0C;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C06;&amp;#x6570;&amp;#x636E;&amp;#x76F4;&amp;#x63A5;&amp;#x4ECE;&amp;#x78C1;&amp;#x76D8;&amp;#x8BFB;&amp;#x5230;page cache&amp;#x4E2D;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x5C06;&amp;#x6570;&amp;#x636E;&amp;#x4ECE;page cache&amp;#x76F4;&amp;#x63A5;&amp;#x5199;&amp;#x56DE;&amp;#x5230;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x80FD;&amp;#x76F4;&amp;#x63A5;&amp;#x5728;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5730;&amp;#x5740;&amp;#x7A7A;&amp;#x95F4;&amp;#x548C;&amp;#x78C1;&amp;#x76D8;&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x8F93;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x8BDD;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x5728;&amp;#x4F20;&amp;#x8F93;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#x9700;&amp;#x8981;&amp;#x5728;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5730;&amp;#x5740;&amp;#x7A7A;&amp;#x95F4;&amp;#x548C;page cache&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDB;&amp;#x884C;&amp;#x591A;&amp;#x6B21;&amp;#x6570;&amp;#x636E;&amp;#x62F7;&amp;#x8D1D;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x6570;&amp;#x636E;&amp;#x62F7;&amp;#x8D1D;&amp;#x64CD;&amp;#x4F5C;&amp;#x6240;&amp;#x5E26;&amp;#x6765;&amp;#x7684;CPU&amp;#x4EE5;&amp;#x53CA;&amp;#x5185;&amp;#x5B58;&amp;#x5F00;&amp;#x9500;&amp;#x662F;&amp;#x975E;&amp;#x5E38;&amp;#x5927;&amp;#x7684;&amp;#x3002;&amp;#x800C;Direct I/O&amp;#x7684;&amp;#x4F18;&amp;#x70B9;&amp;#x5C31;&amp;#x662F;&amp;#x901A;&amp;#x8FC7;&amp;#x51CF;&amp;#x5C11;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5185;&amp;#x6838;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x548C;&amp;#x5E94;&amp;#x7528;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5730;&amp;#x5740;&amp;#x7A7A;&amp;#x95F4;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x62F7;&amp;#x8D1D;&amp;#x6B21;&amp;#x6570;&amp;#xFF0C;&amp;#x964D;&amp;#x4F4E;&amp;#x4E86;&amp;#x5BF9;&amp;#x6587;&amp;#x4EF6;&amp;#x8BFB;&amp;#x53D6;&amp;#x548C;&amp;#x5199;&amp;#x5165;&amp;#x65F6;&amp;#x6240;&amp;#x5E26;&amp;#x6765;&amp;#x7684;CPU&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x4EE5;&amp;#x53CA;&amp;#x5185;&amp;#x5B58;&amp;#x5E26;&amp;#x5BBD;&amp;#x7684;&amp;#x5360;&amp;#x7528;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;Direct I/O&amp;#x7684;&amp;#x8BFB;&amp;#x64CD;&amp;#x4F5C;&amp;#x4E0D;&amp;#x80FD;&amp;#x4ECE;page cache&amp;#x4E2D;&amp;#x83B7;&amp;#x53D6;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x4F1A;&amp;#x76F4;&amp;#x63A5;&amp;#x4ECE;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x8BFB;&amp;#x53D6;&amp;#xFF0C;&amp;#x5E26;&amp;#x6765;&amp;#x6027;&amp;#x80FD;&amp;#x4E0A;&amp;#x7684;&amp;#x635F;&amp;#x5931;&amp;#x3002;&amp;#x4E00;&amp;#x822C;Direct I/O&amp;#x4E0E;&amp;#x5F02;&amp;#x6B65;I/O&amp;#x7ED3;&amp;#x5408;&amp;#x8D77;&amp;#x6765;&amp;#x4F7F;&amp;#x7528;&amp;#x63D0;&amp;#x9AD8;&amp;#x6027;&amp;#x80FD;&amp;#x3002;&lt;br&gt;        3&amp;#xFF09;Direct I/O&amp;#x8981;&amp;#x6C42;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x7684;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x5BF9;&amp;#x9F50;&amp;#xFF1B;&lt;br&gt;        4&amp;#xFF09;Direct I/O&amp;#x4E00;&amp;#x822C;&amp;#x7528;&amp;#x4E8E;&amp;#x9700;&amp;#x8981;&amp;#x81EA;&amp;#x5DF1;&amp;#x7BA1;&amp;#x7406;&amp;#x7F13;&amp;#x5B58;&amp;#x7684;&amp;#x5E94;&amp;#x7528;&amp;#x5982;&amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x7CFB;&amp;#x7EDF;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;I/O&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x6BD4;&amp;#x8F83;&amp;#x590D;&amp;#x6742;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4EE5;&amp;#x5199;&amp;#x6D41;&amp;#x7A0B;&amp;#x7B80;&amp;#x5355;&amp;#x63CF;&amp;#x8FF0;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;        1&amp;#xFF09;&amp;#x7528;&amp;#x6237;&amp;#x8C03;&amp;#x7528;&amp;#x7CFB;&amp;#x7EDF;&amp;#x8C03;&amp;#x7528;write&amp;#x5199;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x4F1A;&amp;#x8C03;&amp;#x5230;sys_write&amp;#x51FD;&amp;#x6570;&amp;#xFF1B;&lt;br&gt;        2&amp;#xFF09; &amp;#x7ECF;&amp;#x8FC7;VFS&amp;#x865A;&amp;#x62DF;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x5C42;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;vfs_write&amp;#xFF0C; &amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x7F13;&amp;#x5B58;&amp;#x5199;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5219;&amp;#x5199;&amp;#x5165;page cache&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5C31;&amp;#x8FD4;&amp;#x56DE;&amp;#xFF0C;&amp;#x540E;&amp;#x7EED;&amp;#x5C31;&amp;#x662F;&amp;#x5237;&amp;#x810F;&amp;#x9875;&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF1B;&amp;#x5982;&amp;#x679C;&amp;#x662F;Direct I/O&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x8D70;&amp;#x5230;do_blockdev_direct_IO&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF1B;&lt;br&gt;        3&amp;#xFF09;&amp;#x5982;&amp;#x679C;&amp;#x64CD;&amp;#x4F5C;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x5982;LVM&amp;#xFF0C;MDRAID&amp;#x8BBE;&amp;#x5907;&amp;#x7B49;&amp;#xFF0C;&amp;#x4F1A;&amp;#x8FDB;&amp;#x5165;&amp;#x5230;&amp;#x5BF9;&amp;#x5E94;&amp;#x5185;&amp;#x6838;&amp;#x6A21;&amp;#x5757;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;&amp;#x91CC;&amp;#x8FDB;&amp;#x884C;&amp;#x4E00;&amp;#x4E9B;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x5C31;&amp;#x76F4;&amp;#x63A5;&amp;#x6784;&amp;#x9020;bio&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;submit_bio&amp;#x5F80;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0B;&amp;#x53D1;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;submit_bio&amp;#x51FD;&amp;#x6570;&amp;#x901A;&amp;#x8FC7;generic_make_request&amp;#x8F6C;&amp;#x53D1;bio&amp;#xFF0C;generic_make_request&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5FAA;&amp;#x73AF;&amp;#xFF0C;&amp;#x5176;&amp;#x901A;&amp;#x8FC7;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0B;&amp;#x6CE8;&amp;#x518C;&amp;#x7684;q-&amp;gt;make_request_fn&amp;#x51FD;&amp;#x6570;&amp;#x4E0E;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x8FDB;&amp;#x884C;&amp;#x4EA4;&amp;#x4E92;&amp;#xFF1B;&lt;br&gt;        4&amp;#xFF09;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;__make_request&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x5C31;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;blk_queue_bio&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x5C31;&amp;#x662F;&amp;#x5408;&amp;#x5E76;bio&amp;#x5230;request&amp;#x4E2D;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;I/O&amp;#x8C03;&amp;#x5EA6;&amp;#x5668;&amp;#x7684;&amp;#x5177;&amp;#x4F53;&amp;#x5B9E;&amp;#x73B0;&amp;#xFF1A;&amp;#x5982;&amp;#x679C;&amp;#x51E0;&amp;#x4E2A;bio&amp;#x8981;&amp;#x8BFB;&amp;#x5199;&amp;#x7684;&amp;#x533A;&amp;#x57DF;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;&amp;#x5C31;&amp;#x5408;&amp;#x5E76;&amp;#x5230;&amp;#x4E00;&amp;#x4E2A;request&amp;#xFF1B;&amp;#x5426;&amp;#x5219;&amp;#x5C31;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;request&amp;#xFF0C;&amp;#x628A;&amp;#x81EA;&amp;#x5DF1;&amp;#x6302;&amp;#x5230;&amp;#x8FD9;&amp;#x4E2A;request&amp;#x4E0B;&amp;#x3002;&amp;#x5408;&amp;#x5E76;bio&amp;#x8BF7;&amp;#x6C42;&amp;#x4E5F;&amp;#x662F;&amp;#x6709;&amp;#x9650;&amp;#x5EA6;&amp;#x7684;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x8D85;&amp;#x8FC7;&amp;#x9608;&amp;#x503C;&amp;#xFF08;&amp;#x5728;/sys/block/xxx/queue/max_sectors_kb&amp;#x91CC;&amp;#x8BBE;&amp;#x7F6E;&amp;#xFF09;,&amp;#x5C31;&amp;#x4E0D;&amp;#x80FD;&amp;#x518D;&amp;#x5408;&amp;#x5E76;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;request&amp;#x4E86;&amp;#xFF0C;&amp;#x800C;&amp;#x4F1A;&amp;#x65B0;&amp;#x5206;&amp;#x914D;&amp;#x4E00;&amp;#x4E2A;request&amp;#xFF1B;&lt;br&gt;        5&amp;#xFF09;&amp;#x63A5;&amp;#x4E0B;&amp;#x6765;&amp;#x7684;I/O&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x4E0E;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x6709;&amp;#x5173;&amp;#x4E86;&amp;#xFF0C;&amp;#x4EA4;&amp;#x7531;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4EE5;scsi&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;&amp;#x4F8B;&amp;#x8BF4;&amp;#x660E;&amp;#xFF0C;queue&amp;#x961F;&amp;#x5217;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;q-&amp;gt;request_fn&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;scsi&amp;#x9A71;&amp;#x52A8;&amp;#x7684;&amp;#x5C31;&amp;#x662F;scsi_request_fn&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x5C06;&amp;#x8BF7;&amp;#x6C42;&amp;#x6784;&amp;#x9020;&amp;#x6210;scsi&amp;#x6307;&amp;#x4EE4;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;scsi&amp;#x8BBE;&amp;#x5907;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x6210;&amp;#x540E;&amp;#x5C31;&amp;#x4F1A;&amp;#x4F9D;&amp;#x6B21;&amp;#x8C03;&amp;#x7528;&amp;#x5404;&amp;#x5C42;&amp;#x7684;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;&amp;#x8FDB;&amp;#x884C;&amp;#x5B8C;&amp;#x6210;&amp;#x72B6;&amp;#x6001;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x8FD4;&amp;#x56DE;&amp;#x7ED9;&amp;#x4E0A;&amp;#x5C42;&amp;#x7528;&amp;#x6237;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2-3-request-based&amp;#x548C;bio-based&quot;&gt;&lt;a href=&quot;#2-3-request-based&amp;#x548C;bio-based&quot; class=&quot;headerlink&quot; title=&quot;2.3 request-based&amp;#x548C;bio-based&quot;&gt;&lt;/a&gt;2.3 request-based&amp;#x548C;bio-based&lt;/h2&gt;&lt;p&gt;&amp;#x5728;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;I/O&amp;#x5904;&amp;#x7406;&amp;#x6D41;&amp;#x7A0B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4F1A;&amp;#x6D89;&amp;#x53CA;&amp;#x5230;&amp;#x4E24;&amp;#x79CD;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF1A;&lt;br&gt;        1&amp;#xFF09;request-based&amp;#xFF1A;&amp;#x8FD9;&amp;#x79CD;&amp;#x5904;&amp;#x7406;&amp;#x65B9;&amp;#x5F0F;&amp;#x4E0B;&amp;#xFF0C;&amp;#x4F1A;&amp;#x8FDB;&amp;#x884C;bio&amp;#x5408;&amp;#x5E76;&amp;#x5230;request&amp;#xFF08;&amp;#x5373;I/O&amp;#x8C03;&amp;#x5EA6;&amp;#x5408;&amp;#x5E76;&amp;#xFF09;&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x624D;&amp;#x628A;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x76EE;&amp;#x524D;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x90FD;&amp;#x662F;request-based&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#xFF1B;&lt;br&gt;        2&amp;#xFF09;bio-based&amp;#xFF1A;&amp;#x5728;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x81EA;&amp;#x5DF1;&amp;#x5B9A;&amp;#x4E49;&amp;#x7684;request&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;make_request_fn&amp;#x91CC;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x8C03;&amp;#x7528;generic_make_request&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;ramdisk&amp;#x8BBE;&amp;#x5907;&amp;#x3001;&amp;#x5927;&amp;#x90E8;&amp;#x5206;Device Mapper&amp;#x8BBE;&amp;#x5907;&amp;#x3001;virtio-blk&amp;#x90FD;&amp;#x662F;bio-based&amp;#xFF1B;&lt;br&gt;&amp;#x4E0B;&amp;#x56FE;&amp;#x4ECE;Device Mapper&amp;#x7684;&amp;#x89D2;&amp;#x5EA6;&amp;#x6765;&amp;#x8BF4;&amp;#x660E;request-based&amp;#x548C;bio-based&amp;#x5904;&amp;#x7406;&amp;#x6D41;&amp;#x7A0B;&amp;#x7684;&amp;#x533A;&amp;#x522B;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/linux-io-stack/bio-based.png&quot; alt=&quot;bio-based&quot;&gt;&lt;br&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x9700;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#x662F;&amp;#xFF0C;Device mapper&amp;#x76EE;&amp;#x524D;&amp;#x53EA;&amp;#x6709;multipath&amp;#x63D2;&amp;#x4EF6;&amp;#x662F;request-based&amp;#x7684;&amp;#xFF0C;&amp;#x5176;&amp;#x4ED6;&amp;#x7684;&amp;#x5982;linear&amp;#xFF0C;strip&amp;#x90FD;&amp;#x662F;bio-based&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x5982;&amp;#x679C;&amp;#x662F;linear DM&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x91CC;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x8FDB;&amp;#x884C;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x91C7;&amp;#x7528;&amp;#x7F13;&amp;#x5B58;I/O&amp;#x65F6;&amp;#xFF0C;&amp;#x5373;&amp;#x4F7F;&amp;#x5237;&amp;#x810F;&amp;#x9875;&amp;#x65F6;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5728;DM&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4E5F;&amp;#x4E0D;&amp;#x4F1A;&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x53EA;&amp;#x4F1A;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x5982;/dev/sdb&amp;#xFF09;&amp;#x4E0A;&amp;#x624D;&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;4-&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;a href=&quot;#4-&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot; class=&quot;headerlink&quot; title=&quot;4.&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;/a&gt;4.&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/h1&gt;&lt;p&gt;1.&amp;#x300A;&amp;#x6DF1;&amp;#x5165;&amp;#x7406;&amp;#x89E3;LINUX&amp;#x5185;&amp;#x6838;&amp;#x300B;&lt;br&gt;2.&amp;#x300A;LINUX&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x300B;&lt;br&gt;3.&amp;#x300A;&lt;a href=&quot;http://www.ibm.com/developerworks/cn/linux/l-cn-directio/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux&amp;#x4E2D;&amp;#x76F4;&amp;#x63A5;I/O&amp;#x673A;&amp;#x5236;&amp;#x4ECB;&amp;#x7ECD;&lt;/a&gt;&amp;#x300B;&lt;br&gt;4.&amp;#x300A;&lt;a href=&quot;http://www.thomas-krenn.com/en/wiki/Linux_Storage_Stack_Diagram#Diagram_for_Linux_Kernel_3.17&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux I/O stack&lt;/a&gt;&amp;#x300B;&lt;br&gt;5.&amp;#x300A;Request-based Device-mapper multipath and Dynamic load balancing&amp;#x300B;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x7B80;&amp;#x5355;&amp;#x6765;&amp;#x8BF4;&amp;#x5C31;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;&amp;#x7CFB;&amp;#x7EDF;&amp;#x63D0;&amp;#x4F9B;&amp;#x5B58;&amp;#x50A8;&amp;#x670D;&amp;#x52A1;&amp;#x3002;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x5206;&amp;#x591A;&amp;#x79CD;&amp;#x7C7B;&amp;#x578B;&amp;#xFF0C;&amp;#x6709;&amp;#x5355;&amp;#x673A;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x7F51;&amp;#x7EDC;&amp;#x5B58;&amp;#x50A8;&amp;#xFF08;&amp;#x5982;NAS&amp;#xFF0C;SAN&amp;#x7B49;&amp;#xFF09;&amp;#xFF0C;&amp;#x5206;&amp;#x5E03;&amp;#x5F0F;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#xFF08;&amp;#x76EE;&amp;#x524D;&amp;#x4E3B;&amp;#x6D41;&amp;#x7684;&amp;#x5982;AWS&amp;#x7684;EBS&amp;#xFF0C;&amp;#x9752;&amp;#x4E91;&amp;#x7684;&amp;#x4E91;&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;&amp;#x963F;&amp;#x91CC;&amp;#x4E91;&amp;#x7684;&amp;#x4E91;&amp;#x78C1;&amp;#x76D8;&amp;#xFF0C;&amp;#x7F51;&amp;#x6613;&amp;#x4E91;&amp;#x786C;&amp;#x76D8;&amp;#x7B49;&amp;#xFF09;&amp;#x3002;&amp;#x901A;&amp;#x5E38;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&amp;#x5F62;&amp;#x5F0F;&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x770B;&amp;#x5230;&amp;#x7684;&amp;#x5C31;&amp;#x662F;&amp;#x7C7B;&amp;#x4F3C;&amp;#x4E8E;sda&amp;#xFF0C;sdb&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x672C;&amp;#x6587;&amp;#x4E3B;&amp;#x8981;&amp;#x4ECB;&amp;#x7ECD;Linux&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5BF9;Linux&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;I/O&amp;#x6808;&amp;#x8FDB;&amp;#x884C;&amp;#x5206;&amp;#x6790;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&lt;/h1&gt;&lt;p&gt;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5C06;&amp;#x4FE1;&amp;#x606F;&amp;#x5B58;&amp;#x50A8;&amp;#x5728;&amp;#x56FA;&amp;#x5B9A;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x5757;&amp;#x4E2D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5757;&amp;#x90FD;&amp;#x6709;&amp;#x81EA;&amp;#x5DF1;&amp;#x7684;&amp;#x5730;&amp;#x5740;&amp;#x3002;&amp;#x5BF9;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x800C;&amp;#x8A00;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x4EE5;&amp;#x5B57;&amp;#x7B26;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5916;&amp;#x89C2;&amp;#x5C55;&amp;#x73B0;&amp;#x7684;&amp;#xFF0C;&amp;#x4F8B;&amp;#x5982;/dev/sda&amp;#xFF0C;&amp;#x867D;&amp;#x7136;&amp;#x5BF9;&amp;#x8FD9;&amp;#x79CD;&amp;#x5B57;&amp;#x7B26;&amp;#x8BBE;&amp;#x5907;&amp;#x53EF;&amp;#x4EE5;&amp;#x6309;&amp;#x7167;&amp;#x5B57;&amp;#x8282;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x8BBF;&amp;#x95EE;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x5374;&amp;#x662F;&amp;#x4EE5;&amp;#x5757;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF08;&amp;#x6700;&amp;#x5C0F;512byte&amp;#xFF0C;&amp;#x5373;&amp;#x4E00;&amp;#x4E2A;&amp;#x6247;&amp;#x533A;&amp;#xFF09;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E4B;&amp;#x95F4;&amp;#x7684;&amp;#x8F6C;&amp;#x6362;&amp;#x662F;&amp;#x7531;&amp;#x64CD;&amp;#x4F5C;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#x3002;&lt;br&gt;        &amp;#x4E0B;&amp;#x9762;&amp;#x4ECB;&amp;#x7ECD;&amp;#x51E0;&amp;#x4E2A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&amp;#xFF1A;&lt;br&gt;        1&amp;#xFF09;&amp;#x6247;&amp;#x533A;&amp;#xFF1A;&amp;#x78C1;&amp;#x76D8;&amp;#x76D8;&amp;#x7247;&amp;#x4E0A;&amp;#x7684;&amp;#x6247;&amp;#x5F62;&amp;#x533A;&amp;#x57DF;&amp;#xFF0C;&amp;#x903B;&amp;#x8F91;&amp;#x5316;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x7BA1;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x662F;&amp;#x786C;&amp;#x4EF6;&amp;#x8BBE;&amp;#x5907;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x4E00;&amp;#x822C;512Byte&amp;#xFF1B;&lt;br&gt;    2&amp;#xFF09;&amp;#x5757;&amp;#xFF1A;&amp;#x5757;&amp;#x662F;VFS&amp;#x548C;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x662F;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x6574;&amp;#x6570;&amp;#x500D;&amp;#xFF0C;&amp;#x683C;&amp;#x5F0F;&amp;#x5316;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5B9A;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;512,1024,2048,4096&amp;#x5B57;&amp;#x8282;&amp;#xFF09;&amp;#xFF1B;&lt;br&gt;       3&amp;#xFF09;&amp;#x6BB5;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x6216;&amp;#x8005;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x4E2D;&amp;#x7684;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x78C1;&amp;#x76D8;&amp;#x6247;&amp;#x533A;&amp;#x4E2D;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF1B;&amp;#x78C1;&amp;#x76D8;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;I/O&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;RAM&amp;#x5355;&amp;#x5143;&amp;#x4E4B;&amp;#x95F4;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x5185;&amp;#x5BB9;&amp;#xFF0C;&amp;#x5927;&amp;#x591A;&amp;#x6570;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x91C7;&amp;#x7528;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x8FDB;&amp;#x884C;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#x3002;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6BB5;&amp;#x5728;RAM&amp;#x4E2D;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x9875;&amp;#x6846;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x4E5F;&amp;#x662F;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;&amp;#x5408;&amp;#x5E76;&amp;#x5B83;&amp;#x4EEC;&amp;#xFF0C;&amp;#x4EA7;&amp;#x751F;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x533A;&amp;#x57DF;&amp;#x79F0;&amp;#x4E3A;&amp;#x7269;&amp;#x7406;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&amp;#x901A;&amp;#x5E38;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x662F;&amp;#x901A;&amp;#x8FC7;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x6765;&amp;#x8BBF;&amp;#x95EE;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x76F4;&amp;#x63A5;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;&amp;#x6307;&amp;#x5B9A;&amp;#x504F;&amp;#x79FB;&amp;#x548C;&amp;#x5927;&amp;#x5C0F;&amp;#x6765;&amp;#x8BFB;&amp;#x5199;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&amp;#x5E38;&amp;#x89C1;&amp;#x7684;&amp;#x5757;&amp;#x5B58;&amp;#x50A8;&amp;#x8BBE;&amp;#x5907;&amp;#x5C31;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#xFF0C;&amp;#x5728;Linux&amp;#x7CFB;&amp;#x7EDF;&amp;#x4E0B;&amp;#xFF0C;&amp;#x8FD8;&amp;#x63D0;&amp;#x4F9B;&amp;#x57FA;&amp;#x4E8E;&amp;#x5176;&amp;#x4ED6;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x4E4B;&amp;#x4E0A;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5982;Device Mapper&amp;#xFF0C;&amp;#x8F6F;RAID&amp;#x7B49;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="io stack" scheme="http://yoursite.com/tags/io-stack/"/>
    
  </entry>
  
  <entry>
    <title>tgt程序框架</title>
    <link href="http://yoursite.com/2016/05/12/tgt-arch/"/>
    <id>http://yoursite.com/2016/05/12/tgt-arch/</id>
    <published>2016-05-12T13:39:11.000Z</published>
    <updated>2016-05-12T13:50:44.401Z</updated>
    
    <content type="html">&lt;p&gt;tgt&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;iscsi target&amp;#xFF0C;&amp;#x800C;iet&amp;#xFF08;iscsi enterprise target&amp;#xFF09;&amp;#x662F;&amp;#x5728;&amp;#x5185;&amp;#x6838;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;target&amp;#xFF0C;tgt&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;iet&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5176;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x8C03;&amp;#x8BD5;&amp;#xFF0C;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x4E00;&amp;#x4E9B;&amp;#x529F;&amp;#x80FD;&amp;#x7B49;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x6027;&amp;#x80FD;&amp;#x76F8;&amp;#x6BD4;iet&amp;#x6765;&amp;#x8BF4;&amp;#x8981;&amp;#x7A0D;&amp;#x5DEE;&amp;#x4E00;&amp;#x70B9;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x5C31;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E00;&amp;#x4E0B;tgt&amp;#x7684;&amp;#x7A0B;&amp;#x5E8F;&amp;#x6846;&amp;#x67B6;&amp;#xFF08;&amp;#x7565;&amp;#x8FC7;iscsi&amp;#x534F;&amp;#x8BAE;&amp;#x89E3;&amp;#x6790;&amp;#x5904;&amp;#x7406;&amp;#x90E8;&amp;#x5206;&amp;#xFF09;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4FBF;&amp;#x4E8E;&amp;#x6574;&amp;#x4F53;&amp;#x628A;&amp;#x63E1;tgt&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x540E;&amp;#x7EED;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x4FEE;&amp;#x6539;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot;&gt;&lt;a href=&quot;#1-&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot;&gt;&lt;/a&gt;1.&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&lt;/h1&gt;&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;tgt&amp;#x5B98;&amp;#x7F51;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x5F20;&amp;#x56FE;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/tgt-arch.png&quot; alt=&quot;tgt-arch&quot;&gt;&lt;br&gt;tgt&amp;#x4E2D;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x4E0E;initiator&amp;#x7AEF;&amp;#x7684;&amp;#x901A;&amp;#x4FE1;&amp;#x90FD;&amp;#x662F;&amp;#x901A;&amp;#x8FC7;epoll&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#xFF0C;&amp;#x4E0B;&amp;#x9762;&amp;#x5206;&amp;#x522B;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E24;&amp;#x90E8;&amp;#x5206;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-1-tgtadm&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot;&gt;&lt;a href=&quot;#1-1-tgtadm&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot; class=&quot;headerlink&quot; title=&quot;1.1 tgtadm&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot;&gt;&lt;/a&gt;1.1 tgtadm&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&lt;/h2&gt;&lt;p&gt;&amp;#x5728;&amp;#x542F;&amp;#x52A8;tgtd&amp;#x8FDB;&amp;#x7A0B;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x4E00;&amp;#x4E2A;unix socket&amp;#xFF0C;&amp;#x5C06;&amp;#x8BE5;fd&amp;#x52A0;&amp;#x5230;epoll&amp;#x4E2D;&amp;#xFF0C;&amp;#x76D1;&amp;#x542C;EPOLLIN&amp;#x4E8B;&amp;#x4EF6;&amp;#xFF0C;&amp;#x540E;&amp;#x7EED;&amp;#x6BCF;&amp;#x6267;&amp;#x884C;&amp;#x4E00;&amp;#x6761;tgtadm&amp;#x547D;&amp;#x4EE4;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x4F7F;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;unix socket&amp;#x6765;&amp;#x548C;tgtd&amp;#x901A;&amp;#x4FE1;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/tgtadm.png&quot; alt=&quot;tgtadm&quot;&gt;&lt;br&gt;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#xFF0C;&amp;#x5F53;&amp;#x5728;&amp;#x547D;&amp;#x4EE4;&amp;#x884C;&amp;#x91CC;&amp;#x6572;&amp;#x4E00;&amp;#x6761;tgtadm&amp;#x547D;&amp;#x4EE4;&amp;#x65F6;&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;unix socket&amp;#x53D1;&amp;#x8D77;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x89E6;&amp;#x53D1;epoll &amp;#x7684;EPOLLIN&amp;#x4E8B;&amp;#x4EF6;&amp;#xFF0C;tgtd&amp;#x7AEF;accept&amp;#xFF0C;&amp;#x5C06;&amp;#x8FDE;&amp;#x63A5;fd&amp;#x52A0;&amp;#x5230;epoll&amp;#x4E2D;&amp;#xFF0C;&amp;#x5E76;&amp;#x6CE8;&amp;#x518C;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;mtask_recv_send_handler&amp;#xFF0C;&amp;#x8FD4;&amp;#x56DE;&amp;#x8FDE;&amp;#x63A5;&amp;#x5EFA;&amp;#x7ACB;&amp;#x7684;&amp;#x54CD;&amp;#x5E94;&amp;#x7ED9;tgtadm&amp;#x7AEF;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;tgtadm&amp;#x547D;&amp;#x4EE4;&amp;#x89E6;&amp;#x53D1;EPOLLIN&amp;#x4E8B;&amp;#x4EF6;&amp;#xFF0C;tgtd&amp;#x7AEF;&amp;#x8C03;&amp;#x7528;mtask_recv_send_handler&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;mode&amp;#x8C03;&amp;#x7528;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF08;&amp;#x8FD9;&amp;#x91CC;&amp;#x6709;sys_mgmt/target_mgmt/portal_mgmt&amp;#x7B49;&amp;#xFF09;&amp;#xFF0C;&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x540E;&amp;#xFF0C;&amp;#x5C06;&amp;#x4E8B;&amp;#x4EF6;&amp;#x6539;&amp;#x4E3A;EPOLLIN|EPOLLOUT&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x53D1;&amp;#x9001;&amp;#x54CD;&amp;#x5E94;&amp;#x7ED9;tgtadm&amp;#x7AEF;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-2-initiator&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot;&gt;&lt;a href=&quot;#1-2-initiator&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot; class=&quot;headerlink&quot; title=&quot;1.2 initiator&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&quot;&gt;&lt;/a&gt;1.2 initiator&amp;#x4E0E;tgtd&amp;#x7684;&amp;#x4EA4;&amp;#x4E92;&lt;/h2&gt;&lt;p&gt;tgtd&amp;#x8FDB;&amp;#x7A0B;&amp;#x5728;&amp;#x542F;&amp;#x52A8;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x4F1A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;socket&amp;#xFF0C;&amp;#x7528;&amp;#x4E8E;&amp;#x76D1;&amp;#x542C;initiator&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF08;&amp;#x5177;&amp;#x4F53;&amp;#x662F;iscsi_tcp_init_portal&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#xFF09;&amp;#xFF0C;&amp;#x5C06;&amp;#x8BE5;socket&amp;#x52A0;&amp;#x5230;epoll&amp;#x4E2D;&amp;#xFF0C;&amp;#x6CE8;&amp;#x518C;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;accept_connection&amp;#x3002;&lt;br&gt;initiator&amp;#x7AEF;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5230;&amp;#x6765;&amp;#x65F6;&amp;#xFF0C;&amp;#x5C06;&amp;#x65B0;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;fd&amp;#x52A0;&amp;#x5230;epoll&amp;#x4E2D;&amp;#xFF0C;&amp;#x5E76;&amp;#x6CE8;&amp;#x518C;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;iscsi_tcp_event_handler&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5F53;&amp;#x6536;&amp;#x5230;EPOLLIN&amp;#x4E8B;&amp;#x4EF6;&amp;#x65F6;&amp;#xFF0C;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;iscsi_rx_handler&amp;#x8FDB;&amp;#x884C;iscsi&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x89E3;&amp;#x6790;&amp;#x5904;&amp;#x7406;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x5E76;&amp;#x8C03;&amp;#x7528;backing store&amp;#x7684;&amp;#x63A5;&amp;#x53E3;&amp;#x8FDB;&amp;#x884C;io&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x64CD;&amp;#x4F5C;&amp;#x5B8C;&amp;#x6210;&amp;#x540E;&amp;#xFF0C;&amp;#x4FEE;&amp;#x6539;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E3A;EPOLLLOUT&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x89E6;&amp;#x53D1;&amp;#x8C03;&amp;#x7528;&amp;#x5230;iscsi_tx_handler&amp;#x6765;&amp;#x53D1;&amp;#x9001;&amp;#x54CD;&amp;#x5E94;&amp;#x7ED9;initiator&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/initiator.png&quot; alt=&quot;initiator&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-3-&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&quot;&gt;&lt;a href=&quot;#1-3-&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&quot; class=&quot;headerlink&quot; title=&quot;1.3 &amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&quot;&gt;&lt;/a&gt;1.3 &amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&lt;/h2&gt;&lt;p&gt;&amp;#x4E0B;&amp;#x9762;&amp;#x7ED9;&amp;#x51FA;&amp;#x4E86;iscsi_rx_handler&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x5176;&amp;#x4E2D;&amp;#x6D89;&amp;#x53CA;&amp;#x5230;&amp;#x4E0E;backing store&amp;#x4E2D;io&amp;#x5904;&amp;#x7406;&amp;#x63A5;&amp;#x53E3;&amp;#x7684;&amp;#x8C03;&amp;#x7528;&amp;#x5173;&amp;#x7CFB;&amp;#x3002;&amp;#x7ED9;&amp;#x51FA;&amp;#x4E0B;&amp;#x56FE;&amp;#x4F5C;&amp;#x4E3A;&amp;#x53C2;&amp;#x8003;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/stack.png&quot; alt=&quot;stack&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;2-backing-store&quot;&gt;&lt;a href=&quot;#2-backing-store&quot; class=&quot;headerlink&quot; title=&quot;2. backing store&quot;&gt;&lt;/a&gt;2. backing store&lt;/h1&gt;&lt;p&gt;tgt&amp;#x652F;&amp;#x6301;&amp;#x591A;&amp;#x79CD;&amp;#x540E;&amp;#x7AEF;&amp;#x5B58;&amp;#x50A8;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;rdwr&amp;#xFF0C;aio&amp;#xFF0C;sg&amp;#xFF0C;rbd&amp;#xFF0C;sheepdog&amp;#x7B49;&amp;#xFF0C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x662F;rdwr&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5B9A;flag&amp;#xFF08;O_SYNC|O_DIRECT&amp;#xFF09;&amp;#x3002;&amp;#x4E86;&amp;#x89E3;&amp;#x6E05;&amp;#x695A;tgt&amp;#x7684;&amp;#x540E;&amp;#x7AEF;&amp;#x5B58;&amp;#x50A8;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x6DFB;&amp;#x52A0;&amp;#x65B0;&amp;#x7684;&amp;#x540E;&amp;#x7AEF;&amp;#x5B58;&amp;#x50A8;&amp;#x7528;&amp;#x4E8E;&amp;#x652F;&amp;#x6301;&amp;#x81EA;&amp;#x5B9A;&amp;#x4E49;&amp;#x7684;&amp;#x529F;&amp;#x80FD;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/bs.png&quot; alt=&quot;bs&quot;&gt;&lt;br&gt;&amp;#x5176;&amp;#x4E2D;&amp;#x4E3B;&amp;#x8981;&amp;#x7684;&amp;#x63A5;&amp;#x53E3;&amp;#x5C31;&amp;#x662F;bs_open,bs_init,bs_cmd_submit,bs_close,bs_exit&amp;#x3002;&lt;br&gt;bs_open&amp;#x548C;bs_init&amp;#x5C31;&amp;#x662F;&amp;#x505A;&amp;#x521B;&amp;#x5EFA;lun&amp;#x65F6;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&amp;#x6253;&amp;#x5F00;&amp;#x8BBE;&amp;#x5907;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x521B;&amp;#x5EFA;&amp;#x5904;&amp;#x7406;&amp;#x73B0;&amp;#x7EBF;&amp;#x7A0B;&amp;#xFF0C;&amp;#x6CE8;&amp;#x518C;&amp;#x5904;&amp;#x7406;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;&amp;#x7B49;&amp;#x3002;&lt;br&gt;bs_cmd_submit&amp;#xFF1A;io&amp;#x8BF7;&amp;#x6C42;&amp;#x5230;&amp;#x6765;&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;&lt;br&gt;bs_close&amp;#x548C;bs_exit&amp;#x5C31;&amp;#x662F;&amp;#x5220;&amp;#x9664;lun&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x505A;&amp;#x4E00;&amp;#x4E9B;&amp;#x9500;&amp;#x6BC1;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002;&lt;br&gt;BS&amp;#x4E2D;&amp;#x652F;&amp;#x6301;&amp;#x540C;&amp;#x6B65;&amp;#x548C;&amp;#x5F02;&amp;#x6B65;io&amp;#x4E24;&amp;#x79CD;&amp;#x6A21;&amp;#x5F0F;&amp;#xFF08;rdwr&amp;#x5C31;&amp;#x662F;&amp;#x540C;&amp;#x6B65;&amp;#x7684;&amp;#xFF0C;aio&amp;#x5C31;&amp;#x662F;&amp;#x5F02;&amp;#x6B65;&amp;#x7684;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E0B;&amp;#x9762;&amp;#x5206;&amp;#x522B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x8FD9;&amp;#x4E24;&amp;#x79CD;&amp;#x6A21;&amp;#x5F0F;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2-1-&amp;#x540C;&amp;#x6B65;io&quot;&gt;&lt;a href=&quot;#2-1-&amp;#x540C;&amp;#x6B65;io&quot; class=&quot;headerlink&quot; title=&quot;2.1 &amp;#x540C;&amp;#x6B65;io&quot;&gt;&lt;/a&gt;2.1 &amp;#x540C;&amp;#x6B65;io&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/syncio.png&quot; alt=&quot;syncio&quot;&gt;&lt;br&gt;&amp;#x5728;&amp;#x540C;&amp;#x6B65;io&amp;#x4E2D;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;lun&amp;#x90FD;&amp;#x4F1A;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x961F;&amp;#x5217;&amp;#xFF08;pending_list&amp;#xFF09;&amp;#xFF0C;&amp;#x5728;bs_init&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x521B;&amp;#x5EFA;&amp;#x591A;&amp;#x4E2A;&amp;#x7EBF;&amp;#x7A0B;&amp;#xFF08;&amp;#x76EE;&amp;#x524D;&amp;#x65B0;&amp;#x7248;&amp;#x672C;&amp;#x4E00;&amp;#x4E2A;lun&amp;#x9ED8;&amp;#x8BA4;16&amp;#x4E2A;&amp;#x7EBF;&amp;#x7A0B;&amp;#xFF09;&amp;#x3002;&amp;#x65B0;&amp;#x8BF7;&amp;#x6C42;&amp;#x5230;&amp;#x6765;&amp;#x65F6;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;bs_cmd_submit&amp;#x5C06;&amp;#x8BF7;&amp;#x6C42;&amp;#x6DFB;&amp;#x52A0;&amp;#x5230;pending_list&amp;#x4E2D;&amp;#xFF0C;&amp;#x591A;&amp;#x4E2A;&amp;#x7EBF;&amp;#x7A0B;&amp;#x5171;&amp;#x4EAB;&amp;#x8FD9;&amp;#x4E2A;pending_list&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x4ECE;pending_list&amp;#x4E2D;&amp;#x53D6;&amp;#x8BF7;&amp;#x6C42;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;&amp;#x5F53;&amp;#x6CA1;&amp;#x6709;&amp;#x8BF7;&amp;#x6C42;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x7EBF;&amp;#x7A0B;&amp;#x5C31;&amp;#x4F1A;&amp;#x7B49;&amp;#x5F85;&amp;#x5728;pending_list&amp;#x4E0A;&amp;#xFF0C;&amp;#x6709;&amp;#x65B0;&amp;#x8BF7;&amp;#x6C42;&amp;#x52A0;&amp;#x5165;&amp;#x5230;pending_lsit&amp;#x540E;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x5524;&amp;#x9192;&amp;#x7B49;&amp;#x5F85;&amp;#x7684;&amp;#x7EBF;&amp;#x7A0B;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2-2-&amp;#x5F02;&amp;#x6B65;io&amp;#xFF08;aio&amp;#xFF09;&quot;&gt;&lt;a href=&quot;#2-2-&amp;#x5F02;&amp;#x6B65;io&amp;#xFF08;aio&amp;#xFF09;&quot; class=&quot;headerlink&quot; title=&quot;2.2 &amp;#x5F02;&amp;#x6B65;io&amp;#xFF08;aio&amp;#xFF09;&quot;&gt;&lt;/a&gt;2.2 &amp;#x5F02;&amp;#x6B65;io&amp;#xFF08;aio&amp;#xFF09;&lt;/h2&gt;&lt;p&gt;tgt&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;linux native aio&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;eventfd&amp;#x521B;&amp;#x5EFA;&amp;#x7684;fd&amp;#x5C06;aio&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#x548C;epoll&amp;#x8054;&amp;#x7CFB;&amp;#x8D77;&amp;#x6765;&amp;#x3002;&amp;#xFF08;&amp;#x5177;&amp;#x4F53;&amp;#x53EF;&amp;#x4EE5;&amp;#x53C2;&amp;#x8003;aio&amp;#x4E0E;epoll&amp;#x7ED3;&amp;#x5408;&amp;#x8D77;&amp;#x6765;&amp;#x5982;&amp;#x4F55;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x8D44;&amp;#x6599;&amp;#xFF09;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x662F;&amp;#x4E00;&amp;#x4E9B;&amp;#x5177;&amp;#x4F53;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x903B;&amp;#x8F91;&amp;#x3002;&lt;br&gt;1&amp;#xFF09;bs_aio_open&amp;#xFF1A;io_setup&amp;#x5EFA;&amp;#x7ACB;&amp;#x5F02;&amp;#x6B65;io&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587; &amp;#xFF0C;&amp;#x7136;&amp;#x540E;afd=eventfd() &amp;#xFF0C;&amp;#x5C06;afd&amp;#x52A0;&amp;#x5230;epoll&amp;#x4E2D;(&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;bs_aio_get_completions) &amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;afd&amp;#x4E0E;aio&amp;#x7684;&amp;#x4E0A;&amp;#x4E0B;&amp;#x6587;&amp;#x5173;&amp;#x8054;&amp;#x3002;&lt;br&gt;2&amp;#xFF09;bs_aio_cmd_submit&amp;#xFF1A;IO&amp;#x5230;&amp;#x6765;&amp;#x65F6;&amp;#x8C03;&amp;#x7528;&amp;#xFF0C;&amp;#x5148;&amp;#x628A;&amp;#x8BF7;&amp;#x6C42;&amp;#x52A0;&amp;#x5230;cmd_wait_list&amp;#x4E2D;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x904D;&amp;#x5386;list&amp;#xFF0C;&amp;#x786E;&amp;#x5B9A;&amp;#x6B64;&amp;#x6B21;&amp;#x80FD;&amp;#x63D0;&amp;#x4EA4;&amp;#x7684;io&amp;#x6570;&amp;#x5E76;&amp;#x521D;&amp;#x59CB;&amp;#x5316;iocb&amp;#xFF08;&amp;#x56E0;&amp;#x4E3A;&amp;#x9650;&amp;#x5236;&amp;#x4E86;aio&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x5904;&amp;#x7406;&amp;#x4E2A;&amp;#x6570;&amp;#x4E3A;128&amp;#xFF0C;&amp;#x6709;&amp;#x4E9B;io&amp;#x8FD8;&amp;#x5728;&amp;#x5904;&amp;#x7406;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5F53;&amp;#x524D;&amp;#x63D0;&amp;#x4EA4;&amp;#x7684;aio&amp;#x4E2A;&amp;#x6570;&amp;#x5C31;&amp;#x6709;&amp;#x9650;&amp;#xFF09;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4F7F;&amp;#x7528;io_submit&amp;#x63D0;&amp;#x4EA4;&amp;#x4E00;&amp;#x6279;&amp;#x5F02;&amp;#x6B65;io&amp;#x3002;&lt;br&gt;3&amp;#xFF09;IO&amp;#x5904;&amp;#x7406;&amp;#x5B8C;&amp;#x540E;&amp;#xFF0C;&amp;#x4F1A;&amp;#x901A;&amp;#x8FC7;afd&amp;#x89E6;&amp;#x53D1;EPOLLIN&amp;#x4E8B;&amp;#x4EF6;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;bs_aio_get_completions&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5148;read&amp;#x51FA;&amp;#x5F53;&amp;#x524D;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;io&amp;#x6570;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x8C03;&amp;#x7528;&lt;br&gt;io_getevents()&amp;#x83B7;&amp;#x53D6;&amp;#x51FA;&amp;#x5DF2;&amp;#x5B8C;&amp;#x6210;io&amp;#x7684;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5BF9;&amp;#x6BCF;&amp;#x4E2A;&amp;#x5B8C;&amp;#x6210;&amp;#x7684;io&amp;#x8C03;&amp;#x7528;bs_aio_comlete_one&amp;#x505A;&amp;#x4E00;&amp;#x4E9B;&amp;#x7ED3;&amp;#x675F;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#xFF08;&amp;#x4FEE;&amp;#x6539;&amp;#x5904;&amp;#x7406;&amp;#x72B6;&amp;#x6001;&amp;#xFF09;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x8C03;&amp;#x7528;target_cmd_io_done&amp;#xFF0C;&amp;#x5728;target_cmd_io_done&amp;#x4E2D;&amp;#x4F1A;&amp;#x4FEE;&amp;#x6539;epoll&amp;#x7684;&amp;#x4E8B;&amp;#x4EF6;&amp;#x4E3A;EPOLLIN|EPOLLOUT&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x4F1A;&amp;#x89E6;&amp;#x53D1;&amp;#x4E86;EPOLLOUT&amp;#x4E8B;&amp;#x4EF6;&amp;#xFF0C;&amp;#x8C03;&amp;#x7528;iscsi_tcp_event_handler&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x91CC;&amp;#x5224;&amp;#x65AD;&amp;#x5982;&amp;#x679C;&amp;#x662F;EPOLLOUT&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;iscsi_tx_handler&amp;#x6765;&amp;#x53D1;&amp;#x9001;&amp;#x54CD;&amp;#x5E94;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;a href=&quot;#3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;/a&gt;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://stgt.sourceforge.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://stgt.sourceforge.net/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.lenky.info/archives/2013/01/2183&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.lenky.info/archives/2013/01/2183&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;tgt&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;iscsi target&amp;#xFF0C;&amp;#x800C;iet&amp;#xFF08;iscsi enterprise target&amp;#xFF09;&amp;#x662F;&amp;#x5728;&amp;#x5185;&amp;#x6838;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;target&amp;#xFF0C;tgt&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;iet&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x5176;&amp;#x7528;&amp;#x6237;&amp;#x6001;&amp;#x5B9E;&amp;#x73B0;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x8C03;&amp;#x8BD5;&amp;#xFF0C;&amp;#x65B0;&amp;#x52A0;&amp;#x5165;&amp;#x4E00;&amp;#x4E9B;&amp;#x529F;&amp;#x80FD;&amp;#x7B49;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x6027;&amp;#x80FD;&amp;#x76F8;&amp;#x6BD4;iet&amp;#x6765;&amp;#x8BF4;&amp;#x8981;&amp;#x7A0D;&amp;#x5DEE;&amp;#x4E00;&amp;#x70B9;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x5C31;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E00;&amp;#x4E0B;tgt&amp;#x7684;&amp;#x7A0B;&amp;#x5E8F;&amp;#x6846;&amp;#x67B6;&amp;#xFF08;&amp;#x7565;&amp;#x8FC7;iscsi&amp;#x534F;&amp;#x8BAE;&amp;#x89E3;&amp;#x6790;&amp;#x5904;&amp;#x7406;&amp;#x90E8;&amp;#x5206;&amp;#xFF09;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4FBF;&amp;#x4E8E;&amp;#x6574;&amp;#x4F53;&amp;#x628A;&amp;#x63E1;tgt&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&amp;#xFF0C;&amp;#x65B9;&amp;#x4FBF;&amp;#x540E;&amp;#x7EED;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x4FEE;&amp;#x6539;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot;&gt;&lt;a href=&quot;#1-&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&quot;&gt;&lt;/a&gt;1.&amp;#x6574;&amp;#x4F53;&amp;#x6846;&amp;#x67B6;&lt;/h1&gt;&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;tgt&amp;#x5B98;&amp;#x7F51;&amp;#x7ED9;&amp;#x51FA;&amp;#x7684;&amp;#x4E00;&amp;#x5F20;&amp;#x56FE;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/tgt-arch/tgt-arch.png&quot; alt=&quot;tgt-arch&quot;&gt;&lt;br&gt;tgt&amp;#x4E2D;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x4E0E;initiator&amp;#x7AEF;&amp;#x7684;&amp;#x901A;&amp;#x4FE1;&amp;#x90FD;&amp;#x662F;&amp;#x901A;&amp;#x8FC7;epoll&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#xFF0C;&amp;#x4E0B;&amp;#x9762;&amp;#x5206;&amp;#x522B;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E24;&amp;#x90E8;&amp;#x5206;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
      <category term="iscsi" scheme="http://yoursite.com/categories/storage/iscsi/"/>
    
    
      <category term="tgt" scheme="http://yoursite.com/tags/tgt/"/>
    
      <category term="iscsi" scheme="http://yoursite.com/tags/iscsi/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2016/05/12/hello-world/"/>
    <id>http://yoursite.com/2016/05/12/hello-world/</id>
    <published>2016-05-12T13:36:48.254Z</published>
    <updated>2016-04-28T07:42:28.455Z</updated>
    
    <content type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;Quick-Start&quot;&gt;&lt;a href=&quot;#Quick-Start&quot; class=&quot;headerlink&quot; title=&quot;Quick Start&quot;&gt;&lt;/a&gt;Quick Start&lt;/h2&gt;&lt;h3 id=&quot;Create-a-new-post&quot;&gt;&lt;a href=&quot;#Create-a-new-post&quot; class=&quot;headerlink&quot; title=&quot;Create a new post&quot;&gt;&lt;/a&gt;Create a new post&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo new &lt;span class=&quot;string&quot;&gt;&amp;quot;My New Post&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;https://hexo.io/docs/writing.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Writing&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Run-server&quot;&gt;&lt;a href=&quot;#Run-server&quot; class=&quot;headerlink&quot; title=&quot;Run server&quot;&gt;&lt;/a&gt;Run server&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo server&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;https://hexo.io/docs/server.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Server&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Generate-static-files&quot;&gt;&lt;a href=&quot;#Generate-static-files&quot; class=&quot;headerlink&quot; title=&quot;Generate static files&quot;&gt;&lt;/a&gt;Generate static files&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo generate&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;https://hexo.io/docs/generating.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Generating&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Deploy-to-remote-sites&quot;&gt;&lt;a href=&quot;#Deploy-to-remote-sites&quot; class=&quot;headerlink&quot; title=&quot;Deploy to remote sites&quot;&gt;&lt;/a&gt;Deploy to remote sites&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ hexo deploy&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;a href=&quot;https://hexo.io/docs/deployment.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Deployment&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>bcache浅析</title>
    <link href="http://yoursite.com/2016/05/12/bcache-analysis/"/>
    <id>http://yoursite.com/2016/05/12/bcache-analysis/</id>
    <published>2016-05-12T09:43:08.000Z</published>
    <updated>2016-05-12T10:28:19.782Z</updated>
    
    <content type="html">&lt;h1 id=&quot;1-&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;1.&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;bcache&amp;#x662F;linux&amp;#x5185;&amp;#x6838;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5C42;cache&amp;#xFF0C;&amp;#x7C7B;&amp;#x4F3C;&amp;#x4E8E;flashcache&amp;#x4F7F;&amp;#x7528;ssd&amp;#x4F5C;&amp;#x4E3A;hdd&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;flashcache&amp;#xFF0C;bcache&amp;#x66F4;&amp;#x52A0;&amp;#x7075;&amp;#x6D3B;&amp;#xFF0C;&amp;#x652F;&amp;#x6301;ssd&amp;#x4F5C;&amp;#x4E3A;&amp;#x591A;&amp;#x5757;hdd&amp;#x7684;&amp;#x5171;&amp;#x4EAB;&amp;#x7F13;&amp;#x5B58;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8FD8;&amp;#x652F;&amp;#x6301;&amp;#x591A;&amp;#x5757;ssd&amp;#xFF08;&amp;#x8FD8;&amp;#x672A;&amp;#x5B8C;&amp;#x5584;&amp;#xFF09;&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x5728;&amp;#x8FD0;&amp;#x884C;&amp;#x4E2D;&amp;#x52A8;&amp;#x6001;&amp;#x589E;&amp;#x52A0;&amp;#xFF0C;&amp;#x5220;&amp;#x9664;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x4ECE;3.10&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;bcache&amp;#x8FDB;&amp;#x5165;&amp;#x5185;&amp;#x6838;&amp;#x4E3B;&amp;#x7EBF;&amp;#x3002;bcache&amp;#x652F;&amp;#x6301;writeback&amp;#x3001;writethrough&amp;#x3001;writearoud&amp;#x4E09;&amp;#x79CD;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;wriththrough&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x52A8;&amp;#x6001;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x7F13;&amp;#x5B58;&amp;#x66FF;&amp;#x6362;&amp;#x65B9;&amp;#x5F0F;&amp;#x652F;&amp;#x6301;lru&amp;#x3001;fifo&amp;#x548C;random&amp;#x4E09;&amp;#x79CD;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x4ECE;&amp;#x51E0;&amp;#x4E2A;&amp;#x65B9;&amp;#x9762;&amp;#x4ECB;&amp;#x7ECD;bcache&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;a href=&quot;#2-&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;/a&gt;2.&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&lt;/h1&gt;&lt;p&gt;bcache&amp;#x7684;&amp;#x6574;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/arch.png&quot; alt=&quot;arch&quot;&gt;&lt;br&gt;bcache&amp;#x4E2D;&amp;#x662F;&amp;#x4EE5;cache set&amp;#x6765;&amp;#x5212;&amp;#x5206;&amp;#x4E0D;&amp;#x540C;&amp;#x5B58;&amp;#x50A8;&amp;#x96C6;&amp;#x5408;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;cache set&amp;#x4E2D;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;&amp;#x662F;ssd&amp;#xFF09;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;&amp;#x662F;hdd&amp;#xFF09;&amp;#x3002;bcache&amp;#x5BF9;&amp;#x5916;&amp;#x8F93;&amp;#x51FA;&amp;#x7ED9;&amp;#x7528;&amp;#x6237;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;/dev/bcache&lt;n&gt;&amp;#x8FD9;&amp;#x79CD;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;bcache&lt;n&gt;&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E00;&amp;#x4E00;&amp;#x5BF9;&amp;#x5E94;&amp;#x3002;&amp;#x7528;&amp;#x6237;&amp;#x5BF9;&amp;#x4E0D;&amp;#x540C;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&amp;#x4F1A;&amp;#x7F13;&amp;#x5B58;&amp;#x5728;ssd&amp;#x4E2D;&amp;#xFF0C;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x4F1A;&amp;#x5199;&amp;#x5230;&amp;#x5404;&amp;#x81EA;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;bcache&amp;#x6269;&amp;#x5BB9;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#xFF0C;&amp;#x53EA;&amp;#x8981;&amp;#x6CE8;&amp;#x518C;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/n&gt;&lt;/n&gt;&lt;/p&gt;
&lt;h1 id=&quot;3-bcache&amp;#x5173;&amp;#x952E;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;a href=&quot;#3-bcache&amp;#x5173;&amp;#x952E;&amp;#x7ED3;&amp;#x6784;&quot; class=&quot;headerlink&quot; title=&quot;3.bcache&amp;#x5173;&amp;#x952E;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;/a&gt;3.bcache&amp;#x5173;&amp;#x952E;&amp;#x7ED3;&amp;#x6784;&lt;/h1&gt;&lt;h2 id=&quot;3-1-bucket&quot;&gt;&lt;a href=&quot;#3-1-bucket&quot; class=&quot;headerlink&quot; title=&quot;3.1 bucket&quot;&gt;&lt;/a&gt;3.1 bucket&lt;/h2&gt;&lt;p&gt;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x4F1A;&amp;#x6309;&amp;#x7167;bucket&amp;#x5927;&amp;#x5C0F;&amp;#x5212;&amp;#x5206;&amp;#x6210;&amp;#x5F88;&amp;#x591A;bucket&amp;#xFF0C;bucket&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x6700;&amp;#x597D;&amp;#x662F;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x4E0E;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;ssd&amp;#x7684;&amp;#x64E6;&amp;#x9664;&amp;#x5927;&amp;#x5C0F;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;&amp;#x4E00;&amp;#x822C;&amp;#x5EFA;&amp;#x8BAE;128k~2M+&amp;#xFF0C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;512k&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;bucket&amp;#x6709;&amp;#x4E2A;&amp;#x4F18;&amp;#x5148;&amp;#x7EA7;&amp;#x7F16;&amp;#x53F7;&amp;#xFF08;16 bit&amp;#x7684;priority&amp;#xFF09;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;hit&amp;#x90FD;&amp;#x4F1A;&amp;#x589E;&amp;#x52A0;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x6240;&amp;#x6709;&amp;#x7684;bucket&amp;#x7684;&amp;#x4F18;&amp;#x5148;&amp;#x7EA7;&amp;#x7F16;&amp;#x53F7;&amp;#x90FD;&amp;#x4F1A;&amp;#x5468;&amp;#x671F;&amp;#x6027;&amp;#x5730;&amp;#x51CF;&amp;#x5C11;&amp;#xFF0C;&amp;#x4E0D;&amp;#x5E38;&amp;#x7528;&amp;#x7684;&amp;#x4F1A;&amp;#x88AB;&amp;#x56DE;&amp;#x6536;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x4F18;&amp;#x5148;&amp;#x7EA7;&amp;#x7F16;&amp;#x53F7;&amp;#x4E3B;&amp;#x8981;&amp;#x662F;&amp;#x7528;&amp;#x6765;&amp;#x5B9E;&amp;#x73B0;lru&amp;#x66FF;&amp;#x6362;&amp;#x7684;&amp;#x3002;bucket&amp;#x8FD8;&amp;#x6709;8bit&amp;#x7684;generation&amp;#xFF0C;&amp;#x7528;&amp;#x6765;invalidate bucket&amp;#x7528;&amp;#x7684;&amp;#x3002;&lt;br&gt;bucket&amp;#x5185;&amp;#x7A7A;&amp;#x95F4;&amp;#x662F;&amp;#x8FFD;&amp;#x52A0;&amp;#x5206;&amp;#x914D;&amp;#x7684;&amp;#xFF0C;&amp;#x53EA;&amp;#x8BB0;&amp;#x5F55;&amp;#x5F53;&amp;#x524D;&amp;#x5206;&amp;#x914D;&amp;#x5230;&amp;#x54EA;&amp;#x4E2A;&amp;#x504F;&amp;#x79FB;&amp;#x4E86;&amp;#xFF0C;&amp;#x4E0B;&amp;#x4E00;&amp;#x6B21;&amp;#x5206;&amp;#x914D;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x4ECE;&amp;#x5F53;&amp;#x524D;&amp;#x8BB0;&amp;#x5F55;&amp;#x4F4D;&amp;#x7F6E;&amp;#x5F80;&amp;#x540E;&amp;#x5206;&amp;#x914D;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#x5728;&amp;#x9009;&amp;#x62E9;bucket&amp;#x6765;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x65F6;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x4F18;&amp;#x5148;&amp;#x539F;&amp;#x5219;&amp;#xFF1A;1&amp;#xFF09;&amp;#x4F18;&amp;#x5148;&amp;#x8003;&amp;#x8651;io&amp;#x8FDE;&amp;#x7EED;&amp;#x6027;&amp;#xFF0C;&amp;#x5373;&amp;#x4F7F;io&amp;#x53EF;&amp;#x80FD;&amp;#x6765;&amp;#x81EA;&amp;#x4E8E;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x751F;&amp;#x4EA7;&amp;#x8005;&amp;#xFF1B;2&amp;#xFF09;&amp;#x5176;&amp;#x6B21;&amp;#x8003;&amp;#x8651;&amp;#x76F8;&amp;#x5173;&amp;#x6027;&amp;#xFF0C;&amp;#x540C;&amp;#x4E00;&amp;#x4E2A;&amp;#x8FDB;&amp;#x7A0B;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5C3D;&amp;#x91CF;&amp;#x7F13;&amp;#x5B58;&amp;#x5230;&amp;#x76F8;&amp;#x540C;&amp;#x7684;bucket&amp;#x91CC;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;3-2-bkey&quot;&gt;&lt;a href=&quot;#3-2-bkey&quot; class=&quot;headerlink&quot; title=&quot;3.2 bkey&quot;&gt;&lt;/a&gt;3.2 bkey&lt;/h2&gt;&lt;p&gt;bucket&amp;#x7684;&amp;#x7BA1;&amp;#x7406;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;b+&amp;#x6811;&amp;#x7D22;&amp;#x5F15;&amp;#xFF0C;&amp;#x800C;b+&amp;#x6811;&amp;#x8282;&amp;#x70B9;&amp;#x4E2D;&amp;#x7684;&amp;#x5173;&amp;#x952E;&amp;#x7ED3;&amp;#x6784;&amp;#x5C31;&amp;#x662F;bkey&amp;#xFF0C;bkey&amp;#x5C31;&amp;#x662F;&amp;#x8BB0;&amp;#x5F55;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x548C;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x5173;&amp;#x7CFB;&amp;#x7684;&amp;#xFF0C;&amp;#x5176;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x4E0B;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; bkey {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;uint64_t&lt;/span&gt;	high;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;uint64_t&lt;/span&gt;	low;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;uint64_t&lt;/span&gt;	ptr[];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/bkey.png&quot; alt=&quot;bkey&quot;&gt;&lt;br&gt;&amp;#x5176;&amp;#x4E2D;&amp;#xFF1A;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;KEY_INODE:&amp;#x8868;&amp;#x793A;&amp;#x4E00;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;id&amp;#x7F16;&amp;#x53F7;&amp;#xFF08;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;cache set&amp;#x4E2D;&amp;#x4E00;&amp;#x822C;&amp;#x4EE5;bdev0&amp;#xFF0C;bdev1&amp;#x8FD9;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x51FA;&amp;#x73B0;&amp;#xFF09;&lt;/li&gt;
&lt;li&gt;KEY_SIZE&amp;#xFF1A;&amp;#x8868;&amp;#x793A;&amp;#x8BE5;bkey&amp;#x6240;&amp;#x5BF9;&amp;#x5E94;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&lt;/li&gt;
&lt;li&gt;KEY_DIRTY&amp;#xFF1A;&amp;#x8868;&amp;#x793A;&amp;#x8BE5;&amp;#x5757;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x662F;&amp;#x5426;&amp;#x662F;&amp;#x810F;&amp;#x6570;&amp;#x636E;&lt;/li&gt;
&lt;li&gt;KEY_PTRS&amp;#xFF1A;&amp;#x8868;&amp;#x793A;cache&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF08;&amp;#x591A;&amp;#x4E2A;ptr&amp;#x662F;&amp;#x7528;&amp;#x6765;&amp;#x652F;&amp;#x6301;&amp;#x591A;&amp;#x4E2A;cache&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#xFF0C;&amp;#x591A;&amp;#x4E2A;cache&amp;#x8BBE;&amp;#x5907;&amp;#x53EA;&amp;#x5BF9;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x548C;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#x505A;&amp;#x955C;&amp;#x50CF;&amp;#xFF09;&lt;/li&gt;
&lt;li&gt;KEY_OFFSET&amp;#xFF1A;bkey&amp;#x6240;&amp;#x7F13;&amp;#x5B58;&amp;#x7684;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x90A3;&amp;#x6BB5;&amp;#x6570;&amp;#x636E;&amp;#x533A;&amp;#x57DF;&amp;#x7684;&amp;#x7ED3;&amp;#x675F;&amp;#x5730;&amp;#x5740;&lt;/li&gt;
&lt;li&gt;PTR_DEV&amp;#xFF1A;cache&amp;#x8BBE;&amp;#x5907;&lt;/li&gt;
&lt;li&gt;PTR_OFFSET&amp;#xFF1A;&amp;#x5728;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x7F13;&amp;#x5B58;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x8D77;&amp;#x59CB;&amp;#x5730;&amp;#x5740;&lt;/li&gt;
&lt;li&gt;PTR_GEN&amp;#xFF1A;&amp;#x5BF9;&amp;#x5E94;cache&amp;#x7684;bucket&amp;#x7684;&amp;#x8FED;&amp;#x4EE3;&amp;#x6570;&amp;#xFF08;&amp;#x7248;&amp;#x672C;&amp;#xFF09;&lt;h2 id=&quot;3-3-bset&quot;&gt;&lt;a href=&quot;#3-3-bset&quot; class=&quot;headerlink&quot; title=&quot;3.3 bset&quot;&gt;&lt;/a&gt;3.3 bset&lt;/h2&gt;&amp;#x4E00;&amp;#x4E2A;bset&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;bkey&amp;#x7684;&amp;#x6570;&amp;#x7EC4;&amp;#xFF0C;&amp;#x5728;&amp;#x5185;&amp;#x5B58;&amp;#x4E2D;&amp;#x7684;bset&amp;#x662F;&amp;#x4E00;&amp;#x6BB5;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x4EE5;bkey&amp;#x6392;&amp;#x5E8F;&amp;#x7684;&amp;#xFF08;bkey&amp;#x4E4B;&amp;#x95F4;&amp;#x8FDB;&amp;#x884C;&amp;#x6BD4;&amp;#x8F83;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x662F;&amp;#x5148;&amp;#x6BD4;&amp;#x8F83;KEY_INODE&amp;#xFF0C;&amp;#x5982;&amp;#x679C;KEY_INODE&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x518D;&amp;#x6BD4;&amp;#x8F83;KEY_OFFSET&amp;#xFF09;&amp;#x3002;&lt;br&gt;bset&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#xFF08;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5185;&amp;#x5B58;&amp;#x4E2D;&amp;#x4E00;&amp;#x4E2A;btree node&amp;#x53EA;&amp;#x6709;4&amp;#x4E2A;bset&amp;#x3002;&lt;h1 id=&quot;4-bcache&amp;#x4E2D;&amp;#x7684;b-&amp;#x6811;&quot;&gt;&lt;a href=&quot;#4-bcache&amp;#x4E2D;&amp;#x7684;b-&amp;#x6811;&quot; class=&quot;headerlink&quot; title=&quot;4. bcache&amp;#x4E2D;&amp;#x7684;b+&amp;#x6811;&quot;&gt;&lt;/a&gt;4. bcache&amp;#x4E2D;&amp;#x7684;b+&amp;#x6811;&lt;/h1&gt;&lt;h2 id=&quot;4-1-btree&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;a href=&quot;#4-1-btree&amp;#x7ED3;&amp;#x6784;&quot; class=&quot;headerlink&quot; title=&quot;4.1 btree&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;/a&gt;4.1 btree&amp;#x7ED3;&amp;#x6784;&lt;/h2&gt;bcache&amp;#x4E2D;&amp;#x4EE5;b+tree&amp;#x6765;&amp;#x7EF4;&amp;#x62A4;&amp;#x7D22;&amp;#x5F15;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;btree node&amp;#x91CC;&amp;#x5305;&amp;#x542B;4&amp;#x4E2A;bset&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;bset&amp;#x4E2D;&amp;#x662F;&amp;#x6392;&amp;#x5E8F;&amp;#x7684;bkey&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/btree.png&quot; alt=&quot;btree&quot;&gt;&lt;br&gt;&amp;#x56FE;&amp;#x4E2D;&amp;#x505A;&amp;#x4E86;&amp;#x7B80;&amp;#x5316;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;btree node&amp;#x53EA;&amp;#x753B;&amp;#x4E86;&amp;#x4E24;&amp;#x4E2A;bset&amp;#x3002;&lt;br&gt;&amp;#x6BCF;&amp;#x4E2A;btree node&amp;#x4EE5;&amp;#x4E00;&amp;#x4E2A;bkey&amp;#x6765;&amp;#x6807;&amp;#x8BC6;&amp;#xFF0C;&amp;#x8BE5;bkey&amp;#x662F;&amp;#x5176;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x4E2D;&amp;#x6240;&amp;#x6709;bkey&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;&amp;#x4E0D;&amp;#x540C;&amp;#x4E8E;&amp;#x6807;&amp;#x51C6;&amp;#x7684;b+&amp;#x6811;&amp;#x90A3;&amp;#x6837;&amp;#xFF0C;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x5B58;&amp;#x653E;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x5730;&amp;#x5740;&amp;#x6307;&amp;#x9488;&amp;#xFF0C;bcache&amp;#x4E2D;&amp;#x7684;b+&amp;#x6811;&amp;#x4E2D;&amp;#x975E;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x4E2D;&amp;#x5B58;&amp;#x653E;&amp;#x7684;bkey&amp;#x7528;&amp;#x4E8E;&amp;#x67E5;&amp;#x627E;&amp;#x5176;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#xFF08;&amp;#x5E76;&amp;#x4E0D;&amp;#x662F;&amp;#x5B58;&amp;#x7684;&amp;#x5730;&amp;#x5740;&amp;#x6307;&amp;#x9488;&amp;#xFF09;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x6839;&amp;#x636E;bkey&amp;#x8BA1;&amp;#x7B97;hash&amp;#xFF0C;&amp;#x518D;&amp;#x5230;hash&amp;#x8868;&amp;#x4E2D;&amp;#x53D6;&amp;#x67E5;&amp;#x627E;btree node&amp;#x3002;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x4E2D;&amp;#x7684;bkey&amp;#x5B58;&amp;#x653E;&amp;#x7684;&amp;#x5C31;&amp;#x662F;&amp;#x5B9E;&amp;#x9645;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x4E86;&amp;#xFF08;&amp;#x6839;&amp;#x636E;&amp;#x8FD9;&amp;#x4E9B;key&amp;#x53EF;&amp;#x4EE5;&amp;#x627E;&amp;#x5230;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x4EE5;&amp;#x53CA;&amp;#x5728;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF09;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/hash.png&quot; alt=&quot;hash&quot;&gt;&lt;br&gt;bkey&amp;#x63D2;&amp;#x5165;&amp;#x5230;b+&amp;#x6811;&amp;#x4E2D;&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E0E;&amp;#x6807;&amp;#x51C6;&amp;#x7684;b+&amp;#x6811;&amp;#x7684;&amp;#x63D2;&amp;#x5165;&amp;#x8FC7;&amp;#x7A0B;&amp;#x7C7B;&amp;#x4F3C;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E0D;&amp;#x505A;&amp;#x7EC6;&amp;#x8BB2;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/insert-key.png&quot; alt=&quot;insert-key&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/insert-key2.png&quot; alt=&quot;insert-key2&quot;&gt;&lt;h2 id=&quot;4-2-btree&amp;#x63D2;&amp;#x5165;bkey&amp;#x65F6;overlapping&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;a href=&quot;#4-2-btree&amp;#x63D2;&amp;#x5165;bkey&amp;#x65F6;overlapping&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot; class=&quot;headerlink&quot; title=&quot;4.2 btree&amp;#x63D2;&amp;#x5165;bkey&amp;#x65F6;overlapping&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;/a&gt;4.2 btree&amp;#x63D2;&amp;#x5165;bkey&amp;#x65F6;overlapping&amp;#x7684;&amp;#x5904;&amp;#x7406;&lt;/h2&gt;&amp;#x6536;&amp;#x5230;&amp;#x65B0;&amp;#x7684;&amp;#x5199;io&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;io&amp;#x5BF9;&amp;#x5E94;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x53EF;&amp;#x80FD;&amp;#x6709;&amp;#x90E8;&amp;#x5206;&amp;#x5DF2;&amp;#x7ECF;&amp;#x7F13;&amp;#x5B58;&amp;#x5728;ssd&amp;#x4E0A;&amp;#x4E86;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x4E3A;&amp;#x8FD9;&amp;#x4E2A;io&amp;#x521B;&amp;#x5EFA;&amp;#x7684;bkey&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x5904;&amp;#x7406;&amp;#x8FD9;&amp;#x79CD;overlapping&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;br&gt;Btree node &amp;#x662F;log structured&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x7684;btree node&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x6709;overlap&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x662F;&amp;#x5728;&amp;#x4E0D;&amp;#x540C;&amp;#x65F6;&amp;#x5019;&amp;#x5199;&amp;#x5165;&amp;#x7684;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#x5185;&amp;#x5B58;&amp;#x4E2D;&amp;#x7684;btree node&amp;#x4E0D;&amp;#x4F1A;&amp;#x6709;overlap&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x63D2;&amp;#x5165;bkey&amp;#x65F6;&amp;#x5982;&amp;#x679C;&amp;#x548C;&amp;#x5185;&amp;#x5B58;&amp;#x4E2D;&amp;#x7684;bkey&amp;#x6709;overlap&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x89E3;&amp;#x51B3;overlap&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF1B;&amp;#x53E6;&amp;#x5916;&amp;#xFF0C;&amp;#x4ECE;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x8BFB;&amp;#x51FA;btree node&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x628A;bsets&amp;#x4E2D;&amp;#x7684;bkey&amp;#x505A;&amp;#x5F52;&amp;#x5E76;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x68C0;&amp;#x67E5;overlap&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x5E76;&amp;#x8FDB;&amp;#x884C;&amp;#x89E3;&amp;#x51B3;&amp;#x3002;&lt;br&gt;&amp;#x4E0B;&amp;#x56FE;&amp;#x7ED9;&amp;#x51FA;&amp;#x4E86;&amp;#x4E00;&amp;#x4E2A;&amp;#x793A;&amp;#x4F8B;&amp;#x60C5;&amp;#x51B5;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/overlap.png&quot; alt=&quot;overlap&quot;&gt;&lt;br&gt;&amp;#x51FA;&amp;#x73B0;&amp;#x8FD9;&amp;#x79CD;overlapping&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x539F;&amp;#x6765;&amp;#x7684;bkey&amp;#x4F1A;&amp;#x505A;&amp;#x4FEE;&amp;#x6539;&amp;#xFF08;ssd&amp;#x548C;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x504F;&amp;#x79FB;&amp;#x90FD;&amp;#x4F1A;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x8FD8;&amp;#x6709;&amp;#x6570;&amp;#x636E;&amp;#x5927;&amp;#x5C0F;&amp;#xFF09;&amp;#x3002;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#x63D2;&amp;#x5165;key&amp;#x6216;&amp;#x8005;&amp;#x67E5;&amp;#x627E;key&amp;#x65F6;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x5F85;&amp;#x5904;&amp;#x7406;&amp;#x7684;key&amp;#x7684;start&amp;#x6765;&amp;#x904D;&amp;#x5386;bset&amp;#x4E2D;&amp;#x7684;bkey&amp;#xFF08;bset&amp;#x4E2D;&amp;#x7684;bkey&amp;#x6392;&amp;#x5E8F;&amp;#x4E86;&amp;#xFF09;&amp;#xFF0C;&amp;#x627E;&amp;#x5230;&amp;#x53EF;&amp;#x80FD;&amp;#x5B58;&amp;#x5728;overlapping&amp;#x7684;&amp;#x7B2C;&amp;#x4E00;&amp;#x4E2A;key&amp;#xFF0C;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x63CF;&amp;#x8FF0;&amp;#x7684;&amp;#x4E24;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/overlap-key.png&quot; alt=&quot;overlap-key&quot;&gt;&lt;br&gt;&amp;#x8981;&amp;#x5904;&amp;#x7406;&amp;#x7684;overlapping&amp;#x60C5;&amp;#x51B5;&amp;#x6709;&amp;#x4EE5;&amp;#x4E0B;&amp;#x51E0;&amp;#x79CD;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/overlap-cond.png&quot; alt=&quot;overlap-cond&quot;&gt;&lt;br&gt;&amp;#x8BFB;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x4E5F;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x51FA;&amp;#x73B0;&amp;#x8FD9;&amp;#x79CD;&amp;#x90E8;&amp;#x5206;&amp;#x547D;&amp;#x4E2D;&amp;#xFF0C;&amp;#x90E8;&amp;#x5206;miss&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;&amp;#x672C;&amp;#x8D28;&amp;#x4E0A;&amp;#x548C;&amp;#x63D2;&amp;#x5165;key&amp;#x5904;&amp;#x7406;overlapping&amp;#x7684;&amp;#x4E00;&amp;#x6837;&amp;#xFF0C;&amp;#x53EA;&amp;#x4E0D;&amp;#x8FC7;&amp;#x547D;&amp;#x4E2D;&amp;#x7684;&amp;#x90E8;&amp;#x5206;&amp;#x4ECE;cache&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x8BFB;&amp;#xFF0C;miss&amp;#x7684;&amp;#x90E8;&amp;#x5206;&amp;#x662F;&amp;#x4ECE;hdd&amp;#x8BFB;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x4F1A;&amp;#x91CD;&amp;#x65B0;&amp;#x63D2;&amp;#x5165;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;key&amp;#x6765;&amp;#x7F13;&amp;#x5B58;&amp;#x8FD9;&amp;#x90E8;&amp;#x5206;miss&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;4-3-btree-node-split&quot;&gt;&lt;a href=&quot;#4-3-btree-node-split&quot; class=&quot;headerlink&quot; title=&quot;4.3 btree node split&quot;&gt;&lt;/a&gt;4.3 btree node split&lt;/h2&gt;&lt;p&gt;b+&amp;#x6811;&amp;#x8282;&amp;#x70B9;&amp;#x6709;&amp;#x6700;&amp;#x5927;&amp;#x5927;&amp;#x5C0F;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x5728;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;btree node&amp;#x65F6;&amp;#x5C31;&amp;#x5728;&amp;#x5185;&amp;#x5B58;&amp;#x4E2D;&amp;#x5206;&amp;#x914D;&amp;#x4E86;&amp;#x4E00;&amp;#x6BB5;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x6765;&amp;#x5B58;&amp;#x653E;bset&amp;#x53CA;bkey&amp;#xFF08;&amp;#x6309;&amp;#x7167;&amp;#x6307;&amp;#x5B9A;&amp;#x7684;&amp;#x5185;&amp;#x5B58;pages&amp;#x6570;&amp;#xFF09;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8D85;&amp;#x8FC7;&amp;#x8FD9;&amp;#x4E2A;pages&amp;#x6570;&amp;#xFF0C;btree node&amp;#x5C31;&amp;#x4F1A;&amp;#x5206;&amp;#x88C2;&amp;#x3002;&lt;br&gt;&amp;#x5728;&amp;#x8FDB;&amp;#x884C;key&amp;#x7684;&amp;#x63D2;&amp;#x5165;&amp;#x65F6;&amp;#xFF0C;&amp;#x9012;&amp;#x5F52;&amp;#x8FDB;&amp;#x884C;&amp;#x63D2;&amp;#x5165;&amp;#xFF0C;&amp;#x5230;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x5982;&amp;#x679C;&amp;#x9700;&amp;#x8981;&amp;#x5206;&amp;#x88C2;&amp;#xFF0C;&amp;#x5219;&amp;#x4F1A;&amp;#x4EE5;3/5&amp;#x8282;&amp;#x70B9;&amp;#x5927;&amp;#x5C0F;&amp;#x5206;&amp;#x88C2;&amp;#x6210;2&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x628A;&amp;#x5206;&amp;#x88C2;&amp;#x6210;&amp;#x7684;&amp;#x4E24;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x6700;&amp;#x5927;key&amp;#x901A;&amp;#x8FC7;op&amp;#x4F20;&amp;#x5230;&amp;#x4E0A;&amp;#x5C42;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x4E2D;&amp;#xFF0C;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x8FD9;&amp;#x5C42;&amp;#x51FD;&amp;#x6570;&amp;#x9000;&amp;#x51FA;&amp;#x540E;&amp;#xFF0C;&amp;#x5728;&amp;#x4E0A;&amp;#x4E00;&amp;#x5C42;&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x91CC;&amp;#x5C31;&amp;#x4F1A;&amp;#x628A;op&amp;#x4E2D;&amp;#x7684;key&amp;#x6DFB;&amp;#x52A0;&amp;#x5230;keys&amp;#x4E2D;&amp;#xFF08;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x4FEE;&amp;#x6539;&amp;#x4E86;&amp;#x7236;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x6307;&amp;#x9488;&amp;#xFF09;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8FD9;&amp;#x4E00;&amp;#x5C42;&amp;#x8FD8;&amp;#x9700;&amp;#x8981;&amp;#x5206;&amp;#x88C2;&amp;#xFF0C;&amp;#x8DDF;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x5206;&amp;#x88C2;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;&amp;#x5206;&amp;#x88C2;&amp;#x540E;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x90FD;&amp;#x4F1A;&amp;#x7ACB;&amp;#x5373;&amp;#x6301;&amp;#x4E45;&amp;#x5316;&amp;#x5230;ssd&amp;#x4E2D;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/btree-split.png&quot; alt=&quot;btree-split&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;5-writeback&quot;&gt;&lt;a href=&quot;#5-writeback&quot; class=&quot;headerlink&quot; title=&quot;5. writeback&quot;&gt;&lt;/a&gt;5. writeback&lt;/h1&gt;&lt;p&gt;bcache&amp;#x652F;&amp;#x6301;&amp;#x4E09;&amp;#x79CD;&amp;#x7F13;&amp;#x5B58;&amp;#x7B56;&amp;#x7565;&amp;#xFF1A;writeback&amp;#xFF0C;writethrough&amp;#xFF0C;writearoud&amp;#x3002;writethrough&amp;#x5C31;&amp;#x662F;&amp;#x65E2;&amp;#x5199;ssd&amp;#x4E5F;&amp;#x5199;hdd&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x8BFB;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5982;&amp;#x679C;&amp;#x547D;&amp;#x4E2D;&amp;#x7684;&amp;#x8BDD;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x4ECE;ssd&amp;#x4E2D;&amp;#x8BFB;&amp;#xFF0C;&amp;#x9002;&amp;#x5E94;&amp;#x4E8E;&amp;#x8BFB;&amp;#x591A;&amp;#x5199;&amp;#x5C11;&amp;#x7684;&amp;#x573A;&amp;#x666F;&amp;#xFF1B;writearoud&amp;#x5C31;&amp;#x662F;&amp;#x7ED5;&amp;#x8FC7;ssd&amp;#x76F4;&amp;#x63A5;&amp;#x8BFB;&amp;#x5199;hdd&amp;#xFF0C;&amp;#x4E2A;&amp;#x4EBA;&amp;#x611F;&amp;#x89C9;&amp;#x8FD9;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x6CA1;&amp;#x5565;&amp;#x610F;&amp;#x4E49;&amp;#xFF1B;writeback&amp;#x5C31;&amp;#x662F;ssd&amp;#x505A;&amp;#x5199;&amp;#x7F13;&amp;#x5B58;&amp;#xFF0C;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x5199;&amp;#x5165;&amp;#x90FD;&amp;#x662F;&amp;#x5148;&amp;#x5199;&amp;#x7F13;&amp;#x5B58;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4F1A;&amp;#x5728;&amp;#x540E;&amp;#x53F0;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E3B;&amp;#x8981;&amp;#x4ECB;&amp;#x7ECD;writeback&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0A;&amp;#x6587;&amp;#x63D0;&amp;#x5230;bucket&amp;#x5185;&amp;#x662F;&amp;#x4EE5;&amp;#x8FFD;&amp;#x52A0;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x6765;&amp;#x5206;&amp;#x914D;&amp;#x7A7A;&amp;#x95F4;&amp;#x7684;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;bucket&amp;#x91CC;&amp;#x9762;&amp;#x7F13;&amp;#x5B58;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x53EF;&amp;#x80FD;&amp;#x5BF9;&amp;#x5E94;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x4E0D;&amp;#x540C;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF0C;&amp;#x751A;&amp;#x81F3;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x5728;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;hdd&amp;#x3002;&amp;#x4E0D;&amp;#x540C;&amp;#x4E8E;flashcache&amp;#x4EE5;set&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#xFF08;&amp;#x7B49;&amp;#x540C;&amp;#x4E8E;bcache&amp;#x4E2D;&amp;#x7684;bucket&amp;#xFF09;&amp;#xFF0C;bcache&amp;#x4E2D;&amp;#x4EE5;bkey&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x6765;writeback&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x662F;&amp;#x4EE5;bucket&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x3002;&amp;#x6BCF;&amp;#x4E2A;cache set&amp;#x90FD;&amp;#x6709;&amp;#x4E00;&amp;#x4E2A;writeback_keys&amp;#xFF0C;&amp;#x8BB0;&amp;#x5F55;&amp;#x9700;&amp;#x8981;writeback&amp;#x7684;bkeys&amp;#x3002;&amp;#x5F53;&amp;#x6EE1;&amp;#x8DB3;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x6761;&amp;#x4EF6;&amp;#x65F6;&amp;#xFF08;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x6BD4;&amp;#x4F8B;&amp;#xFF09;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x904D;&amp;#x5386;&amp;#x6574;&amp;#x4E2A;b+&amp;#x6811;&amp;#xFF0C;&amp;#x67E5;&amp;#x627E;dirty&amp;#x7684;bkey&amp;#xFF0C;&amp;#x653E;&amp;#x5230;writeback_keys&amp;#x4E2D;&amp;#xFF08;writeback_keys&amp;#x6709;&amp;#x4E2A;&amp;#x5927;&amp;#x5C0F;&amp;#x9650;&amp;#x5236;&amp;#xFF09;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x6309;&amp;#x7167;&amp;#x78C1;&amp;#x76D8;&amp;#x504F;&amp;#x79FB;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x518D;&amp;#x8FDB;&amp;#x884C;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x52A8;&amp;#x4F5C;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x5199;&amp;#x5230;hdd&amp;#x540E;&amp;#xFF0C;&amp;#x4F1A;&amp;#x628A;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;bkey&amp;#x4ECE;writeback_keys&amp;#x79FB;&amp;#x9664;&amp;#xFF0C;&amp;#x5E76;&amp;#x53BB;&amp;#x6389;&amp;#x8BE5;bkey&amp;#x7684;dirty&amp;#x6807;&amp;#x8BB0;&amp;#x3002;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x597D;&amp;#x5904;&amp;#x5728;&amp;#x4E8E;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x53EF;&amp;#x4EE5;&amp;#x5C3D;&amp;#x91CF;&amp;#x8003;&amp;#x8651;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x8FDE;&amp;#x7EED;&amp;#x6027;&amp;#xFF0C;&amp;#x51CF;&amp;#x5C11;&amp;#x78C1;&amp;#x5934;&amp;#x7684;&amp;#x79FB;&amp;#x52A8;&amp;#xFF0C;&amp;#x800C;&amp;#x5982;&amp;#x679C;&amp;#x4EE5;bucket&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#x5237;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;bucket&amp;#x53EF;&amp;#x80FD;&amp;#x7F13;&amp;#x5B58;hdd&amp;#x4E0A;&amp;#x4E0D;&amp;#x540C;&amp;#x4F4D;&amp;#x7F6E;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x6BD4;&amp;#x8F83;&amp;#x968F;&amp;#x673A;&amp;#xFF0C;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x6548;&amp;#x7387;&amp;#x4E0D;&amp;#x9AD8;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65E2;&amp;#x7136;bucket&amp;#x5185;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x5206;&amp;#x914D;&amp;#x662F;&amp;#x6309;&amp;#x7167;&amp;#x8FFD;&amp;#x52A0;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x6BCF;&amp;#x6B21;&amp;#x90FD;&amp;#x662F;&amp;#x4ECE;&amp;#x540E;&amp;#x9762;&amp;#x5F00;&amp;#x53D1;&amp;#x5206;&amp;#x914D;&amp;#xFF0C;&amp;#x800C;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x53C8;&amp;#x4E0D;&amp;#x662F;&amp;#x4EE5;bucket&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;bucket&amp;#x4E2D;&amp;#x6709;&amp;#x7A7A;&amp;#x6D1E;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#xFF08;bucket&amp;#x4E2D;&amp;#x95F4;&amp;#x6709;&amp;#x4E9B;&amp;#x6570;&amp;#x636E;&amp;#x5DF2;&amp;#x7ECF;&amp;#x5237;&amp;#x5230;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x4E86;&amp;#xFF09;&amp;#xFF0C;&amp;#x5BFC;&amp;#x81F4;bucket&amp;#x5DF2;&amp;#x7528;&amp;#x7A7A;&amp;#x95F4;&amp;#x4E0D;&amp;#x591A;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5F88;&amp;#x591A;&amp;#x7A7A;&amp;#x95F2;&amp;#x7A7A;&amp;#x95F4;&amp;#x6BD4;&amp;#x8F83;&amp;#x5206;&amp;#x6563;&amp;#xFF0C;&amp;#x4ECE;&amp;#x540E;&amp;#x9762;&amp;#x5206;&amp;#x914D;&amp;#x53C8;&amp;#x7A7A;&amp;#x95F4;&amp;#x4E0D;&amp;#x8DB3;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;bcache&amp;#x4E2D;&amp;#x53C8;&amp;#x4E13;&amp;#x95E8;&amp;#x7684;&amp;#x5783;&amp;#x573E;&amp;#x56DE;&amp;#x6536;&amp;#x673A;&amp;#x5236;&amp;#xFF08;gc&amp;#xFF09;&amp;#xFF0C;&amp;#x4F1A;&amp;#x628A;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x7684;bucket&amp;#x7ED9;&amp;#x56DE;&amp;#x6536;&amp;#x6389;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x53EF;&amp;#x4EE5;&amp;#x91CD;&amp;#x65B0;&amp;#x4F7F;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;bucket&amp;#x3002;&lt;/p&gt;
&lt;p&gt;writeback&amp;#x65B9;&amp;#x5F0F;&amp;#x867D;&amp;#x7136;&amp;#x6027;&amp;#x80FD;&amp;#x6BD4;&amp;#x8F83;&amp;#x9AD8;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x610F;&amp;#x5916;&amp;#x5B95;&amp;#x673A;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x7684;&amp;#x6062;&amp;#x590D;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&amp;#x5BF9;&amp;#x4E8E;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#xFF0C;bcache&amp;#x80FD;&amp;#x591F;&amp;#x5F88;&amp;#x597D;&amp;#x5730;&amp;#x5904;&amp;#x7406;&amp;#x3002;&amp;#x5728;&amp;#x5F15;&amp;#x5165;journal&amp;#x4E4B;&amp;#x524D;&amp;#xFF08;&amp;#x540E;&amp;#x9762;&amp;#x4F1A;&amp;#x4ECB;&amp;#x7ECD;&amp;#xFF09;&amp;#xFF0C;&amp;#x5728;&amp;#x6570;&amp;#x636E;&amp;#x5199;&amp;#x5165;&amp;#x5230;&amp;#x7F13;&amp;#x5B58;ssd&amp;#x4E2D;&amp;#x540E;&amp;#xFF0C;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x8FD4;&amp;#x56DE;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x7B49;&amp;#x5230;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;btree node&amp;#x4E5F;&amp;#x6301;&amp;#x4E45;&amp;#x5316;&amp;#x540E;&amp;#xFF0C;&amp;#x518D;&amp;#x8FD4;&amp;#x56DE;&amp;#x5199;&amp;#x6210;&amp;#x529F;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x610F;&amp;#x5473;&amp;#x7740;&amp;#x6BCF;&amp;#x6B21;&amp;#x5199;io&amp;#x90FD;&amp;#x4F1A;&amp;#x5199;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x5B95;&amp;#x673A;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x5C31;&amp;#x80FD;&amp;#x591F;&amp;#x6839;&amp;#x636E;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#x6062;&amp;#x590D;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x5C31;&amp;#x5BFC;&amp;#x81F4;&amp;#x6BCF;&amp;#x6B21;&amp;#x90FD;&amp;#x8981;&amp;#x5199;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x800C;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#x7684;io&amp;#x90FD;&amp;#x6BD4;&amp;#x8F83;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;ssd&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5C0F;io&amp;#x6709;&amp;#x5199;&amp;#x653E;&amp;#x5927;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x5BFC;&amp;#x81F4;&amp;#x4E86;&amp;#x6548;&amp;#x7387;&amp;#x4F4E;&amp;#x4E0B;&amp;#x3002;&amp;#x5F15;&amp;#x5165;journal&amp;#x540E;&amp;#xFF0C;&amp;#x5C31;&amp;#x89E3;&amp;#x51B3;&amp;#x4E86;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6027;&amp;#x80FD;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;6-journal&quot;&gt;&lt;a href=&quot;#6-journal&quot; class=&quot;headerlink&quot; title=&quot;6. journal&quot;&gt;&lt;/a&gt;6. journal&lt;/h1&gt;&lt;p&gt;journal&amp;#x4E0D;&amp;#x662F;&amp;#x4E3A;&amp;#x4E86;&amp;#x4E00;&amp;#x81F4;&amp;#x6027;&amp;#x6062;&amp;#x590D;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x4E3A;&amp;#x4E86;&amp;#x63D0;&amp;#x9AD8;&amp;#x6027;&amp;#x80FD;&amp;#x3002;&amp;#x5728;writeback&amp;#x4E00;&amp;#x8282;&amp;#x63D0;&amp;#x5230;&amp;#x6CA1;&amp;#x6709;journal&amp;#x4E4B;&amp;#x524D;&amp;#x6BCF;&amp;#x6B21;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#x90FD;&amp;#x4F1A;&amp;#x66F4;&amp;#x65B0;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#xFF08;&amp;#x4E00;&amp;#x4E2A;bset&amp;#xFF09;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x51CF;&amp;#x5C11;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5F00;&amp;#x9500;&amp;#xFF0C;&amp;#x5F15;&amp;#x5165;journal&amp;#xFF0C;journal&amp;#x5C31;&amp;#x662F;&amp;#x63D2;&amp;#x5165;&amp;#x7684;keys&amp;#x7684;log&amp;#xFF0C;&amp;#x6309;&amp;#x7167;&amp;#x63D2;&amp;#x5165;&amp;#x65F6;&amp;#x95F4;&amp;#x6392;&amp;#x5E8F;&amp;#xFF0C;&amp;#x53EA;&amp;#x7528;&amp;#x8BB0;&amp;#x5F55;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;bkey&amp;#x7684;&amp;#x66F4;&amp;#x65B0;&amp;#xFF0C;&amp;#x975E;&amp;#x53F6;&amp;#x5B50;&amp;#x8282;&amp;#x70B9;&amp;#x5728;&amp;#x5206;&amp;#x88C2;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x5DF2;&amp;#x7ECF;&amp;#x6301;&amp;#x4E45;&amp;#x5316;&amp;#x4E86;&amp;#x3002;&amp;#x8FD9;&amp;#x6837;&amp;#x6BCF;&amp;#x6B21;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#x5728;&amp;#x6570;&amp;#x636E;&amp;#x5199;&amp;#x5165;&amp;#x540E;&amp;#x5C31;&amp;#x53EA;&amp;#x7528;&amp;#x8BB0;&amp;#x5F55;&amp;#x4E00;&amp;#x4E0B;log&amp;#xFF0C;&amp;#x5728;&amp;#x5D29;&amp;#x6E83;&amp;#x6062;&amp;#x590D;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x6839;&amp;#x636E;&amp;#x8FD9;&amp;#x4E2A;log&amp;#x91CD;&amp;#x65B0;&amp;#x63D2;&amp;#x5165;key&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;7-garbage-colletction&quot;&gt;&lt;a href=&quot;#7-garbage-colletction&quot; class=&quot;headerlink&quot; title=&quot;7. garbage colletction&quot;&gt;&lt;/a&gt;7. garbage colletction&lt;/h1&gt;&lt;p&gt;gc&amp;#x7684;&amp;#x76EE;&amp;#x7684;&amp;#x662F;&amp;#x4E3A;&amp;#x4E86;&amp;#x91CD;&amp;#x7528;buckets&amp;#x3002;&amp;#x521D;&amp;#x59CB;&amp;#x5316;cache&amp;#x65F6;&amp;#x4F1A;&amp;#x5728;bch_moving_init_cache_set&amp;#x4E2D;&amp;#x4F1A;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x4E00;&amp;#x4E2A;&amp;#x5224;&amp;#x65AD;bkey&amp;#x662F;&amp;#x5426;&amp;#x53EF;&amp;#x4EE5;gc&amp;#x7684;&amp;#x51FD;&amp;#x6570;moving_pred&amp;#xFF0C;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x5C31;&amp;#x662F;&amp;#x5224;&amp;#x65AD;&amp;#x8BE5;key&amp;#x6240;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;bucket&amp;#x7684;GC_SECTORS_USED&amp;#x662F;&amp;#x5426;&amp;#x5C0F;&amp;#x4E8E;cache-&amp;gt;gc_move_threshold&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x5219;&amp;#x53EF;&amp;#x4EE5;gc&amp;#xFF0C;&amp;#x5426;&amp;#x5219;&amp;#x4E0D;&amp;#x80FD;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;gc&amp;#x4E00;&amp;#x822C;&amp;#x662F;&amp;#x7531;invalidate buckets&amp;#x89E6;&amp;#x53D1;&amp;#x7684;&amp;#x3002;bcache&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;moving_gc_keys&amp;#xFF08;key buf&amp;#xFF0C;&amp;#x4EE5;&amp;#x7EA2;&amp;#x9ED1;&amp;#x6811;&amp;#x6765;&amp;#x7EF4;&amp;#x62A4;&amp;#xFF09;&amp;#x6765;&amp;#x5B58;&amp;#x653E;&amp;#x53EF;&amp;#x4EE5;gc&amp;#x7684;keys&amp;#xFF0C;gc&amp;#x65F6;&amp;#x4F1A;&amp;#x626B;&amp;#x63CF;&amp;#x6574;&amp;#x4E2A;btree&amp;#xFF0C;&amp;#x5224;&amp;#x65AD;&amp;#x54EA;&amp;#x4E9B;bkey&amp;#x662F;&amp;#x53EF;&amp;#x4EE5;gc&amp;#x7684;&amp;#xFF0C;&amp;#x628A;&amp;#x80FD;&amp;#x591F;gc&amp;#x7684;bkey&amp;#x52A0;&amp;#x5230;moving_gc_keys&amp;#x4E2D;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5C31;&amp;#x6839;&amp;#x636E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x53EF;&amp;#x4EE5;gc&amp;#x7684;key&amp;#x5148;&amp;#x4ECE;ssd&amp;#x4E2D;&amp;#x8BFB;&amp;#x51FA;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x540C;&amp;#x6837;&amp;#x6839;&amp;#x636E;key&amp;#x4E2D;&amp;#x8BB0;&amp;#x5F55;&amp;#x7684;hdd&amp;#x4E0A;&amp;#x7684;&amp;#x504F;&amp;#x79FB;&amp;#x5199;&amp;#x5230;hdd&amp;#x4E2D;&amp;#xFF0C;&amp;#x6210;&amp;#x529F;&amp;#x540E;&amp;#x628A;&amp;#x8BE5;key&amp;#x4ECE;moving_gc_keys&amp;#x4E2D;&amp;#x79FB;&amp;#x9664;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;8-&amp;#x603B;&amp;#x7ED3;&quot;&gt;&lt;a href=&quot;#8-&amp;#x603B;&amp;#x7ED3;&quot; class=&quot;headerlink&quot; title=&quot;8.&amp;#x603B;&amp;#x7ED3;&quot;&gt;&lt;/a&gt;8.&amp;#x603B;&amp;#x7ED3;&lt;/h1&gt;&lt;p&gt;bcache&amp;#x76F8;&amp;#x5BF9;&amp;#x4E8E;flashcache&amp;#x8981;&amp;#x590D;&amp;#x6742;&amp;#x5F88;&amp;#x591A;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;b+&amp;#x6811;&amp;#x6765;&amp;#x7EF4;&amp;#x62A4;&amp;#x7D22;&amp;#x5F15;&amp;#x5C31;&amp;#x53EF;&amp;#x89C1;&amp;#x4E00;&amp;#x6591;&amp;#x3002;&amp;#x867D;&amp;#x7136;bcache&amp;#x5DF2;&amp;#x7ECF;&amp;#x8FDB;&amp;#x5165;&amp;#x4E86;&amp;#x5185;&amp;#x6838;&amp;#x4E3B;&amp;#x7EBF;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x76EE;&amp;#x524D;&amp;#x4F7F;&amp;#x7528;bcache&amp;#x7684;&amp;#x4EBA;&amp;#x8FD8;&amp;#x662F;&amp;#x6BD4;&amp;#x8F83;&amp;#x5C11;&amp;#x7684;&amp;#xFF0C;&amp;#x79BB;&amp;#x5546;&amp;#x7528;&amp;#x8FD8;&amp;#x6709;&amp;#x4E00;&amp;#x6BB5;&amp;#x8DDD;&amp;#x79BB;&amp;#x3002;bcache&amp;#x8FD8;&amp;#x4E0D;&amp;#x592A;&amp;#x7A33;&amp;#x5B9A;&amp;#xFF0C;&amp;#x65F6;&amp;#x4E0D;&amp;#x65F6;&amp;#x6709;&amp;#x4E9B;bug&amp;#x51FA;&amp;#x73B0;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x5176;&amp;#x7A33;&amp;#x5B9A;&amp;#x6027;&amp;#x9700;&amp;#x8981;&amp;#x6BD4;&amp;#x8F83;&amp;#x957F;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x6765;&amp;#x68C0;&amp;#x6D4B;&amp;#x3002;&amp;#x800C;flashcache&amp;#x6765;&amp;#x8BF4;&amp;#x5C31;&amp;#x7A33;&amp;#x5B9A;&amp;#x5F88;&amp;#x591A;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x6709;facebook&amp;#x4F5C;&amp;#x4E3A;&amp;#x5176;&amp;#x6700;&amp;#x5927;&amp;#x7684;&amp;#x7EF4;&amp;#x62A4;&amp;#x8005;&amp;#xFF0C;&amp;#x56FD;&amp;#x5185;&amp;#x5916;&amp;#x8FD8;&amp;#x6709;&amp;#x5F88;&amp;#x591A;&amp;#x516C;&amp;#x53F8;&amp;#x4E5F;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;&amp;#xFF0C;&amp;#x6210;&amp;#x719F;&amp;#x5EA6;&amp;#x662F;&amp;#x516C;&amp;#x8BA4;&amp;#x7684;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;1.&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;bcache&amp;#x662F;linux&amp;#x5185;&amp;#x6838;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5C42;cache&amp;#xFF0C;&amp;#x7C7B;&amp;#x4F3C;&amp;#x4E8E;flashcache&amp;#x4F7F;&amp;#x7528;ssd&amp;#x4F5C;&amp;#x4E3A;hdd&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x65B9;&amp;#x6848;&amp;#xFF0C;&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;flashcache&amp;#xFF0C;bcache&amp;#x66F4;&amp;#x52A0;&amp;#x7075;&amp;#x6D3B;&amp;#xFF0C;&amp;#x652F;&amp;#x6301;ssd&amp;#x4F5C;&amp;#x4E3A;&amp;#x591A;&amp;#x5757;hdd&amp;#x7684;&amp;#x5171;&amp;#x4EAB;&amp;#x7F13;&amp;#x5B58;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8FD8;&amp;#x652F;&amp;#x6301;&amp;#x591A;&amp;#x5757;ssd&amp;#xFF08;&amp;#x8FD8;&amp;#x672A;&amp;#x5B8C;&amp;#x5584;&amp;#xFF09;&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x5728;&amp;#x8FD0;&amp;#x884C;&amp;#x4E2D;&amp;#x52A8;&amp;#x6001;&amp;#x589E;&amp;#x52A0;&amp;#xFF0C;&amp;#x5220;&amp;#x9664;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x4ECE;3.10&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;bcache&amp;#x8FDB;&amp;#x5165;&amp;#x5185;&amp;#x6838;&amp;#x4E3B;&amp;#x7EBF;&amp;#x3002;bcache&amp;#x652F;&amp;#x6301;writeback&amp;#x3001;writethrough&amp;#x3001;writearoud&amp;#x4E09;&amp;#x79CD;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;wriththrough&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x52A8;&amp;#x6001;&amp;#x4FEE;&amp;#x6539;&amp;#xFF0C;&amp;#x7F13;&amp;#x5B58;&amp;#x66FF;&amp;#x6362;&amp;#x65B9;&amp;#x5F0F;&amp;#x652F;&amp;#x6301;lru&amp;#x3001;fifo&amp;#x548C;random&amp;#x4E09;&amp;#x79CD;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x4ECE;&amp;#x51E0;&amp;#x4E2A;&amp;#x65B9;&amp;#x9762;&amp;#x4ECB;&amp;#x7ECD;bcache&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;a href=&quot;#2-&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&quot;&gt;&lt;/a&gt;2.&amp;#x603B;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&lt;/h1&gt;&lt;p&gt;bcache&amp;#x7684;&amp;#x6574;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/bcache-analysis/arch.png&quot; alt=&quot;arch&quot;&gt;&lt;br&gt;bcache&amp;#x4E2D;&amp;#x662F;&amp;#x4EE5;cache set&amp;#x6765;&amp;#x5212;&amp;#x5206;&amp;#x4E0D;&amp;#x540C;&amp;#x5B58;&amp;#x50A8;&amp;#x96C6;&amp;#x5408;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;cache set&amp;#x4E2D;&amp;#x5305;&amp;#x542B;&amp;#x4E00;&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;&amp;#x662F;ssd&amp;#xFF09;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x4E00;&amp;#x822C;&amp;#x662F;hdd&amp;#xFF09;&amp;#x3002;bcache&amp;#x5BF9;&amp;#x5916;&amp;#x8F93;&amp;#x51FA;&amp;#x7ED9;&amp;#x7528;&amp;#x6237;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;/dev/bcache&lt;N&gt;&amp;#x8FD9;&amp;#x79CD;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;bcache&lt;N&gt;&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E00;&amp;#x4E00;&amp;#x5BF9;&amp;#x5E94;&amp;#x3002;&amp;#x7528;&amp;#x6237;&amp;#x5BF9;&amp;#x4E0D;&amp;#x540C;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&amp;#x4F1A;&amp;#x7F13;&amp;#x5B58;&amp;#x5728;ssd&amp;#x4E2D;&amp;#xFF0C;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x4F1A;&amp;#x5199;&amp;#x5230;&amp;#x5404;&amp;#x81EA;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;bcache&amp;#x6269;&amp;#x5BB9;&amp;#x5F88;&amp;#x5BB9;&amp;#x6613;&amp;#xFF0C;&amp;#x53EA;&amp;#x8981;&amp;#x6CE8;&amp;#x518C;&amp;#x4E00;&amp;#x4E2A;&amp;#x65B0;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x5373;&amp;#x53EF;&amp;#x3002;&lt;br&gt;&lt;/N&gt;&lt;/N&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="bcache" scheme="http://yoursite.com/tags/bcache/"/>
    
  </entry>
  
  <entry>
    <title>bcache使用</title>
    <link href="http://yoursite.com/2016/05/12/bcache-use/"/>
    <id>http://yoursite.com/2016/05/12/bcache-use/</id>
    <published>2016-05-12T09:34:40.000Z</published>
    <updated>2016-05-12T09:41:55.810Z</updated>
    
    <content type="html">&lt;h1 id=&quot;1-&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot;&gt;&lt;/a&gt;1.&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# git clone http://evilpiepirate.org/git/bcache-tools.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x5B89;&amp;#x88C5;&amp;#x524D;&amp;#x9700;&amp;#x8981;&amp;#x4E24;&amp;#x4E2A;&amp;#x4F9D;&amp;#x8D56;&amp;#x5305;pkg-config&amp;#x548C;libblkid-dev&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# apt-get install pkg-config libblkid-dev&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x7F16;&amp;#x8BD1;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g `pkg-config --cflags uuid blkid` make-bcache.c bcache.o `pkg-config --libs uuid blkid` -o make-bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g `pkg-config --cflags uuid blkid` probe-bcache.c `pkg-config --libs uuid blkid` -o probe-bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g -std=gnu99 bcache-super-show.c bcache.o `pkg-config --libs uuid` -o bcache-super-show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0755 make-bcache bcache-super-show	/usr/sbin/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0755 probe-bcache bcache-register	 /lib/udev/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0644 69-bcache.rules	/lib/udev/rules.d/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -T -m0755 initramfs/hook	/usr/share/initramfs-tools/hooks/bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; /lib/dracut/modules.d ]; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; install -D -m0755 dracut/module-setup.sh /lib/dracut/modules.d/90bcache/module-setup.sh; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0644 -- *.8 /usr/share/man/man8/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;2-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;a href=&quot;#2-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;/a&gt;2.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&lt;/h1&gt;&lt;h2 id=&quot;2-1-&amp;#x521B;&amp;#x5EFA;bcache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#2-1-&amp;#x521B;&amp;#x5EFA;bcache&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;2.1 &amp;#x521B;&amp;#x5EFA;bcache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;2.1 &amp;#x521B;&amp;#x5EFA;bcache&amp;#x8BBE;&amp;#x5907;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;make-bcache -C &amp;lt;cache-device&amp;gt; -B &amp;lt;backing-device&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4EE5;vde&amp;#x4F5C;&amp;#x4E3A;&amp;#x7F13;&amp;#x5B58;&amp;#x76D8;&amp;#xFF0C;vdb&amp;#x548C;vdc&amp;#x4F5C;&amp;#x4E3A;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;bcache&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6709;&amp;#x51E0;&amp;#x4E2A;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x5C31;&amp;#x4F1A;&amp;#x751F;&amp;#x6210;&amp;#x51E0;&amp;#x4E2A;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make-bcache -C /dev/vde -B /dev/vdb /dev/vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UUID:	 8941a5d1-074e-4cc6&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;6dd-56cb1f65aed3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set UUID:	 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;version:	 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nbuckets:	 20480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bucket_size:	 1024&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nr_&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nr_this_dev:	 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;first_bucket:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UUID:	 9e28d09b-942d-487e-be22-9132063da572&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set UUID:	 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;version:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;data_offset:	 16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UUID:	 1bacf83e-2754-4d6a&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;964-09e53e6e679f&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set UUID:	 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;version:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;data_offset:	 16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root@nbsagent3:~&lt;span class=&quot;comment&quot;&gt;# ls /dev/b&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bcache0 bcache1 block/ btrfs-control bus/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;root@nbsagent3:~&lt;span class=&quot;comment&quot;&gt;# ls /dev/bcache* -la&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brw-rw---T 1 root disk 250, 0 5&amp;#x6708; 22 17:23 /dev/bcache0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brw-rw---T 1 root disk 250, 1 5&amp;#x6708; 22 17:23 /dev/bcache1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;lsblk&amp;#x67E5;&amp;#x770B;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5BF9;&amp;#x5E94;&amp;#x5173;&amp;#x7CFB;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-2-&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;backing-device&amp;#xFF09;&quot;&gt;&lt;a href=&quot;#2-2-&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;backing-device&amp;#xFF09;&quot; class=&quot;headerlink&quot; title=&quot;2.2 &amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;backing device&amp;#xFF09;&quot;&gt;&lt;/a&gt;2.2 &amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;backing device&amp;#xFF09;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;make-bcache -B &amp;lt;backing-device&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make-bcache -B /dev/vdh&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UUID:	 bd1bc116-6f39-401e&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;328-3bc0af4ac8d1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set UUID:	 &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt;86812e&lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt;24c-46da-b949-683969b59575&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;version:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;data_offset:	 16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x63A5;&amp;#x7740;&amp;#x770B;&amp;#x5230;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;/dev/bcache3&lt;br&gt;&amp;#x67E5;&amp;#x770B;cache set uuid&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ls -la /sys/fs/bcache/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 3 root root 0 May 22 17:23 .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 6 root root 0 May 22 17:21 ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 May 22 17:26 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 May 22 17:57 register&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 May 22 20:44 register_quiet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x201C;attach&amp;#x201D;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &amp;lt;cache &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; uuid&amp;gt; &amp;gt; /sys/block/bcache&amp;lt;N&amp;gt;/bcache/attach&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;attach&amp;#x4E4B;&amp;#x540E;&amp;#xFF0C;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x5C31;&amp;#x80FD;&amp;#x591F;&amp;#x5BF9;&amp;#x65B0;&amp;#x52A0;&amp;#x7684;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x4E86;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 7681dbb3-6558-4e60-b062-5fbb648f6665 &amp;gt; /sys/block/bcache3/bcache/attach&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6DFB;&amp;#x52A0;&amp;#x540E;&amp;#x4F7F;&amp;#x7528;lsblk&amp;#x67E5;&amp;#x770B;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdf 254:80 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdg 254:96 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdh 254:112 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-3-&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#2-3-&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;2.3 &amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;2.3 &amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&lt;/h2&gt;&lt;h3 id=&quot;1&amp;#xFF09;detach-backing-device&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;detach-backing-device&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;detach backing device&quot;&gt;&lt;/a&gt;1&amp;#xFF09;detach backing device&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &amp;lt;cache &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; uuid&amp;gt; &amp;gt; /sys/block/bcache&amp;lt;N&amp;gt;/bcache/detach&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;detach&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x540E;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;bcache&lt;n&gt;&amp;#x8BBE;&amp;#x5907;&amp;#x8FD8;&amp;#x662F;&amp;#x5B58;&amp;#x5728;&amp;#x7684;&amp;#xFF0C;&amp;#x53EA;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x4E2A;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x65E0;&amp;#x7F13;&amp;#x5B58;&amp;#x7684;&amp;#xFF0C;&amp;#x67E5;&amp;#x770B;&amp;#x5176;&amp;#x72B6;&amp;#x6001;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x662F;no cache&lt;br&gt;&amp;#x6BD4;&amp;#x5982;&amp;#x5220;&amp;#x9664;bcache3&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 7681dbb3-6558-4e60-b062-5fbb648f6665 &amp;gt; /sys/block/bcache3/bcache/detach&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/bcache3/bcache/state&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;no cache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdf 254:80 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdg 254:96 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdh 254:112 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/n&gt;&lt;/p&gt;
&lt;h3 id=&quot;2-stop-backing-device&quot;&gt;&lt;a href=&quot;#2-stop-backing-device&quot; class=&quot;headerlink&quot; title=&quot;2)stop backing device&quot;&gt;&lt;/a&gt;2)stop backing device&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; 1 &amp;gt; /sys/block/bcache&amp;lt;N&amp;gt;/bcache/stop&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;detach&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x540E;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x8FD8;&amp;#x5B58;&amp;#x5728;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8981;&amp;#x5220;&amp;#x9664;&amp;#xFF0C;&amp;#x8FD8;&amp;#x9700;&amp;#x8981;stop&amp;#x8BE5;&amp;#x8BBE;&amp;#x5907;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 1 &amp;gt; /sys/block/bcache3/bcache/stop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ls /dev/bcache* -la&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brw-rw---T 1 root disk 250, 0 May 22 17:51 /dev/bcache0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brw-rw---T 1 root disk 250, 1 May 22 17:54 /dev/bcache1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brw-rw---T 1 root disk 250, 2 May 22 20:42 /dev/bcache2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdf 254:80 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdg 254:96 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdh 254:112 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-4-&amp;#x65B0;&amp;#x589E;&amp;#x4E00;&amp;#x5757;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;caching-device&amp;#xFF09;&quot;&gt;&lt;a href=&quot;#2-4-&amp;#x65B0;&amp;#x589E;&amp;#x4E00;&amp;#x5757;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;caching-device&amp;#xFF09;&quot; class=&quot;headerlink&quot; title=&quot;2.4 &amp;#x65B0;&amp;#x589E;&amp;#x4E00;&amp;#x5757;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;caching device&amp;#xFF09;&quot;&gt;&lt;/a&gt;2.4 &amp;#x65B0;&amp;#x589E;&amp;#x4E00;&amp;#x5757;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;caching device&amp;#xFF09;&lt;/h2&gt;&lt;h3 id=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;cache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;cache&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;cache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;cache&amp;#x8BBE;&amp;#x5907;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;make-bcache -C &amp;lt;cache device&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x5DF2;&amp;#x7ECF;&amp;#x6709;&amp;#x4E00;&amp;#x4E9B;&amp;#x5143;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;wipefs&amp;#x6E05;&amp;#x7406;&amp;#x6389;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make-bcache -C /dev/vdf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Device /dev/vdf already has a non-bcache superblock, remove it using wipefs and wipefs &lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# wipefs -a /dev/vdf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4 bytes were erased at offset 0x27fff0000 (linux_raid_member)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;they were: &lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt; 4e 2b a9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make-bcache -C /dev/vdf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;UUID:	 1f8bc71f-0106-4da5-b781-5de7b1517706&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Set UUID:	 7bfb0d17-b6d0-4fe9-942b&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;1c75a0893ab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;version:	 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nbuckets:	 20480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bucket_size:	 1024&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nr_&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;_&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt;:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nr_this_dev:	 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;first_bucket:	 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdf 254:80 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdg 254:96 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdh 254:112 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nbsram_a 251:0 0 16M 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nbsram_b 251:16 0 16M 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nbsram_c 251:32 0 16M 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ls /sys/fs/bcache/ -la&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 4 root root 0 May 22 17:23 .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 6 root root 0 May 22 17:21 ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 May 22 17:26 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 May 22 21:05 7bfb0d17-b6d0-4fe9-942b&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;1c75a0893ab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 May 22 17:57 register&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 May 22 21:05 register_quiet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;2&amp;#xFF09;&amp;#x4E0E;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x5173;&amp;#x8054;&quot;&gt;&lt;a href=&quot;#2&amp;#xFF09;&amp;#x4E0E;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x5173;&amp;#x8054;&quot; class=&quot;headerlink&quot; title=&quot;2&amp;#xFF09;&amp;#x4E0E;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x5173;&amp;#x8054;&quot;&gt;&lt;/a&gt;2&amp;#xFF09;&amp;#x4E0E;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x5173;&amp;#x8054;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &amp;lt;cache &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; uuid&amp;gt; &amp;gt; /sys/block/bcache&amp;lt;N&amp;gt;/bcache/attach&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x9700;&amp;#x8981;&amp;#x4E0E;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x5173;&amp;#x8054;&amp;#x540E;&amp;#xFF0C;&amp;#x624D;&amp;#x80FD;&amp;#x4F5C;&amp;#x4E3A;&amp;#x5BF9;&amp;#x5E94;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x7F13;&amp;#x5B58;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 7bfb0d17-b6d0-4fe9-942b-a1c75a0893ab &amp;gt; /sys/block/bcache3/bcache/attach&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lsblk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vda 254:0 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;vda1 254:1 0 20G 0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdb 254:16 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdc 254:32 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdd 254:48 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vde 254:64 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache0 250:0 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;bcache1 250:1 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache2 250:2 0 50G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdf 254:80 0 10G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdg 254:96 0 20G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdh 254:112 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;bcache3 250:3 0 30G 0 disk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-5-&amp;#x5220;&amp;#x9664;cache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#2-5-&amp;#x5220;&amp;#x9664;cache&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;2.5 &amp;#x5220;&amp;#x9664;cache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;2.5 &amp;#x5220;&amp;#x9664;cache&amp;#x8BBE;&amp;#x5907;&lt;/h2&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x786E;&amp;#x4FDD;&amp;#x6CA1;&amp;#x6709;backing device&amp;#x5728;&amp;#x4F7F;&amp;#x7528;&amp;#x5B83;&amp;#xFF0C;&amp;#x4E0A;&amp;#x8FF0;&amp;#x7684;&amp;#x201C;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x201D;&amp;#x6709;&amp;#x8BF4;&amp;#x660E;&amp;#x5982;&amp;#x4F55;&amp;#x8BBE;&amp;#x7F6E;&amp;#x53D6;&amp;#x6D88;&amp;#x540E;&amp;#x7AEF;&amp;#x8BBE;&amp;#x5907;&amp;#x5BF9;&amp;#x7F13;&amp;#x5B58;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x3002;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;lsblk&amp;#x6765;&amp;#x67E5;&amp;#x770B;&amp;#x662F;&amp;#x5426;&amp;#x6709;&amp;#x76D8;&amp;#x5728;&amp;#x5F15;&amp;#x7528;&amp;#x5B83;&amp;#x3002;&lt;br&gt;&amp;#x5728;&amp;#x5728;/sys/fs/bcache&amp;#x76EE;&amp;#x5F55;&amp;#x4E0B;&amp;#x8FD8;&amp;#x6709;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;cache set uuid&amp;#xFF0C;unregister&amp;#x8BE5;set uuid&amp;#x540E;&amp;#x8FD9;&amp;#x4E2A;cache&amp;#x8BBE;&amp;#x5907;&amp;#x5C31;&amp;#x88AB;&amp;#x89C6;&amp;#x4E3A;&amp;#x5220;&amp;#x9664;&amp;#x4E86;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; 1 &amp;gt; /sys/fs/bcache/&amp;lt;cache &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; uuid&amp;gt;/unregister&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6BD4;&amp;#x5982;vde&amp;#x5DF2;&amp;#x7ECF;&amp;#x4E0D;&amp;#x4F5C;&amp;#x4E3A;&amp;#x4EFB;&amp;#x4F55;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x76D8;&amp;#x4E86;&amp;#xFF0C;&amp;#x5728;/sys/fs/bcache&amp;#x76EE;&amp;#x5F55;&amp;#x4E0B;&amp;#x6709;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;cache set uuid&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ls /sys/fs/bcache/ -la&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 4 root root 0 5&amp;#x6708; 26 09:07 .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 6 root root 0 5&amp;#x6708; 26 09:06 ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 5&amp;#x6708; 26 09:07 7681dbb3-6558-4e60-b062-5fbb648f6665&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 5&amp;#x6708; 26 09:07 7bfb0d17-b6d0-4fe9-942b&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;1c75a0893ab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 5&amp;#x6708; 26 09:07 register&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 5&amp;#x6708; 26 09:06 register_quiet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;unregister&amp;#x6389;&amp;#x8BE5;cache&amp;#x8BBE;&amp;#x5907;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#echo 1 &amp;gt; /sys/fs/bcache/[SSD bcache UUID]/unregister&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x770B;/sys/fs/bcache&amp;#x76EE;&amp;#x5F55;&amp;#x4E0B;&amp;#x5DF2;&amp;#x7ECF;&amp;#x6CA1;&amp;#x6709;&amp;#x8FD9;&amp;#x4E2A;cache&amp;#x8BBE;&amp;#x5907;&amp;#x7684;uuid&amp;#x4E86;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ls /sys/fs/bcache/ -la&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 3 root root 0 5&amp;#x6708; 26 09:07 .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 6 root root 0 5&amp;#x6708; 26 09:06 ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;drwxr-xr-x 7 root root 0 5&amp;#x6708; 26 09:07 7bfb0d17-b6d0-4fe9-942b&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;1c75a0893ab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 5&amp;#x6708; 26 09:07 register&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--w------- 1 root root 4096 5&amp;#x6708; 26 09:06 register_quiet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-6-&amp;#x53C2;&amp;#x6570;&amp;#x8C03;&amp;#x8282;&quot;&gt;&lt;a href=&quot;#2-6-&amp;#x53C2;&amp;#x6570;&amp;#x8C03;&amp;#x8282;&quot; class=&quot;headerlink&quot; title=&quot;2.6 &amp;#x53C2;&amp;#x6570;&amp;#x8C03;&amp;#x8282;&quot;&gt;&lt;/a&gt;2.6 &amp;#x53C2;&amp;#x6570;&amp;#x8C03;&amp;#x8282;&lt;/h2&gt;&lt;h3 id=&quot;1&amp;#xFF09;&amp;#x8BBE;&amp;#x7F6E;&amp;#x7F13;&amp;#x5B58;&amp;#x6A21;&amp;#x5F0F;&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;&amp;#x8BBE;&amp;#x7F6E;&amp;#x7F13;&amp;#x5B58;&amp;#x6A21;&amp;#x5F0F;&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;&amp;#x8BBE;&amp;#x7F6E;&amp;#x7F13;&amp;#x5B58;&amp;#x6A21;&amp;#x5F0F;&quot;&gt;&lt;/a&gt;1&amp;#xFF09;&amp;#x8BBE;&amp;#x7F6E;&amp;#x7F13;&amp;#x5B58;&amp;#x6A21;&amp;#x5F0F;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x547D;&amp;#x4EE4;&amp;#xFF1A;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &amp;lt;cache mode&amp;gt; &amp;gt; /sys/block/bcache&amp;lt;N&amp;gt;/bcache/cache_mode&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E3A;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x7B56;&amp;#x7565;&lt;br&gt;&amp;#x5E76;&amp;#x4E14;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E86;&amp;#x7F13;&amp;#x5B58;&amp;#x7B56;&amp;#x7565;&amp;#x540E;&amp;#xFF0C;&amp;#x673A;&amp;#x5668;&amp;#x91CD;&amp;#x542F;&amp;#x540E;&amp;#x4ECD;&amp;#x7136;&amp;#x751F;&amp;#x6548;&amp;#x3002;&lt;br&gt;&amp;#x53E6;&amp;#x5916;&amp;#xFF0C;&amp;#x673A;&amp;#x5668;&amp;#x91CD;&amp;#x542F;&amp;#x540E;&amp;#xFF0C;bcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E5F;&amp;#x80FD;&amp;#x81EA;&amp;#x52A8;&amp;#x91CD;&amp;#x5EFA;&amp;#x51FA;&amp;#x6765;&amp;#x3002;&lt;br&gt;bcache&amp;#x8FD8;&amp;#x6709;&amp;#x5176;&amp;#x4ED6;&amp;#x53EF;&amp;#x4EE5;&amp;#x8C03;&amp;#x8282;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E0D;&amp;#x4F5C;&amp;#x8BF4;&amp;#x660E;&amp;#xFF0C;&amp;#x5177;&amp;#x4F53;&amp;#x53C2;&amp;#x8003;&amp;#x5B98;&amp;#x65B9;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;a href=&quot;#3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;/a&gt;3.&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://bcache.evilpiepirate.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://bcache.evilpiepirate.org/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://lwn.net/Articles/550207/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://lwn.net/Articles/550207/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/liumangxiong/article/details/18090043&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/liumangxiong/article/details/18090043&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://unix.stackexchange.com/questions/115764/how-to-remove-cache-device-from-bcache&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://unix.stackexchange.com/questions/115764/how-to-remove-cache-device-from-bcache&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://pommi.nethuis.nl/ssd-caching-using-linux-and-bcache/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pommi.nethuis.nl/ssd-caching-using-linux-and-bcache/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&quot;&gt;&lt;/a&gt;1.&amp;#x7F16;&amp;#x8BD1;&amp;#x5B89;&amp;#x88C5;&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# git clone http://evilpiepirate.org/git/bcache-tools.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x5B89;&amp;#x88C5;&amp;#x524D;&amp;#x9700;&amp;#x8981;&amp;#x4E24;&amp;#x4E2A;&amp;#x4F9D;&amp;#x8D56;&amp;#x5305;pkg-config&amp;#x548C;libblkid-dev&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# apt-get install pkg-config libblkid-dev&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x7F16;&amp;#x8BD1;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g `pkg-config --cflags uuid blkid` make-bcache.c bcache.o `pkg-config --libs uuid blkid` -o make-bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g `pkg-config --cflags uuid blkid` probe-bcache.c `pkg-config --libs uuid blkid` -o probe-bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cc -O2 -Wall -g -std=gnu99 bcache-super-show.c bcache.o `pkg-config --libs uuid` -o bcache-super-show&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0755 make-bcache bcache-super-show	/usr/sbin/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0755 probe-bcache bcache-register	 /lib/udev/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0644 69-bcache.rules	/lib/udev/rules.d/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -T -m0755 initramfs/hook	/usr/share/initramfs-tools/hooks/bcache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; /lib/dracut/modules.d ]; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt; install -D -m0755 dracut/module-setup.sh /lib/dracut/modules.d/90bcache/module-setup.sh; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;install -m0644 -- *.8 /usr/share/man/man8/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="bcache" scheme="http://yoursite.com/tags/bcache/"/>
    
  </entry>
  
  <entry>
    <title>direct IO中io合并的奇怪现象分析</title>
    <link href="http://yoursite.com/2016/05/12/directio-merge/"/>
    <id>http://yoursite.com/2016/05/12/directio-merge/</id>
    <published>2016-05-12T09:07:13.000Z</published>
    <updated>2016-05-12T09:30:09.435Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;&amp;#x4E0A;&amp;#x4E00;&amp;#x7BC7;&amp;#x300A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5185;&amp;#x6838;&amp;#x53C2;&amp;#x6570;max_segments&amp;#x548C;max_sectors_kb&amp;#x89E3;&amp;#x6790;&amp;#x300B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;max_sectors_kb&amp;#x8FD9;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570;&amp;#x5BF9;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x5728;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x53E6;&amp;#x5916;&amp;#x4E00;&amp;#x4E2A;&amp;#x5947;&amp;#x602A;&amp;#x7684;&amp;#x73B0;&amp;#x8C61;&amp;#xFF1A;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x76D8;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8BBE;&amp;#x5907;&amp;#x4F7F;&amp;#x7528;direct IO&amp;#x8FDB;&amp;#x884C;&amp;#x968F;&amp;#x673A;&amp;#x5927;&amp;#x5757;&amp;#x5199;&amp;#x6216;&amp;#x8005;&amp;#x987A;&amp;#x5E8F;&amp;#x5927;&amp;#x5757;&amp;#x5199;&amp;#xFF08;&amp;#x968F;&amp;#x673A;&amp;#x8BFB;&amp;#x548C;&amp;#x987A;&amp;#x5E8F;&amp;#x8BFB;&amp;#x6CA1;&amp;#x8FD9;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF09;&amp;#xFF0C;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x8981;&amp;#x5927;&amp;#x4E8E;dm&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_sectors_kb&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5C0F;&amp;#x4E8E;dm&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x8FD9;&amp;#x91CC;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#xFF09;&amp;#x7684;max_sectors_kb&amp;#xFF0C;&amp;#x6D4B;&amp;#x8BD5;&amp;#x7ED3;&amp;#x679C;&amp;#x53D1;&amp;#x73B0;&amp;#x5728;3.2&amp;#x5185;&amp;#x6838;&amp;#x91CC;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E0A;&amp;#x7684;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5728;3.10&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E0A;&amp;#x7684;io&amp;#x786E;&amp;#x662F;&amp;#x5408;&amp;#x5E76;&amp;#x4E86;&amp;#xFF08;&amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x7684;io&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF09;&amp;#x3002;&amp;#x5177;&amp;#x4F53;&amp;#x73B0;&amp;#x8C61;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x4F8B;&amp;#x5B50;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#1-&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot;&gt;&lt;/a&gt;1.&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&lt;/h1&gt;&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x9009;&amp;#x53D6;3.2.57&amp;#x5185;&amp;#x6838;&amp;#x548C;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4F5C;&amp;#x4E3A;&amp;#x5BF9;&amp;#x6BD4;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;a href=&quot;#1-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot; class=&quot;headerlink&quot; title=&quot;1.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;/a&gt;1.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&lt;/h2&gt;&lt;p&gt;&amp;#x7269;&amp;#x7406;&amp;#x76D8;sdg&amp;#xFF0C;&amp;#x5728;&amp;#x5176;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;10G&amp;#x7684;device mapper&amp;#x8BBE;&amp;#x5907;dmtest1&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;dm-71&lt;br&gt;1&amp;#xFF09;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-71/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-71/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;fio&amp;#x6D4B;&amp;#x8BD5;&amp;#xFF0C;&amp;#x914D;&amp;#x7F6E;&amp;#x5982;&amp;#x4E0B;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[global]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rw=randwrite&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;direct=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;numjobs=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ioengine=sync&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bsrange=256k-256k&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rate_iops=10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;runtime=120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;group_reporting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[disk00]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;filename=/dev/dm-71&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;iostat&amp;#x67E5;&amp;#x770B;io&amp;#x72B6;&amp;#x6001;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat1.png&quot; alt=&quot;iostat1&quot;&gt;&lt;br&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;dm&amp;#x8BBE;&amp;#x5907;&amp;#x548C;sdg&amp;#x4E0A;&amp;#x7684;io&amp;#x5927;&amp;#x5C0F;&amp;#x90FD;&amp;#x662F;256KB&amp;#x3002;&lt;/p&gt;
&lt;p&gt;2&amp;#xFF09;&amp;#x4FEE;&amp;#x6539;dm&amp;#x8BBE;&amp;#x5907;max_sectors_kb&amp;#x53C2;&amp;#x6570;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 64 &amp;gt; /sys/block/dm-71/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x540C;&amp;#x6837;&amp;#x4F7F;&amp;#x7528;fio&amp;#x6D4B;&amp;#x8BD5;&amp;#xFF0C;iostat&amp;#x67E5;&amp;#x770B;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat2.png&quot; alt=&quot;iostat2&quot;&gt;&lt;br&gt;&amp;#x53EA;&amp;#x8C03;&amp;#x6574;&amp;#x4E86;dm&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_sectors_kb&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x8C03;&amp;#x6574;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#xFF08;&amp;#x8FD8;&amp;#x662F;512&amp;#xFF09;&amp;#xFF0C;&amp;#x671F;&amp;#x671B;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x662F;dm&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x5E73;&amp;#x5747;io&amp;#x5927;&amp;#x5C0F;&amp;#x662F;64kb&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x5E02;256kb&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x7ED3;&amp;#x679C;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x7684;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x5408;&amp;#x5E76;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-2-3-10-11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;a href=&quot;#1-2-3-10-11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot; class=&quot;headerlink&quot; title=&quot;1.2  3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;/a&gt;1.2  3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&lt;/h2&gt;&lt;p&gt;&amp;#x7269;&amp;#x7406;&amp;#x76D8;sdg&amp;#xFF0C;&amp;#x5728;&amp;#x5176;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;10G&amp;#x7684;device mapper&amp;#x8BBE;&amp;#x5907;dmtest1&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;dm-65&lt;br&gt;1&amp;#xFF09;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-65/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-65/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;fio&amp;#x6D4B;&amp;#x8BD5;&amp;#x662F;&amp;#x548C;&amp;#x4E0A;&amp;#x9762;&amp;#x914D;&amp;#x7F6E;&amp;#x4E00;&amp;#x6837;&amp;#xFF0C;&lt;br&gt;iostat&amp;#x67E5;&amp;#x770B;io&amp;#x60C5;&amp;#x51B5;&amp;#x5982;&amp;#x4E0B;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat3.png&quot; alt=&quot;iostat3&quot;&gt;&lt;/p&gt;
&lt;p&gt;2&amp;#xFF09;&amp;#x4FEE;&amp;#x6539;dm&amp;#x8BBE;&amp;#x5907;max_sectors_kb&amp;#x53C2;&amp;#x6570;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 64 &amp;gt; /sys/block/dm-65/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x540C;&amp;#x6837;&amp;#x7684;fio&amp;#x6D4B;&amp;#x8BD5;&amp;#xFF0C;iostat&amp;#x7ED3;&amp;#x679C;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat4.png&quot; alt=&quot;iostat4&quot;&gt;&lt;br&gt;&amp;#x7ED3;&amp;#x679C;dm&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;io&amp;#x53D8;&amp;#x6210;64KB&amp;#xFF0C;&amp;#x800C;&amp;#x6700;&amp;#x540E;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x786E;&amp;#x662F;&amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x7684;256KB&amp;#x3002;&amp;#x8DDF;&amp;#x671F;&amp;#x671B;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x4E00;&amp;#x81F4;&amp;#x3002;&lt;br&gt;&amp;#x90A3;&amp;#x4E48;&amp;#x5728;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5230;&amp;#x5E95;&amp;#x662F;&amp;#x4EC0;&amp;#x4E48;&amp;#x5730;&amp;#x65B9;&amp;#x5BFC;&amp;#x81F4;&amp;#x4E86;&amp;#x7ED3;&amp;#x679C;&amp;#x7684;&amp;#x4E0D;&amp;#x540C;&amp;#x5462;&amp;#xFF1F;&lt;/p&gt;
&lt;h1 id=&quot;2-&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;a href=&quot;#2-&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x5206;&amp;#x6790;&quot; class=&quot;headerlink&quot; title=&quot;2.&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;/a&gt;2.&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x5206;&amp;#x6790;&lt;/h1&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x7B80;&amp;#x5355;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E00;&amp;#x4E0B;direct io&amp;#x65F6;&amp;#x7684;io&amp;#x8C03;&amp;#x7528;&amp;#x8DEF;&amp;#x5F84;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4EE5;write&amp;#x4E3A;&amp;#x4F8B;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sys_write&amp;#x7CFB;&amp;#x7EDF;&amp;#x8C03;&amp;#x7528;  --&amp;gt;  vfs_write() --&amp;gt; do_sync_write() --&amp;gt; blkdev_aio_write() --&amp;gt; __generic_file_aio_write() --&amp;gt; generic_file_direct_write() --&amp;gt; blkdev_direct_IO() --&amp;gt; __blockdev_direct_IO()  --&amp;gt;  dio_bio_submit()  -&amp;gt;  submit_bio()  --&amp;gt; generic_make_request() --&amp;gt; &amp;#x4F1A;&amp;#x8C03;&amp;#x7528;q-&amp;gt;make_request_fn()  --&amp;gt; blk_queue_bio()&amp;#xFF0C;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x5316;scsi&amp;#x78C1;&amp;#x76D8;&amp;#x65F6;&amp;#x6CE8;&amp;#x518C;&amp;#x7684;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x5904;&amp;#x7406;io&amp;#x5408;&amp;#x5E76;&amp;#x7684;&amp;#xFF08;&amp;#x5305;&amp;#x542B;&amp;#x5404;&amp;#x4E2A;&amp;#x8C03;&amp;#x5EA6;&amp;#x7B97;&amp;#x6CD5;&amp;#x7684;&amp;#x8C03;&amp;#x7528;&amp;#xFF09;  --&amp;gt;  &amp;#x6700;&amp;#x540E;&amp;#x4F1A;&amp;#x89E6;&amp;#x53D1;&amp;#x8C03;&amp;#x7528;scsi_request_fn()&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x4E5F;&amp;#x662F;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x5316;scsi&amp;#x78C1;&amp;#x76D8;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x6CE8;&amp;#x518C;&amp;#x7684;&amp;#xFF0C;&amp;#x6709;&amp;#x591A;&amp;#x4E2A;&amp;#x5730;&amp;#x65B9;&amp;#x89E6;&amp;#x53D1;scsi_request_fn  --&amp;gt; scsi_dispatch_cmd&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x5728;&amp;#x5173;&amp;#x952E;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x5904;&amp;#x63A2;&amp;#x6D4B;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x65B9;&amp;#x4FBF;&amp;#x7EDF;&amp;#x8BA1;&amp;#xFF0C;fio&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;32KB&amp;#xFF0C;device mapper&amp;#x7684;max_sectors_kb&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;16&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;a href=&quot;#2-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot; class=&quot;headerlink&quot; title=&quot;2.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;/a&gt;2.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 16 &amp;gt; /sys/block/dm-71/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat5.png&quot; alt=&quot;iostat5&quot;&gt;&lt;br&gt;stap&amp;#x7ED3;&amp;#x679C;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x17ad000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221952, size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221952, size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221952, size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221952, size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221952, size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221952, size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221952, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221952, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] bi_sector:11221952, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] bi_sector:11221952, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[blk_queue_bio] bi_sector:179006400, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221984, size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221984, size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] bi_sector:11221984, size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221984, size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bi_sector:11221984, size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] bi_sector:11221984, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] bi_sector:11221984, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[blk_queue_bio] bi_sector:179006432, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__generic_file_aio_write] nr_segs:1, iov:{.iov_base=0x17ad000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x17ad000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x5728;&amp;#x8C03;&amp;#x7528;blk_queue_bio&amp;#x4E4B;&amp;#x540E;&amp;#x5C31;&amp;#x7ACB;&amp;#x5373;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;scsi_request_fn&lt;br&gt;&amp;#x628A;scsi_request_fn&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&amp;#x6253;&amp;#x5370;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x786E;&amp;#x5B9E;&amp;#x662F;&amp;#x7531;blk_queue_bio&amp;#x89E6;&amp;#x53D1;&amp;#x7684;scsi_request_fn&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0xffffffffa000798a : scsi_request_fn+0x35/0x51e [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff8119ac61 : blk_queue_bio+0x26f/0x28a [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff8119969e : generic_make_request+0x90/0xcf [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811997b0 : submit_bio+0xd3/0xf1 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811238a0 : dio_bio_submit+0x6e/0x8d [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811246f8 : __blockdev_direct_IO+0x8ee/0xa67 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff8112250e : blkdev_direct_IO+0x4e/0x53 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810b5ed8 : generic_file_direct_write+0xdc/0x14c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810b60dc : __generic_file_aio_write+0x194/0x278 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff81122825 : blkdev_aio_write+0x1f/0x61 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810fa560 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_sync_write+0xb4/0xec [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810fac51 : vfs_write+0xa2/0xe9 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810fae2e : sys_write+0x45/0x6b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff81354a12 : system_call_fastpath+0x16/0x1b [kernel]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x5BF9;&amp;#x6BD4;&amp;#xFF0C;&amp;#x4E0B;&amp;#x9762;&amp;#x770B;&amp;#x770B;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;stap&amp;#x7ED3;&amp;#x679C;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;===========================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa000798a : scsi_request_fn+0x35/0x51e [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81197599 : blk_run_queue+0x1d/0x2f [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa0006abd : scsi_run_queue+0x1c5/0x241 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa000850a : scsi_next_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;+0x2d/0x39 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00089a7 : scsi_io_completion+0x450/0x4ca [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8119dcd4 : blk_&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;_softirq+0x65/0x74 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8104c36e : __&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_softirq+0xb9/0x177 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81356c6c : call_softirq+0x1c/0x30 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8100fa21 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_softirq+0x3c/0x7b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8104c5d6 : irq_&lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt;+0x3c/0x99 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff813566de : call_&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;_single_interrupt+0x6e/0x80 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;===========================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa000798a : scsi_request_fn+0x35/0x51e [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81197599 : blk_run_queue+0x1d/0x2f [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa0006abd : scsi_run_queue+0x1c5/0x241 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa000850a : scsi_next_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;+0x2d/0x39 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00089a7 : scsi_io_completion+0x450/0x4ca [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8119dcd4 : blk_&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;_softirq+0x65/0x74 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8104c36e : __&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_softirq+0xb9/0x177 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81356c6c : call_softirq+0x1c/0x30 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8100fa21 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_softirq+0x3c/0x7b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8104c5d6 : irq_&lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt;+0x3c/0x99 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff813566de : call_&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;_single_interrupt+0x6e/0x80 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;===========================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa000798a : scsi_request_fn+0x35/0x51e [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811a58c6 : cfq_kick_queue+0x25/0x34 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8105b5cf : process_one_work+0x161/0x269 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8105c598 : worker_thread+0xc2/0x145 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8105f6d9 : kthread+0x76/0x7e [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81356b74 : kernel_thread_helper+0x4/0x10 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8105f663 : kthread+0x0/0x7e [kernel] (inexact)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81356b70 : kernel_thread_helper+0x0/0x10 [kernel] (inexact)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;===========================&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-2-3-10-11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;a href=&quot;#2-2-3-10-11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot; class=&quot;headerlink&quot; title=&quot;2.2  3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&quot;&gt;&lt;/a&gt;2.2  3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5206;&amp;#x6790;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 16 &amp;gt; /sys/block/dm-65/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/12/directio-merge/iostat6.png&quot; alt=&quot;iostat6&quot;&gt;&lt;br&gt;stap&amp;#x7ED3;&amp;#x679C;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x1753000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[blk_queue_bio] bi_sector:175962944, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[blk_queue_bio] bi_sector:175962976, size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x1753000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x7B2C;&amp;#x4E00;&amp;#x6B21;blk_queue_bio&amp;#x540E;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x521A;&amp;#x597D;16kb&amp;#x65F6;&amp;#xFF09;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x7ACB;&amp;#x5373;&amp;#x8C03;&amp;#x7528;scsi_request_fn&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x5728;&amp;#x7B2C;&amp;#x4E8C;&amp;#x6B21;&amp;#xFF08;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x7B2C;&amp;#x4E8C;&amp;#x4E2A;16kb&amp;#xFF0C;&amp;#x5408;&amp;#x5E76;&amp;#x8D77;&amp;#x6765;&amp;#x5C31;&amp;#x662F;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x7684;32kb&amp;#xFF09;blk_queue_bio&amp;#x4E4B;&amp;#x540E;&amp;#x518D;&amp;#x89E6;&amp;#x53D1;&amp;#x7684;scsi_request_fn&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x4E0B;&amp;#x9762;&amp;#x5217;&amp;#x51FA;scsi_request_fn&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x51FA;&amp;#x5E76;&amp;#x4E0D;&amp;#x662F;blk_queue_bio&amp;#x89E6;&amp;#x53D1;&amp;#x7684;scsi_request_fn&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00070b6 : scsi_request_fn+0x39/0x4f4 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b21c3 : __blk_run_queue_uncond+0x1e/0x26 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b229c : queue_unplugged+0x54/0x78 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b2de1 : blk_flush_plug_list+0x1b1/0x1c8 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81395748 : io_schedule+0x41/0x6c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8113bbb6 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_blockdev_direct_IO+0xa14/0xae8 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81138fac : blkdev_direct_IO+0x4e/0x53 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810c645e : generic_file_direct_write+0xe3/0x14a [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810c65e0 : __generic_file_aio_write+0x11b/0x1ff [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811394db : blkdev_aio_write+0x44/0x93 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811100bf : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_sync_write+0x55/0x7c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81110abc : vfs_write+0x9d/0x103 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81110dae : sys_write+0x51/0x80 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8139b529 : system_call_fastpath+0x16/0x1b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;==========================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00070b6 : scsi_request_fn+0x39/0x4f4 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b21c3 : __blk_run_queue_uncond+0x1e/0x26 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b260f : blk_run_queue+0x1d/0x2f [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa0006f08 : scsi_run_queue+0x1c3/0x249 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa0007e88 : scsi_next_&lt;span class=&quot;built_in&quot;&gt;command&lt;/span&gt;+0x2d/0x39 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00082f0 : scsi_io_completion+0x41b/0x48a [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b697d : blk_&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;_softirq+0x65/0x74 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8104262a : __&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_softirq+0xec/0x209 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81042812 : irq_&lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt;+0x3f/0x83 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8139c39d : call_&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;_single_interrupt+0x6d/0x80 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;==========================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[scsi_request_fn] id:6, lun:0, channel:0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa00070b6 : scsi_request_fn+0x39/0x4f4 [scsi_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811b21c3 : __blk_run_queue_uncond+0x1e/0x26 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811c4ffa : cfq_kick_queue+0x25/0x34 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81053638 : process_one_work+0x191/0x294 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81053aea : worker_thread+0x121/0x1e7 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81057fd9 : kthread+0x81/0x89 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8139b47c : ret_from_fork+0x7c/0xb0 [kernel]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;3-&amp;#x5206;&amp;#x6790;blk-queue-bio&amp;#x4EE3;&amp;#x7801;&quot;&gt;&lt;a href=&quot;#3-&amp;#x5206;&amp;#x6790;blk-queue-bio&amp;#x4EE3;&amp;#x7801;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x5206;&amp;#x6790;blk_queue_bio&amp;#x4EE3;&amp;#x7801;&quot;&gt;&lt;/a&gt;3.&amp;#x5206;&amp;#x6790;blk_queue_bio&amp;#x4EE3;&amp;#x7801;&lt;/h1&gt;&lt;p&gt;&amp;#x4ECE;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x5206;&amp;#x6790;&amp;#x770B;&amp;#x51FA;&amp;#x95EE;&amp;#x9898;&amp;#x51FA;&amp;#x5728;blk_queue_bio&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x4E0B;&amp;#x9762;&amp;#x5C31;&amp;#x770B;&amp;#x770B;&amp;#x5DEE;&amp;#x522B;&amp;#x5728;&amp;#x54EA;&amp;#x3002;&lt;br&gt;&lt;strong&gt;3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E2D;blk_queue_bio&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/blk_queue_bio_3.2.png&quot; alt=&quot;blk_queue_bio_3.2&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E2D;blk_queue_bio&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/blk_queue_bio_3.10.png&quot; alt=&quot;blk_queue_bio_3.10&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x8DDF;plug=current-&amp;gt;plug&amp;#x8FD9;&amp;#x4E2A;&amp;#x6709;&amp;#x5173;&amp;#xFF0C;plug&amp;#x662F;blk_plug&amp;#x7ED3;&amp;#x6784;&amp;#x3002;&lt;br&gt;blk_plug&amp;#x5141;&amp;#x8BB8;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x7F13;&amp;#x5B58;&amp;#x788E;&amp;#x7247;IO&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x961F;&amp;#x5217;&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x4FDD;&amp;#x6301;io&amp;#x788E;&amp;#x7247;&amp;#x4E00;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x80FD;&amp;#x5C06;&amp;#x987A;&amp;#x5E8F;&amp;#x8BF7;&amp;#x6C42;&amp;#x5408;&amp;#x5E76;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;&amp;#x5927;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002; &amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x8BF7;&amp;#x6C42;&amp;#x6279;&amp;#x91CF;&amp;#x4ECE;per-task&amp;#x94FE;&amp;#x8868;&amp;#x79FB;&amp;#x52A8;&amp;#x5230;&amp;#x8BBE;&amp;#x5907;&amp;#x8BF7;&amp;#x6C42;&amp;#x961F;&amp;#x5217;&amp;#xFF0C;&amp;#x51CF;&amp;#x5C11;&amp;#x4E86;&amp;#x8BBE;&amp;#x5907;&amp;#x8BF7;&amp;#x6C42;&amp;#x961F;&amp;#x5217;&amp;#x9501;&amp;#x7ADE;&amp;#x4E89;&amp;#xFF0C; &amp;#x4ECE;&amp;#x800C;&amp;#x63D0;&amp;#x9AD8;&amp;#x4E86;&amp;#x6548;&amp;#x7387;&amp;#x3002;&lt;br&gt;blk_plug&amp;#x7684;&amp;#x4F7F;&amp;#x7528;&amp;#x5F88;&amp;#x7B80;&amp;#x5355;&amp;#xFF1A;&lt;br&gt;a&amp;#xFF09;&amp;#x8BBE;&amp;#x7F6E;&amp;#x8BE5;&amp;#x7EBF;&amp;#x7A0B;&amp;#x5F00;&amp;#x542F;&amp;#x8BF7;&amp;#x6C42;&amp;#x5408;&amp;#x5E76;&amp;#x6A21;&amp;#x5F0F; blk_start_plug&lt;br&gt;b&amp;#xFF09;&amp;#x5173;&amp;#x95ED;&amp;#x7EBF;&amp;#x7A0B;&amp;#x8BF7;&amp;#x6C42;&amp;#x5408;&amp;#x5E76; blk_finish_plug&lt;br&gt;&amp;#x90A3;&amp;#x4E48;&amp;#x4E0A;&amp;#x9762;&amp;#x63CF;&amp;#x8FF0;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#x4F1A;&amp;#x4E0D;&amp;#x4F1A;&amp;#x4E0E;blk_start_plug()&amp;#x6709;&amp;#x5173;&amp;#x5462;&amp;#xFF1F;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&lt;/strong&gt;&amp;#x5728;generic_file_aio_write&amp;#x548C;generic_file_aio_read&amp;#x4E2D;&amp;#x90FD;&amp;#x6709;&amp;#x8C03;&amp;#x7528;blk_start_plug()&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/generic_file_aio_write.png&quot; alt=&quot;generic_file_aio_write&quot;&gt;&lt;br&gt;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x5728;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#x7684;io&amp;#x4E0D;&amp;#x662F;&amp;#x7531;generic_file_aio_write&amp;#x53BB;&amp;#x8C03;&amp;#x7528;__generic_file_aio_write&amp;#x7684;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x5728;blkdev_aio_write&amp;#x4E2D;&amp;#x8C03;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&lt;br&gt;&amp;#x8FD9;&amp;#x6761;io&amp;#x8DEF;&amp;#x5F84;&amp;#x7684;&amp;#x8C03;&amp;#x7528;&amp;#x51FD;&amp;#x6570;&amp;#x6808;&amp;#x5982;&amp;#x4E0B;&amp;#xFF0C;&amp;#x5728;&lt;strong&gt;&amp;#x8FD9;&amp;#x6761;&amp;#x8DEF;&amp;#x5F84;&amp;#x4E0A;&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x8C03;&amp;#x7528;blk_start_plug&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;blk_queue_bio&amp;#x4E2D;&amp;#x5C31;&amp;#x6CA1;&amp;#x6709;&amp;#x8FDB;&amp;#x5165;if (plug)&amp;#x7684;&amp;#x6761;&amp;#x4EF6;&amp;#x8BED;&amp;#x53E5;&amp;#x4E2D;&lt;/strong&gt;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811993d2 : generic_make_request+0x90/0xcf [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811994e4 : submit_bio+0xd3/0xf1 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811236a4 : dio_bio_submit+0x6e/0x8d [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8112399d : dio_send_cur_page+0x79/0xa4 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81123a6b : submit_page_section+0xa3/0xf8 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8112435f : __blockdev_direct_IO+0x751/0xa67 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81122312 : blkdev_direct_IO+0x4e/0x53 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810b5e1c : generic_file_direct_write+0xdc/0x14c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810b6020 : __generic_file_aio_write+0x194/0x278 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81122629 : blkdev_aio_write+0x1f/0x61 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810fa378 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_sync_write+0xb4/0xec [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810faa69 : vfs_write+0xa2/0xe9 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810fac46 : sys_write+0x45/0x6b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81354d92 : system_call_fastpath+0x16/0x1b [kernel]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x800C;&lt;strong&gt;3.10.11&amp;#x5185;&amp;#x6838;&lt;/strong&gt;&amp;#x4E2D;&amp;#x5728;generic_file_aio_write&amp;#x548C;generic_file_aio_read&amp;#x4E2D;&amp;#x90FD;&amp;#x6CA1;&amp;#x6709;&amp;#x8C03;&amp;#x7528;&amp;#x8FD9;&amp;#x4E2A;start plug&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x4E86;&amp;#xFF0C;&lt;br&gt;&amp;#x800C;&amp;#x662F;&amp;#x5728;do_blockdev_direct_IO&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x8C03;&amp;#x7528;&amp;#x7684;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/12/directio-merge/do_blockdev_direct_IO.png&quot; alt=&quot;do_blockdev_direct_IO&quot;&gt;&lt;br&gt;&amp;#x6253;&amp;#x5370;blk_start_plug&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x6808;&amp;#xFF0C;&amp;#x53EF;&amp;#x89C1;&amp;#x786E;&amp;#x5B9E;&amp;#x662F;&amp;#x5728;do_blockdev_direct_IO&amp;#x4E2D;&amp;#x8C03;&amp;#x7528;&amp;#x7684;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811ae2a6 : blk_start_plug+0x1d/0x3b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff8113b4e2 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_blockdev_direct_IO+0x340/0xae8 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff81138fac : blkdev_direct_IO+0x4e/0x53 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810c645e : generic_file_direct_write+0xe3/0x14a [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff810c65e0 : __generic_file_aio_write+0x11b/0x1ff [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811394db : blkdev_aio_write+0x44/0x93 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff811100bf : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_sync_write+0x55/0x7c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff81110abc : vfs_write+0x9d/0x103 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff81110dae : sys_write+0x51/0x80 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0xffffffff8139b529 : system_call_fastpath+0x16/0x1b [kernel]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;4-&amp;#x5185;&amp;#x6838;patch&amp;#x53D8;&amp;#x66F4;&quot;&gt;&lt;a href=&quot;#4-&amp;#x5185;&amp;#x6838;patch&amp;#x53D8;&amp;#x66F4;&quot; class=&quot;headerlink&quot; title=&quot;4.&amp;#x5185;&amp;#x6838;patch&amp;#x53D8;&amp;#x66F4;&quot;&gt;&lt;/a&gt;4.&amp;#x5185;&amp;#x6838;patch&amp;#x53D8;&amp;#x66F4;&lt;/h1&gt;&lt;p&gt;&amp;#x540E;&amp;#x6765;google&amp;#x4E86;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF0C;&amp;#x4ECE;3.6-rc3&amp;#x7248;&amp;#x672C;&amp;#x5C31;&amp;#x4FEE;&amp;#x590D;&amp;#x4E86;&amp;#x8FD9;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x628A;blk_start_plug&amp;#x4ECE;generic_file_aio_write&amp;#x548C;generic_file_aio_read&amp;#x4E2D;&amp;#x79FB;&amp;#x5230;&amp;#x4E86;do_blockdev_direct_IO&amp;#x3002;&lt;br&gt;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;patch&amp;#x201C;block: remove plugging at buffered write time&amp;#x201D; &lt;a href=&quot;http://www.kernelhub.org/?p=2&amp;amp;msg=16336&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.kernelhub.org/?p=2&amp;amp;msg=16336&lt;/a&gt;&lt;br&gt;&amp;#x5173;&amp;#x4E8E;&amp;#x8FD9;&amp;#x4E2A;patch&amp;#x7684;&amp;#x8BA8;&amp;#x8BBA;&amp;#x53C2;&amp;#x89C1; &lt;a href=&quot;http://www.linuxhorizon.com/9-linux/aae0da2b1c65f3ef.htm#.U3ofDvmSzNd&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.linuxhorizon.com/9-linux/aae0da2b1c65f3ef.htm#.U3ofDvmSzNd&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;5-&amp;#x7ED3;&amp;#x8BBA;&quot;&gt;&lt;a href=&quot;#5-&amp;#x7ED3;&amp;#x8BBA;&quot; class=&quot;headerlink&quot; title=&quot;5.&amp;#x7ED3;&amp;#x8BBA;&quot;&gt;&lt;/a&gt;5.&amp;#x7ED3;&amp;#x8BBA;&lt;/h1&gt;&lt;p&gt;&amp;#x4ECE;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x5206;&amp;#x6790;&amp;#x5F97;&amp;#x51FA;&amp;#xFF0C;blk_plug&amp;#x5BF9;io&amp;#x7684;&amp;#x5408;&amp;#x5E76;&amp;#x4F1A;&amp;#x6709;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;device mapper&amp;#x6216;&amp;#x8005;&amp;#x8F6F;raid&amp;#x65F6;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5185;&amp;#x6838;&amp;#x4F4E;&amp;#x4E8E;3.6&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x51FA;&amp;#x73B0;&amp;#x4E0A;&amp;#x9762;&amp;#x63CF;&amp;#x8FF0;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF1A;&amp;#x4E0A;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_sectors_kb&amp;#x5F71;&amp;#x54CD;&amp;#x4E86;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&amp;#x5408;&amp;#x5E76;&amp;#x3002;&amp;#x6240;&amp;#x4EE5;&amp;#x5EFA;&amp;#x8BAE;&amp;#x5728;&amp;#x6761;&amp;#x4EF6;&amp;#x5141;&amp;#x8BB8;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x6362;&amp;#x6210;&amp;#x76F8;&amp;#x5BF9;&amp;#x8F83;&amp;#x65B0;&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#x4F7F;&amp;#x7528;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;&amp;#x4E0A;&amp;#x4E00;&amp;#x7BC7;&amp;#x300A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5185;&amp;#x6838;&amp;#x53C2;&amp;#x6570;max_segments&amp;#x548C;max_sectors_kb&amp;#x89E3;&amp;#x6790;&amp;#x300B;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;max_sectors_kb&amp;#x8FD9;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570;&amp;#x5BF9;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x5728;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#xFF0C;&amp;#x53D1;&amp;#x73B0;&amp;#x53E6;&amp;#x5916;&amp;#x4E00;&amp;#x4E2A;&amp;#x5947;&amp;#x602A;&amp;#x7684;&amp;#x73B0;&amp;#x8C61;&amp;#xFF1A;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x4E2A;&amp;#x76D8;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8BBE;&amp;#x5907;&amp;#x4F7F;&amp;#x7528;direct IO&amp;#x8FDB;&amp;#x884C;&amp;#x968F;&amp;#x673A;&amp;#x5927;&amp;#x5757;&amp;#x5199;&amp;#x6216;&amp;#x8005;&amp;#x987A;&amp;#x5E8F;&amp;#x5927;&amp;#x5757;&amp;#x5199;&amp;#xFF08;&amp;#x968F;&amp;#x673A;&amp;#x8BFB;&amp;#x548C;&amp;#x987A;&amp;#x5E8F;&amp;#x8BFB;&amp;#x6CA1;&amp;#x8FD9;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF09;&amp;#xFF0C;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x8981;&amp;#x5927;&amp;#x4E8E;dm&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_sectors_kb&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5C0F;&amp;#x4E8E;dm&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x8FD9;&amp;#x91CC;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#xFF09;&amp;#x7684;max_sectors_kb&amp;#xFF0C;&amp;#x6D4B;&amp;#x8BD5;&amp;#x7ED3;&amp;#x679C;&amp;#x53D1;&amp;#x73B0;&amp;#x5728;3.2&amp;#x5185;&amp;#x6838;&amp;#x91CC;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E0A;&amp;#x7684;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x5728;3.10&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x843D;&amp;#x5230;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x4E0A;&amp;#x7684;io&amp;#x786E;&amp;#x662F;&amp;#x5408;&amp;#x5E76;&amp;#x4E86;&amp;#xFF08;&amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;&amp;#x7528;&amp;#x6237;&amp;#x53D1;&amp;#x7684;io&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF09;&amp;#x3002;&amp;#x5177;&amp;#x4F53;&amp;#x73B0;&amp;#x8C61;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x4F8B;&amp;#x5B50;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#1-&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&quot;&gt;&lt;/a&gt;1.&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x8868;&amp;#x73B0;&lt;/h1&gt;&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x9009;&amp;#x53D6;3.2.57&amp;#x5185;&amp;#x6838;&amp;#x548C;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4F5C;&amp;#x4E3A;&amp;#x5BF9;&amp;#x6BD4;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;a href=&quot;#1-1-3-2-57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot; class=&quot;headerlink&quot; title=&quot;1.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&quot;&gt;&lt;/a&gt;1.1  3.2.57&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x6D4B;&amp;#x8BD5;&lt;/h2&gt;&lt;p&gt;&amp;#x7269;&amp;#x7406;&amp;#x76D8;sdg&amp;#xFF0C;&amp;#x5728;&amp;#x5176;&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;10G&amp;#x7684;device mapper&amp;#x8BBE;&amp;#x5907;dmtest1&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x4E3A;dm-71&lt;br&gt;1&amp;#xFF09;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/sdg/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-71/queue/max_sectors_kb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;512&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/dm-71/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="kernel" scheme="http://yoursite.com/tags/kernel/"/>
    
      <category term="directio" scheme="http://yoursite.com/tags/directio/"/>
    
  </entry>
  
  <entry>
    <title>块设备内核参数max_segments和max_sectors_kb解析</title>
    <link href="http://yoursite.com/2016/05/12/max-seg-max-sec/"/>
    <id>http://yoursite.com/2016/05/12/max-seg-max-sec/</id>
    <published>2016-05-12T08:47:03.000Z</published>
    <updated>2016-05-12T09:04:04.807Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5728;DMA&amp;#x8BBE;&amp;#x5907;&amp;#x4E0D;&amp;#x91C7;&amp;#x7528;S/G&amp;#xFF08;&amp;#x5206;&amp;#x6563;/&amp;#x805A;&amp;#x96C6;&amp;#xFF09;&amp;#x6A21;&amp;#x5F0F;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x4FDD;&amp;#x8BC1;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x4E0A;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;linux&amp;#x5185;&amp;#x6838;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x7528;&amp;#x6765;&amp;#x5206;&amp;#x914D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#xFF1A;kmalloc()&amp;#x548C;&lt;strong&gt;get_free_pages()&amp;#x3002;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x90FD;&amp;#x6709;&amp;#x5206;&amp;#x914D;&amp;#x8FDE;&amp;#x7EED;&amp;#x5185;&amp;#x5B58;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;kmalloc&amp;#x4EE5;&amp;#x5206;&amp;#x914D;&amp;#x5B57;&amp;#x8282;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x7EA6;&amp;#x4E3A;64KB&amp;#xFF0C;&lt;/strong&gt;get_free_pages()&amp;#x4EE5;&amp;#x5206;&amp;#x914D;&amp;#x9875;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x80FD;&amp;#x5206;&amp;#x914D;2^order&amp;#x6570;&amp;#x76EE;&amp;#x7684;&amp;#x9875;&lt;/p&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;DMA&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x7684;&amp;#x4E3B;&amp;#x8981;&amp;#x95EE;&amp;#x9898;&amp;#x662F;&amp;#xFF1A;&amp;#x5F53;&amp;#x5927;&amp;#x4E8E;&amp;#x4E00;&amp;#x9875;&amp;#x65F6;&amp;#xFF0C;&amp;#x5B83;&amp;#x4EEC;&amp;#x5FC5;&amp;#x987B;&amp;#x5360;&amp;#x636E;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x9875;&amp;#xFF0C;&amp;#x8FD9;&amp;#x662F;&amp;#x56E0;&amp;#x4E3A;&amp;#x8BBE;&amp;#x5907;&amp;#x4F7F;&amp;#x7528;ISA&amp;#x6216;&amp;#x8005;PCI&amp;#x7CFB;&amp;#x7EDF;&amp;#x603B;&amp;#x7EBF;&amp;#x4F20;&amp;#x8F93;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x800C;&amp;#x8FD9;&amp;#x4E24;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x90FD;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x5730;&amp;#x5740;&lt;/p&gt;
&lt;p&gt;linux&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;&amp;#x5904;&amp;#x7406;io&amp;#x65F6;&amp;#x4F1A;&amp;#x53D7;&amp;#x5230;&amp;#x4E00;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#xFF08;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;queue limits&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7B80;&amp;#x79F0;limits&amp;#x53C2;&amp;#x6570;&amp;#xFF09;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x5141;&amp;#x8BB8;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;segment&amp;#x6570;&amp;#x7B49;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;/sys/block/&lt;device&gt;/queue/&amp;#x4E0B;&amp;#x67E5;&amp;#x770B;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x65F6;&amp;#x4F1A;&amp;#x8BBE;&amp;#x7F6E;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x3002;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E3B;&amp;#x8981;&amp;#x5206;&amp;#x6790;max_segments&amp;#x548C;max_sectors_kb&amp;#x3002;&lt;/device&gt;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&lt;/h1&gt;&lt;h2 id=&quot;1-1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&lt;/h2&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x4E86;&amp;#x89E3;&amp;#x4E00;&amp;#x4E0B;&amp;#x4EC0;&amp;#x4E48;&amp;#x662F;&amp;#x6BB5;&amp;#xFF08;segment&amp;#xFF09;&amp;#x3002;&lt;br&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x6BB5;&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x6216;&amp;#x8005;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x7684;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x5B83;&amp;#x4EEC;&amp;#x5305;&amp;#x542B;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x7269;&amp;#x7406;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x3002;&lt;br&gt;&amp;#x78C1;&amp;#x76D8;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;io&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;RAM&amp;#x5355;&amp;#x5143;&amp;#x4E4B;&amp;#x95F4;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x9001;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x5185;&amp;#x5BB9;&amp;#x3002;&amp;#x5927;&amp;#x591A;&amp;#x6570;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x91C7;&amp;#x7528;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x53EA;&amp;#x8981;&amp;#x5411;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x53D1;&amp;#x9001;&amp;#x9002;&amp;#x5F53;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x89E6;&amp;#x53D1;&amp;#x4E00;&amp;#x6B21;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#xFF0C;&amp;#x4E00;&amp;#x65E6;&amp;#x5B8C;&amp;#x6210;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E2D;&amp;#x65AD;&amp;#x901A;&amp;#x77E5;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x3002;&lt;br&gt;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x662F;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x867D;&amp;#x7136;&amp;#x4E5F;&amp;#x5141;&amp;#x8BB8;&amp;#x4F20;&amp;#x9001;&amp;#x4E0D;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6BD4;&amp;#x8F83;&amp;#x4F4E;&amp;#x6548;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x78C1;&amp;#x5934;&amp;#x79FB;&amp;#x52A8;&amp;#x6162;&amp;#x3002;&lt;br&gt;&amp;#x8001;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x4EC5;&amp;#x4EC5;&amp;#x652F;&amp;#x6301;&amp;#x201C;&amp;#x7B80;&amp;#x5355;&amp;#x201D;&amp;#x7684;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF1A;&amp;#x78C1;&amp;#x76D8;&amp;#x5FC5;&amp;#x987B;&amp;#x4E0E;RAM&amp;#x4E2D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x5355;&amp;#x5143;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#x65B0;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x652F;&amp;#x6301;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;&amp;#xFF08;scatter-gather&amp;#xFF09;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;&amp;#x975E;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#x3002;&lt;br&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x652F;&amp;#x6301;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5FC5;&amp;#x987B;&amp;#x80FD;&amp;#x591F;&amp;#x5904;&amp;#x7406;&amp;#x79F0;&amp;#x4E3A;&amp;#x6BB5;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5B58;&amp;#x50A8;&amp;#x5355;&amp;#x5143;&amp;#xFF0C;&amp;#x4E00;&amp;#x6B21;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;DMA&amp;#x53EF;&amp;#x4EE5;&amp;#x4F20;&amp;#x9001;&amp;#x51E0;&amp;#x4E2A;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6BB5;&amp;#x5728;RAM&amp;#x4E2D;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x9875;&amp;#x6846;&amp;#x6B63;&amp;#x597D;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4E5F;&amp;#x662F;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x8FD9;&amp;#x79CD;&amp;#x5408;&amp;#x5E76;&amp;#x65B9;&amp;#x5F0F;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#x5C31;&amp;#x79F0;&amp;#x4E3A;&amp;#x7269;&amp;#x7406;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/2016/05/12/max-seg-max-sec/segs.png&quot; alt=&quot;segs&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-2&amp;#x5404;&amp;#x53C2;&amp;#x6570;&amp;#x542B;&amp;#x4E49;&quot;&gt;&lt;a href=&quot;#1-2&amp;#x5404;&amp;#x53C2;&amp;#x6570;&amp;#x542B;&amp;#x4E49;&quot; class=&quot;headerlink&quot; title=&quot;1.2&amp;#x5404;&amp;#x53C2;&amp;#x6570;&amp;#x542B;&amp;#x4E49;&quot;&gt;&lt;/a&gt;1.2&amp;#x5404;&amp;#x53C2;&amp;#x6570;&amp;#x542B;&amp;#x4E49;&lt;/h2&gt;&lt;p&gt;max_segments&amp;#x8868;&amp;#x793A;&amp;#x8BBE;&amp;#x5907;&amp;#x80FD;&amp;#x591F;&amp;#x5141;&amp;#x8BB8;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6BB5;&amp;#x7684;&amp;#x6570;&amp;#x76EE;&amp;#x3002;&lt;br&gt;max_sectors_kb&amp;#x8868;&amp;#x793A;&amp;#x8BBE;&amp;#x5907;&amp;#x5141;&amp;#x8BB8;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x8BF7;&amp;#x6C42;&amp;#x5927;&amp;#x5C0F;&amp;#x3002;&lt;br&gt;max_hw_sectors_kb&amp;#x8868;&amp;#x793A;&amp;#x5355;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x6240;&amp;#x80FD;&amp;#x5904;&amp;#x7406;&amp;#x7684;&amp;#x6700;&amp;#x5927;KB&amp;#xFF08;&amp;#x786C;&amp;#x7EA6;&amp;#x675F;&amp;#xFF09;&lt;/p&gt;
&lt;h1 id=&quot;2-limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&amp;#x53CA;&amp;#x5F71;&amp;#x54CD;&quot;&gt;&lt;a href=&quot;#2-limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&amp;#x53CA;&amp;#x5F71;&amp;#x54CD;&quot; class=&quot;headerlink&quot; title=&quot;2.limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&amp;#x53CA;&amp;#x5F71;&amp;#x54CD;&quot;&gt;&lt;/a&gt;2.limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&amp;#x53CA;&amp;#x5F71;&amp;#x54CD;&lt;/h1&gt;&lt;h2 id=&quot;2-1limits&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&quot;&gt;&lt;a href=&quot;#2-1limits&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&quot; class=&quot;headerlink&quot; title=&quot;2.1limits&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&quot;&gt;&lt;/a&gt;2.1limits&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x7684;&amp;#x8BBE;&amp;#x7F6E;&lt;/h2&gt;&lt;p&gt;&amp;#x4E00;&amp;#x822C;&amp;#x7684;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x65F6;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;blk_queue_make_request&amp;#x8BBE;&amp;#x7F6E;make_request&amp;#x56DE;&amp;#x8C03;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x4E0E;&amp;#x6B64;&amp;#x540C;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD8;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;blk_set_default_limits&amp;#x8BBE;&amp;#x7F6E;&amp;#x8BBE;&amp;#x5907;queue&amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#x7684;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#xFF0C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x503C;&amp;#x5982;&amp;#x4E0B;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;enum&lt;/span&gt; blk_default_limits {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; BLK_MAX_SEGMENTS	= &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; BLK_SAFE_MAX_SECTORS	= &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; BLK_DEF_MAX_SECTORS	= &lt;span class=&quot;number&quot;&gt;1024&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; BLK_MAX_SEGMENT_SIZE	= &lt;span class=&quot;number&quot;&gt;65536&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; BLK_SEG_BOUNDARY_MASK	= &lt;span class=&quot;number&quot;&gt;0xFFFFFFFF&lt;/span&gt;UL,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;};&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-2-DIRECT-IO&amp;#x4E2D;max-segments&amp;#x548C;max-sectors-kb&quot;&gt;&lt;a href=&quot;#2-2-DIRECT-IO&amp;#x4E2D;max-segments&amp;#x548C;max-sectors-kb&quot; class=&quot;headerlink&quot; title=&quot;2.2 DIRECT IO&amp;#x4E2D;max_segments&amp;#x548C;max_sectors_kb&quot;&gt;&lt;/a&gt;2.2 DIRECT IO&amp;#x4E2D;max_segments&amp;#x548C;max_sectors_kb&lt;/h2&gt;&lt;p&gt;&amp;#x4F7F;&amp;#x7528;direct io&amp;#x65F6;&amp;#xFF0C;&amp;#x8DF3;&amp;#x8FC7;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;cache&amp;#xFF0C;io&amp;#x76F4;&amp;#x63A5;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&amp;#x4EE5;write&amp;#x4E3A;&amp;#x4F8B;&amp;#xFF0C;io path&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sys_write() --&amp;gt; vfs_write() --&amp;gt; do_sync_write() --&amp;gt; blkdev_aio_write() --&amp;gt; __generic_file_aio_write() --&amp;gt; generic_file_direct_write() --&amp;gt; blkdev_direct_IO() --&amp;gt; __blockdev_direct_IO() --&amp;gt; submit_page_section() --&amp;gt; dio_send_cur_page() --&amp;gt; dio_bio_submit() --&amp;gt; submit_bio() --&amp;gt; generic_make_request()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;dio_send_cur_page &amp;#x4E2D;&amp;#xFF0C;&amp;#x4F1A;&amp;#x5C1D;&amp;#x8BD5;&amp;#x5C06;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5408;&amp;#x5E76;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;bio&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x8FD4;&amp;#x56DE;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5408;&amp;#x5E76;&amp;#x5931;&amp;#x8D25;&amp;#x6216;&amp;#x8005;&amp;#x5F53;&amp;#x524D;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E0E;&amp;#x5DF2;&amp;#x6709;&amp;#x7684;bio&amp;#x4E0D;&amp;#x8FDE;&amp;#x7EED;&amp;#xFF0C;&amp;#x5C31;&amp;#x76F4;&amp;#x63A5;dio_bio_submit&amp;#x63D0;&amp;#x4EA4;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&lt;br&gt;&amp;#x5176;&amp;#x4E2D;dio_bio_add_page() &amp;#x2013;&amp;gt; bio_add_page() &amp;#x2013;&amp;gt; __bio_add_page() &amp;#x662F;&amp;#x5C06;&amp;#x5F53;&amp;#x524D;&amp;#x8BF7;&amp;#x6C42;&amp;#x5408;&amp;#x5E76;&amp;#x5230;bio&amp;#x4E2D;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;1&amp;#xFF09;max-segments&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;max-segments&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;max_segments&quot;&gt;&lt;/a&gt;1&amp;#xFF09;max_segments&lt;/h3&gt;&lt;p&gt;&amp;#x5728; __bio_add_page&amp;#x6709;&amp;#x5982;&amp;#x4E0B;&amp;#x4E00;&amp;#x6BB5;&amp;#x4EE3;&amp;#x7801;&amp;#xFF0C;&amp;#x4F1A;&amp;#x5224;&amp;#x65AD;bio&amp;#x4E2D;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x6BB5;&amp;#x6570;&amp;#x76EE;&amp;#x662F;&amp;#x5426;&amp;#x8D85;&amp;#x8FC7;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8D85;&amp;#x8FC7;&amp;#x5C31;&amp;#x8FD4;&amp;#x56DE;0&amp;#x8868;&amp;#x793A;add page&amp;#x5931;&amp;#x8D25;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;dio_bio_submit &amp;#x63D0;&amp;#x4EA4;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; (bio-&amp;gt;bi_phys_segments &amp;gt;= queue_max_segments(q)) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (retried_segments)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  return &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; retried_segments = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; blk_recount_segments(q, bio);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;2&amp;#xFF09;max-sectors-kb&quot;&gt;&lt;a href=&quot;#2&amp;#xFF09;max-sectors-kb&quot; class=&quot;headerlink&quot; title=&quot;2&amp;#xFF09;max_sectors_kb&quot;&gt;&lt;/a&gt;2&amp;#xFF09;max_sectors_kb&lt;/h3&gt;&lt;p&gt;&amp;#x540C;&amp;#x6837;&amp;#x662F;&amp;#x5728;__bio_add_page&amp;#x4E2D;&amp;#xFF0C;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (((bio-&amp;gt;bi_size + len) &amp;gt;&amp;gt; &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;) &amp;gt; max_sectors)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; return &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5176;&amp;#x4E2D;max_sectors&amp;#x5C31;&amp;#x662F;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_sectors_kb*2&amp;#xFF0C;&amp;#x5373;&amp;#x662F;&amp;#x5F53;&amp;#x8BE5;bio&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x8D85;&amp;#x8FC7;max_sectors_kb&amp;#x65F6;&amp;#xFF0C;&amp;#x5C31;&amp;#x8FD4;&amp;#x56DE;0&amp;#x8868;&amp;#x793A;add page&amp;#x5931;&amp;#x8D25;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;dio_bio_submit&amp;#x63D0;&amp;#x4EA4;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2-3-Device-Mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot;&gt;&lt;a href=&quot;#2-3-Device-Mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot; class=&quot;headerlink&quot; title=&quot;2.3 Device Mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot;&gt;&lt;/a&gt;2.3 Device Mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&lt;/h2&gt;&lt;p&gt;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x7B80;&amp;#x79F0;dm&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x5728;&amp;#x521A;&amp;#x5F00;&amp;#x59CB;&amp;#x521B;&amp;#x5EFA;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x65F6;&amp;#x4F1A;&amp;#x5148;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x4F1A;&amp;#x6839;&amp;#x636E;&amp;#x5176;&amp;#x5E95;&amp;#x5C42;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#xFF0C;&amp;#x4E24;&amp;#x8005;&amp;#x53D6;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x6765;&amp;#x8BBE;&amp;#x7F6E;dm&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#x503C;&amp;#x3002;&amp;#x5176;&amp;#x6D41;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;dm_create() --&amp;gt; alloc_dev() --&amp;gt; dm_init_md_queue() --&amp;gt; blk_queue_make_request()&amp;#x8BBE;&amp;#x7F6E;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x5728;dm_calculate_queue_limits&amp;#x4E2D;&amp;#x5148;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x9ED8;&amp;#x8BA4;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4F1A;&amp;#x6700;&amp;#x7EC8;&amp;#x8C03;&amp;#x7528;blk_stack_limits&amp;#xFF0C;&amp;#x53D6;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x548C;dm&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x8FD9;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x6765;&amp;#x8BBE;&amp;#x7F6E;dm&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;do_resume() --&amp;gt; dm_swap_table() --&amp;gt; dm_calculate_queue_limits() --&amp;gt; ti-&amp;gt;type-&amp;gt;iterate_devices() --&amp;gt;dm_set_device_limits() --&amp;gt; bdev_stack_limits() --&amp;gt; blk_stack_limits()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0D;&amp;#x8FC7;&amp;#x5728;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#x8FD8;&amp;#x6709;&amp;#x4E9B;&amp;#x4E0D;&amp;#x540C;&amp;#xFF0C;&amp;#x4E0A;&amp;#x9762;&amp;#x63CF;&amp;#x8FF0;&amp;#x7684;&amp;#x662F;3.2.54&amp;#x5185;&amp;#x6838;&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#xFF0C;&amp;#x5728;&amp;#x65B0;&amp;#x5185;&amp;#x6838;(3.10.11)&amp;#x4E2D;&amp;#xFF0C;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#x4E5F;&amp;#x4E00;&amp;#x6837;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x5728;dm_calculate_queue_limits&amp;#x4E2D;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;blk_set_stacking_limits()&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x4F1A;&amp;#x628A;limits&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x6781;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5728;&amp;#x540E;&amp;#x7EED;&amp;#x8C03;&amp;#x7528;blk_stack_limits&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x4E5F;&amp;#x662F;&amp;#x53D6;&amp;#x4E24;&amp;#x8005;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x56E0;&amp;#x4E3A;dm&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&amp;#x662F;&amp;#x6781;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4F1A;&amp;#x4F7F;&amp;#x7528;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x503C;&amp;#x6765;&amp;#x8BBE;&amp;#x7F6E;dm&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x505A;&amp;#x7684;&amp;#x597D;&amp;#x5904;&amp;#x5728;&amp;#x4E8E;&amp;#x53EF;&amp;#x4EE5;&amp;#x7EE7;&amp;#x627F;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x9650;&amp;#x5236;&amp;#xFF0C;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x80FD;&amp;#x5904;&amp;#x7406;&amp;#x8FD9;&amp;#x4E9B;limits&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x5728;&amp;#x5B83;&amp;#x4EEC;&amp;#x4E4B;&amp;#x4E0A;&amp;#x7684;dm&amp;#x8BBE;&amp;#x5907;&amp;#x540C;&amp;#x6837;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x9644;&amp;#x4E0A;blk_set_stacking_limits&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;blk_set_stacking_limits&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;struct&lt;/span&gt; queue_limits *lim)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; blk_set_default_limits(lim);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;comment&quot;&gt;/* Inherit limits from component devices */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lim-&amp;gt;discard_zeroes_data = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lim-&amp;gt;max_segments = USHRT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lim-&amp;gt;max_hw_sectors = UINT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lim-&amp;gt;max_sectors = UINT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lim-&amp;gt;max_write_same_sectors = UINT_MAX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;2-4-&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot;&gt;&lt;a href=&quot;#2-4-&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot; class=&quot;headerlink&quot; title=&quot;2.4 &amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&quot;&gt;&lt;/a&gt;2.4 &amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x4E2D;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&lt;/h2&gt;&lt;p&gt;&amp;#x8F6F;raid&amp;#x7684;&amp;#x521B;&amp;#x5EFA;&amp;#x8FC7;&amp;#x7A0B;&amp;#x53C2;&amp;#x8003;&lt;a href=&quot;http://blog.csdn.net/liumangxiong/article/details/12405231&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/liumangxiong/article/details/12405231&lt;/a&gt;&lt;br&gt;&lt;br&gt;&amp;#x7B80;&amp;#x5355;&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5206;&amp;#x914D;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x6570;&amp;#x636E;&amp;#x7ED3;&amp;#x6784;&amp;#xFF0C;&amp;#x6CE8;&amp;#x518C;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;raid&amp;#x7EA7;&amp;#x522B;&amp;#x518D;&amp;#x8FDB;&amp;#x884C;&amp;#x4E00;&amp;#x4E9B;&amp;#x5FC5;&amp;#x8981;&amp;#x7684;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x3002;&lt;br&gt;&amp;#x8C03;&amp;#x7528;&amp;#x5173;&amp;#x7CFB;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;md_init() --&amp;gt; md_probe() --&amp;gt; md_alloc() --&amp;gt; blk_queue_make_request()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E4B;&amp;#x524D;&amp;#x5DF2;&amp;#x7ECF;&amp;#x8BF4;&amp;#x5230;&amp;#x5728;blk_queue_make_request&amp;#x4E2D;&amp;#x4F1A;&amp;#x6CE8;&amp;#x518C;make_request_fn&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x4F1A;&amp;#x8BBE;&amp;#x7F6E;limits&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;do_md_run --&amp;gt; md_run() --&amp;gt; mddev-&amp;gt;pers-&amp;gt;run(mddev) &amp;#x5BF9;&amp;#x5E94;raid1&amp;#x4E2D;&amp;#x7684;run() --&amp;gt; &amp;#x4F1A;&amp;#x904D;&amp;#x5386;raid&amp;#x4E2D;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x8C03;&amp;#x7528;disk_stack_limits() --&amp;gt; bdev_stack_limits() --&amp;gt; blk_stack_limits()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E5F;&amp;#x662F;&amp;#x4F1A;&amp;#x6839;&amp;#x636E;md&amp;#x8BBE;&amp;#x5907;&amp;#x548C;&amp;#x5176;&amp;#x5E95;&amp;#x5C42;&amp;#x7684;&amp;#x6210;&amp;#x5458;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;queue-&amp;gt;limits&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x4E24;&amp;#x8005;&amp;#x53D6;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0E;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7C7B;&amp;#x4F3C;&amp;#xFF0C;&amp;#x5728;&amp;#x4E0D;&amp;#x540C;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;limits&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&amp;#x8FD8;&amp;#x6709;&amp;#x4E9B;&amp;#x4E0D;&amp;#x540C;&amp;#x3002;&lt;br&gt;&amp;#x4E0A;&amp;#x9762;&amp;#x63CF;&amp;#x8FF0;&amp;#x7684;&amp;#x662F;3.2.54&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x7684;&amp;#x6D41;&amp;#x7A0B;&amp;#x3002;&lt;br&gt;&amp;#x5728;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#xFF0C;md_alloc&amp;#x4E2D;&amp;#x5728;&amp;#x8C03;&amp;#x7528;blk_queue_make_request&amp;#x4E4B;&amp;#x540E;&amp;#x8FD8;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;blk_set_stacking_limits&amp;#x5C06;md&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;&amp;#x6781;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x80FD;&amp;#x5728;blk_stack_limits&amp;#x4E2D;&amp;#x53D6;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#x65F6;&amp;#x7EE7;&amp;#x627F;&amp;#x5E95;&amp;#x5C42;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;limits&amp;#x53C2;&amp;#x6570;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;fio&amp;#x5728;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x5185;&amp;#x6838;&amp;#x4E0B;&amp;#x5BF9;&amp;#x8F6F;raid1&amp;#x6D4B;&amp;#x8BD5;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x73B0;&amp;#x533A;&amp;#x522B;&amp;#xFF0C;&amp;#x5F53;fio&amp;#x4F7F;&amp;#x7528;&amp;#x5927;&amp;#x4E8E;127KB&amp;#x7684;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x65F6;&amp;#xFF0C;&amp;#x5728;3.2.54&amp;#x5185;&amp;#x6838;&amp;#x4F7F;&amp;#x7528;iostat&amp;#x5C31;&amp;#x4F1A;&amp;#x770B;&amp;#x5230;&amp;#x5B9E;&amp;#x9645;&amp;#x843D;&amp;#x5230;md&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&amp;#x5927;&amp;#x5C0F;&amp;#x5C0F;&amp;#x4E8E;fio&amp;#x4E0B;&amp;#x53D1;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5728;3.10.11&amp;#x5C31;&amp;#x6CA1;&amp;#x6709;&amp;#x8FD9;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x53E6;&amp;#x5916;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x63D0;&amp;#x5230;&amp;#x7684;&amp;#x662F;&amp;#x5728;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x4E2D;&amp;#x4E5F;&amp;#x6CA1;&amp;#x6709;&amp;#x300A;systemtap&amp;#x5206;&amp;#x6790;&amp;#x8F6F;raid1 io&amp;#x62C6;&amp;#x5206;&amp;#x95EE;&amp;#x9898;&amp;#x300B;&amp;#x4E2D;max_segments&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;1&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x65B0;&amp;#x5185;&amp;#x6838;&amp;#x7684;raid1&amp;#x4E2D;&amp;#x7684;run()&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x5DF2;&amp;#x7ECF;&amp;#x53D6;&amp;#x6D88;&amp;#x6389;&amp;#x8FD9;&amp;#x6BB5;&amp;#x4EE3;&amp;#x7801;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (rdev-&amp;gt;bdev-&amp;gt;bd_disk-&amp;gt;&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;-&amp;gt;merge_bvec_fn) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  blk_queue_max_segments(mddev-&amp;gt;&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  blk_queue_segment_boundary(mddev-&amp;gt;&lt;span class=&quot;built_in&quot;&gt;queue&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        PAGE_CACHE_SIZE - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; }&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x4E0D;&amp;#x4F1A;&amp;#x5C06;max_segments&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;1&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;s3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;a href=&quot;#s3-&amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot; class=&quot;headerlink&quot; title=&quot;s3. &amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&quot;&gt;&lt;/a&gt;s3. &amp;#x53C2;&amp;#x8003;&amp;#x8D44;&amp;#x6599;&lt;/h1&gt;&lt;p&gt;1&amp;#xFF09;&amp;#x300A;&amp;#x6DF1;&amp;#x5165;&amp;#x7406;&amp;#x89E3;linux&amp;#x5185;&amp;#x6838;&amp;#x300B;&lt;br&gt;2&amp;#xFF09;&amp;#x300A;linux&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x300B;&lt;br&gt;3&amp;#xFF09;&amp;#x8F6F;raid&amp;#x4EE3;&amp;#x7801;&amp;#x5206;&amp;#x6790;&lt;a href=&quot;http://blog.csdn.net/liumangxiong/article/details/12405231&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/liumangxiong/article/details/12405231&lt;/a&gt;&lt;br&gt;4&amp;#xFF09;&lt;a href=&quot;https://www.kernel.org/doc/Documentation/block/queue-sysfs.txt&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.kernel.org/doc/Documentation/block/queue-sysfs.txt&lt;/a&gt;&lt;br&gt;5&amp;#xFF09;3.2.54&amp;#x53CA;3.10.11&amp;#x5185;&amp;#x6838;&amp;#x6E90;&amp;#x4EE3;&amp;#x7801;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5728;DMA&amp;#x8BBE;&amp;#x5907;&amp;#x4E0D;&amp;#x91C7;&amp;#x7528;S/G&amp;#xFF08;&amp;#x5206;&amp;#x6563;/&amp;#x805A;&amp;#x96C6;&amp;#xFF09;&amp;#x6A21;&amp;#x5F0F;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x5FC5;&amp;#x987B;&amp;#x4FDD;&amp;#x8BC1;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x4E0A;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;linux&amp;#x5185;&amp;#x6838;&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x7528;&amp;#x6765;&amp;#x5206;&amp;#x914D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#xFF1A;kmalloc()&amp;#x548C;&lt;strong&gt;get_free_pages()&amp;#x3002;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x90FD;&amp;#x6709;&amp;#x5206;&amp;#x914D;&amp;#x8FDE;&amp;#x7EED;&amp;#x5185;&amp;#x5B58;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#xFF0C;kmalloc&amp;#x4EE5;&amp;#x5206;&amp;#x914D;&amp;#x5B57;&amp;#x8282;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x7EA6;&amp;#x4E3A;64KB&amp;#xFF0C;&lt;/strong&gt;get_free_pages()&amp;#x4EE5;&amp;#x5206;&amp;#x914D;&amp;#x9875;&amp;#x4E3A;&amp;#x5355;&amp;#x4F4D;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;&amp;#x80FD;&amp;#x5206;&amp;#x914D;2^order&amp;#x6570;&amp;#x76EE;&amp;#x7684;&amp;#x9875;&lt;/p&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;DMA&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x7684;&amp;#x4E3B;&amp;#x8981;&amp;#x95EE;&amp;#x9898;&amp;#x662F;&amp;#xFF1A;&amp;#x5F53;&amp;#x5927;&amp;#x4E8E;&amp;#x4E00;&amp;#x9875;&amp;#x65F6;&amp;#xFF0C;&amp;#x5B83;&amp;#x4EEC;&amp;#x5FC5;&amp;#x987B;&amp;#x5360;&amp;#x636E;&amp;#x8FDE;&amp;#x63A5;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x9875;&amp;#xFF0C;&amp;#x8FD9;&amp;#x662F;&amp;#x56E0;&amp;#x4E3A;&amp;#x8BBE;&amp;#x5907;&amp;#x4F7F;&amp;#x7528;ISA&amp;#x6216;&amp;#x8005;PCI&amp;#x7CFB;&amp;#x7EDF;&amp;#x603B;&amp;#x7EBF;&amp;#x4F20;&amp;#x8F93;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x800C;&amp;#x8FD9;&amp;#x4E24;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x90FD;&amp;#x662F;&amp;#x7269;&amp;#x7406;&amp;#x5730;&amp;#x5740;&lt;/p&gt;
&lt;p&gt;linux&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;&amp;#x5904;&amp;#x7406;io&amp;#x65F6;&amp;#x4F1A;&amp;#x53D7;&amp;#x5230;&amp;#x4E00;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#xFF08;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;queue limits&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7B80;&amp;#x79F0;limits&amp;#x53C2;&amp;#x6570;&amp;#xFF09;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E2D;&amp;#x5141;&amp;#x8BB8;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#xFF0C;&amp;#x6700;&amp;#x5927;segment&amp;#x6570;&amp;#x7B49;&amp;#x3002;&amp;#x8FD9;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#x53EF;&amp;#x4EE5;&amp;#x5728;/sys/block/&lt;device&gt;/queue/&amp;#x4E0B;&amp;#x67E5;&amp;#x770B;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x5728;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x65F6;&amp;#x4F1A;&amp;#x8BBE;&amp;#x7F6E;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x3002;&amp;#x8FD9;&amp;#x91CC;&amp;#x4E3B;&amp;#x8981;&amp;#x5206;&amp;#x6790;max_segments&amp;#x548C;max_sectors_kb&amp;#x3002;&lt;/device&gt;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.&amp;#x57FA;&amp;#x672C;&amp;#x6982;&amp;#x5FF5;&lt;/h1&gt;&lt;h2 id=&quot;1-1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;a href=&quot;#1-1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot; class=&quot;headerlink&quot; title=&quot;1.1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&quot;&gt;&lt;/a&gt;1.1&amp;#x6BB5;&amp;#x7684;&amp;#x6982;&amp;#x5FF5;&lt;/h2&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x4E86;&amp;#x89E3;&amp;#x4E00;&amp;#x4E0B;&amp;#x4EC0;&amp;#x4E48;&amp;#x662F;&amp;#x6BB5;&amp;#xFF08;segment&amp;#xFF09;&amp;#x3002;&lt;br&gt;&amp;#x4E00;&amp;#x4E2A;&amp;#x6BB5;&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x6216;&amp;#x8005;&amp;#x5185;&amp;#x5B58;&amp;#x9875;&amp;#x7684;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x5B83;&amp;#x4EEC;&amp;#x5305;&amp;#x542B;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x7269;&amp;#x7406;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x3002;&lt;br&gt;&amp;#x78C1;&amp;#x76D8;&amp;#x7684;&amp;#x6BCF;&amp;#x4E2A;io&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;RAM&amp;#x5355;&amp;#x5143;&amp;#x4E4B;&amp;#x95F4;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x9001;&amp;#x4E00;&amp;#x4E9B;&amp;#x76F8;&amp;#x90BB;&amp;#x6247;&amp;#x533A;&amp;#x7684;&amp;#x5185;&amp;#x5BB9;&amp;#x3002;&amp;#x5927;&amp;#x591A;&amp;#x6570;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x91C7;&amp;#x7528;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x53EA;&amp;#x8981;&amp;#x5411;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x53D1;&amp;#x9001;&amp;#x9002;&amp;#x5F53;&amp;#x7684;&amp;#x547D;&amp;#x4EE4;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x89E6;&amp;#x53D1;&amp;#x4E00;&amp;#x6B21;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#xFF0C;&amp;#x4E00;&amp;#x65E6;&amp;#x5B8C;&amp;#x6210;&amp;#x6570;&amp;#x636E;&amp;#x4F20;&amp;#x9001;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x5C31;&amp;#x4F1A;&amp;#x53D1;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x4E2D;&amp;#x65AD;&amp;#x901A;&amp;#x77E5;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x3002;&lt;br&gt;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#x4F20;&amp;#x9001;&amp;#x7684;&amp;#x662F;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x867D;&amp;#x7136;&amp;#x4E5F;&amp;#x5141;&amp;#x8BB8;&amp;#x4F20;&amp;#x9001;&amp;#x4E0D;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#x6247;&amp;#x533A;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;&amp;#x8FD9;&amp;#x4E2A;&amp;#x6BD4;&amp;#x8F83;&amp;#x4F4E;&amp;#x6548;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x78C1;&amp;#x5934;&amp;#x79FB;&amp;#x52A8;&amp;#x6162;&amp;#x3002;&lt;br&gt;&amp;#x8001;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x4EC5;&amp;#x4EC5;&amp;#x652F;&amp;#x6301;&amp;#x201C;&amp;#x7B80;&amp;#x5355;&amp;#x201D;&amp;#x7684;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF1A;&amp;#x78C1;&amp;#x76D8;&amp;#x5FC5;&amp;#x987B;&amp;#x4E0E;RAM&amp;#x4E2D;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x5355;&amp;#x5143;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#x3002;&amp;#x4F46;&amp;#x662F;&amp;#x65B0;&amp;#x7684;&amp;#x78C1;&amp;#x76D8;&amp;#x63A7;&amp;#x5236;&amp;#x5668;&amp;#x652F;&amp;#x6301;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;&amp;#xFF08;scatter-gather&amp;#xFF09;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x78C1;&amp;#x76D8;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E0E;&amp;#x4E00;&amp;#x4E9B;&amp;#x975E;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#x76F8;&amp;#x4E92;&amp;#x4F20;&amp;#x9001;&amp;#x6570;&amp;#x636E;&amp;#x3002;&lt;br&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x652F;&amp;#x6301;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;DMA&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#x9A71;&amp;#x52A8;&amp;#x7A0B;&amp;#x5E8F;&amp;#x5FC5;&amp;#x987B;&amp;#x80FD;&amp;#x591F;&amp;#x5904;&amp;#x7406;&amp;#x79F0;&amp;#x4E3A;&amp;#x6BB5;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5B58;&amp;#x50A8;&amp;#x5355;&amp;#x5143;&amp;#xFF0C;&amp;#x4E00;&amp;#x6B21;&amp;#x5206;&amp;#x6563;&amp;#x805A;&amp;#x96C6;DMA&amp;#x53EF;&amp;#x4EE5;&amp;#x4F20;&amp;#x9001;&amp;#x51E0;&amp;#x4E2A;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6BB5;&amp;#x5728;RAM&amp;#x4E2D;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x9875;&amp;#x6846;&amp;#x6B63;&amp;#x597D;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x4E5F;&amp;#x662F;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x901A;&amp;#x7528;&amp;#x5757;&amp;#x5C42;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x8FD9;&amp;#x79CD;&amp;#x5408;&amp;#x5E76;&amp;#x65B9;&amp;#x5F0F;&amp;#x4EA7;&amp;#x751F;&amp;#x7684;&amp;#x66F4;&amp;#x5927;&amp;#x7684;&amp;#x5185;&amp;#x5B58;&amp;#x533A;&amp;#x57DF;&amp;#x5C31;&amp;#x79F0;&amp;#x4E3A;&amp;#x7269;&amp;#x7406;&amp;#x6BB5;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="kernel" scheme="http://yoursite.com/tags/kernel/"/>
    
  </entry>
  
  <entry>
    <title>flashcachegroup浅析</title>
    <link href="http://yoursite.com/2016/05/05/flashcachegroup/"/>
    <id>http://yoursite.com/2016/05/05/flashcachegroup/</id>
    <published>2016-05-05T08:02:35.000Z</published>
    <updated>2016-05-05T08:23:07.632Z</updated>
    
    <content type="html">&lt;h1 id=&quot;&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;flashcachegroup&amp;#x80FD;&amp;#x591F;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x5757;&amp;#x6216;&amp;#x591A;&amp;#x5757;ssd&amp;#x6765;&amp;#x7F13;&amp;#x5B58;&amp;#x4E00;&amp;#x7EC4;hdd&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;&amp;#x786C;&amp;#x76D8;&amp;#x7EC4;&amp;#x80FD;&amp;#x591F;&amp;#x52A8;&amp;#x6001;&amp;#x589E;&amp;#x52A0;&amp;#x5220;&amp;#x9664;&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;ssd&amp;#x7F13;&amp;#x5B58;&amp;#x80FD;&amp;#x591F;&amp;#x6574;&amp;#x4E2A;&amp;#x786C;&amp;#x76D8;&amp;#x7EC4;&amp;#x800C;&amp;#x4E0D;&amp;#x4EC5;&amp;#x4EC5;&amp;#x662F;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x3002;&lt;br&gt;&amp;#x5176;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x4E0B;&amp;#xFF0C;&amp;#x53C2;&amp;#x8003;&amp;#x5B98;&amp;#x65B9;&amp;#x8BF4;&amp;#x660E;&lt;a href=&quot;https://github.com/lihuiba/flashcachegroup&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;&amp;#x4ECB;&amp;#x7ECD;&amp;#x91CC;&amp;#x7684;&amp;#x7ED3;&amp;#x6784;&amp;#x56FE;&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/lihuiba/flashcachegroup&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;&amp;#x4ECB;&amp;#x7ECD;&amp;#x91CC;&amp;#x7684;&amp;#x7ED3;&amp;#x6784;&amp;#x56FE;&lt;/a&gt;.&lt;br&gt;&lt;img src=&quot;/2016/05/05/flashcachegroup/fcg.png&quot; alt=&quot;fcg&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot;&gt;&lt;a href=&quot;#1-&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot;&gt;&lt;/a&gt;1.&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&lt;/h1&gt;&lt;h2 id=&quot;1&amp;#xFF09;-&amp;#x5B89;&amp;#x88C5;flashcache&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;-&amp;#x5B89;&amp;#x88C5;flashcache&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09; &amp;#x5B89;&amp;#x88C5;flashcache&quot;&gt;&lt;/a&gt;1&amp;#xFF09; &amp;#x5B89;&amp;#x88C5;flashcache&lt;/h2&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x9700;&amp;#x8981;&amp;#x5B89;&amp;#x88C5;flashcache&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4F7F;&amp;#x7528;&amp;#x6E90;&amp;#x7801;&amp;#x5B89;&amp;#x88C5;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git clone https://github.com/facebook/flashcache.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#cd flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5207;&amp;#x6362;&amp;#x5230;&amp;#x7A33;&amp;#x5B9A;&amp;#x7248;stable_v3.1.1&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git checkout stable_v3.1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;flashcache&amp;#x7F16;&amp;#x8BD1;&amp;#x9700;&amp;#x8981;&amp;#x4F9D;&amp;#x8D56;KERNE_TREE&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#make KERNEL_TREE=/usr/src/linux-headers-3.10.11-openstack-amd64/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#make install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x52A0;&amp;#x8F7D;flashcache&amp;#x6A21;&amp;#x5757;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#modprobe flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#lsmod | grep flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;2&amp;#xFF09;&amp;#x4E0B;&amp;#x8F7D;fcg&quot;&gt;&lt;a href=&quot;#2&amp;#xFF09;&amp;#x4E0B;&amp;#x8F7D;fcg&quot; class=&quot;headerlink&quot; title=&quot;2&amp;#xFF09;&amp;#x4E0B;&amp;#x8F7D;fcg&quot;&gt;&lt;/a&gt;2&amp;#xFF09;&amp;#x4E0B;&amp;#x8F7D;fcg&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git clone https://github.com/lihuiba/flashcachegroup.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x8FDB;&amp;#x5165;&amp;#x76EE;&amp;#x5F55;,&amp;#x5207;&amp;#x6362;&amp;#x5230;v0.3.0&amp;#x7248;&amp;#x672C;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git checkout v0.3.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x6267;&amp;#x884C;python setup.py install&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x62A5;&amp;#x9519;&amp;#x201C;ImportError: No module named setuptools&amp;#x201D;&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;&amp;#x7F3A;&amp;#x5C11;python-setuptools&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#apt-get install python-setuptools&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x6267;&amp;#x884C;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#python setup.py install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5B89;&amp;#x88C5;&amp;#x6210;&amp;#x529F;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;3&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;pydm&quot;&gt;&lt;a href=&quot;#3&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;pydm&quot; class=&quot;headerlink&quot; title=&quot;3&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;pydm&quot;&gt;&lt;/a&gt;3&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;pydm&lt;/h2&gt;&lt;p&gt;&amp;#x4F7F;&amp;#x7528;fcg create&amp;#x62A5;&amp;#x9519;&lt;br&gt;&amp;#x201C;ImportError: No module named pydm.dmsetup&amp;#x201D;&lt;br&gt;&amp;#x9700;&amp;#x8981;&amp;#x5B89;&amp;#x88C5;pydm&lt;br&gt;&amp;#x4F7F;&amp;#x7528;easy_install pydm&amp;#x5B89;&amp;#x88C5;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# easy_install pydm&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Searching &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; pydm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Reading http://pypi.python.org/simple/pydm/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Best match: pydm 0.2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Downloading https://pypi.python.org/packages/&lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt;/p/pydm/pydm-0.2.0.tar.gz&lt;span class=&quot;comment&quot;&gt;#md5=cb2753aef529af7d21f49d4cdc4fa4ae&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Processing pydm-0.2.0.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Running pydm-0.2.0/setup.py -q bdist_egg --dist-dir /tmp/easy_install-8_yfei/pydm-0.2.0/egg-dist-tmp-pj5m9c&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;error: README.md: No such file or directory&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x5B89;&amp;#x88C5;&amp;#x8FD8;&amp;#x662F;&amp;#x4E0D;&amp;#x884C;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x628A;pydm&amp;#x5305;&amp;#x4E0B;&amp;#x8F7D;&amp;#x4E0B;&amp;#x6765;&amp;#xFF0C;&lt;br&gt;&amp;#x8FDB;&amp;#x5165;&amp;#x5230;pydm-0.2.0&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x5B89;&amp;#x88C5;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#python setup.py install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E5F;&amp;#x62A5;&amp;#x540C;&amp;#x6837;&amp;#x7684;&amp;#x9519;&amp;#x8BEF;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x786E;&amp;#x5B9E;&amp;#x6CA1;&amp;#x6709;README.md&amp;#x8FD9;&amp;#x4E2A;&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&amp;#x89E3;&amp;#x51B3;&amp;#x529E;&amp;#x6CD5;&amp;#x662F;&amp;#x76F4;&amp;#x63A5;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x7A7A;&amp;#x7684;README.md&amp;#x6587;&amp;#x4EF6;&amp;#xFF0C;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x5B89;&amp;#x88C5;&amp;#xFF0C;&amp;#x6210;&amp;#x529F;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;4&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;eventlet&quot;&gt;&lt;a href=&quot;#4&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;eventlet&quot; class=&quot;headerlink&quot; title=&quot;4&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;eventlet&quot;&gt;&lt;/a&gt;4&amp;#xFF09;&amp;#x7F3A;&amp;#x5C11;eventlet&lt;/h1&gt;&lt;p&gt;&amp;#x518D;&amp;#x6267;&amp;#x884C;fcg create&amp;#x65F6;&amp;#x62A5;&amp;#x9519;&amp;#x201C;ImportError: No module named eventlet.green&amp;#x201D;&lt;br&gt;&amp;#x5B89;&amp;#x88C5;eventlet&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#apt-get install python-eventlet&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;5&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;fcg&quot;&gt;&lt;a href=&quot;#5&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;fcg&quot; class=&quot;headerlink&quot; title=&quot;5&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;fcg&quot;&gt;&lt;/a&gt;5&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;fcg&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg create -g group1 -c /dev/vde&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg add -g group1 -d /dev/vdb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg add -g group1 -d /dev/vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4E0D;&amp;#x8FC7;fcg&amp;#x5220;&amp;#x9664;disk&amp;#xFF0C;&amp;#x5220;&amp;#x9664;group&amp;#xFF0C;&amp;#x66FF;&amp;#x6362;ssd&amp;#x90FD;&amp;#x6709;bug&amp;#xFF0C;&amp;#x4E0D;&amp;#x80FD;&amp;#x6267;&amp;#x884C;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-flashcachegroup&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&quot;&gt;&lt;a href=&quot;#2-flashcachegroup&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&quot; class=&quot;headerlink&quot; title=&quot;2. flashcachegroup&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&quot;&gt;&lt;/a&gt;2. flashcachegroup&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x673A;&amp;#x5236;&lt;/h1&gt;&lt;p&gt;fcg&amp;#x7684;&amp;#x5B9E;&amp;#x73B0;&amp;#x633A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5C01;&amp;#x88C5;&amp;#x4E86;flashcache&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x6574;&amp;#x4F53;&amp;#x7ED3;&amp;#x6784;&amp;#x4E0A;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;hdd&amp;#x7684;group&amp;#x548C;&amp;#x4E00;&amp;#x4E2A;ssd&amp;#x7684;group&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;group&amp;#x53EF;&amp;#x4EE5;&amp;#x5305;&amp;#x542B;&amp;#x591A;&amp;#x5757;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;group&amp;#x91CC;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;device mapper&amp;#x7684;linear&amp;#x7EBF;&amp;#x6027;&amp;#x6620;&amp;#x5C04;&amp;#x5EFA;&amp;#x6210;&amp;#x7684;&amp;#x3002;&lt;br&gt;&lt;br&gt;hdd&amp;#x7684;group&amp;#x548C;ssd&amp;#x7684;group&amp;#x90FD;&amp;#x662F;&amp;#x4E24;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x56E0;&amp;#x4E3A;flashcache&amp;#x7684;&amp;#x673A;&amp;#x5236;&amp;#x662F;&amp;#x628A;&amp;#x4E00;&amp;#x4E2A;hdd&amp;#x548C;&amp;#x4E00;&amp;#x4E2A;ssd&amp;#x505A;&amp;#x6210;&amp;#x4E00;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x4E00;&amp;#x65E6;&amp;#x521B;&amp;#x5EFA;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5927;&amp;#x5C0F;&amp;#x5C31;&amp;#x4E0D;&amp;#x80FD;&amp;#x505A;&amp;#x4FEE;&amp;#x6539;&amp;#x4E86;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x4E3A;&amp;#x4E86;&amp;#x80FD;&amp;#x591F;&amp;#x589E;&amp;#x52A0;&amp;#x78C1;&amp;#x76D8;&amp;#xFF0C;hdd group&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;1PB&amp;#xFF08;&amp;#x76EE;&amp;#x524D;&amp;#x6765;&amp;#x770B;&amp;#xFF0C;1PB&amp;#x4E5F;&amp;#x8DB3;&amp;#x591F;&amp;#x4E86;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8FD8;&amp;#x6709;&amp;#x9700;&amp;#x6C42;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x505A;&amp;#x4FEE;&amp;#x6539;&amp;#xFF09;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;hdd group&amp;#x91CC;&amp;#x7684;hdd&amp;#x5927;&amp;#x5C0F;&amp;#x4E0D;&amp;#x8DB3;1PB&amp;#xFF0C;&amp;#x5C31;&amp;#x4F7F;&amp;#x7528;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x6837;&amp;#x7EBF;&amp;#x6027;&amp;#x6620;&amp;#x5C04;&amp;#xFF0C;error&amp;#x8BBE;&amp;#x5907;&amp;#x8FD9;&amp;#x6BB5;&amp;#x7A7A;&amp;#x95F4;&amp;#x662F;&amp;#x4E0D;&amp;#x4F1A;&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x7ED9;&amp;#x7528;&amp;#x6237;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x4E0D;&amp;#x4F1A;&amp;#x8BFB;&amp;#x5199;&amp;#x5230;&amp;#x8FD9;&amp;#x6BB5;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0D;&amp;#x4F1A;&amp;#x6709;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&lt;br&gt;&lt;br&gt;ssd group&amp;#x5C31;&amp;#x4E0D;&amp;#x80FD;&amp;#x91C7;&amp;#x7528;hdd group&amp;#x7684;&amp;#x65B9;&amp;#x6CD5;&amp;#x4E86;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;flashcache&amp;#x4E2D;ssd&amp;#x662F;&amp;#x4F5C;&amp;#x4E3A;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BBE;&amp;#x5907;&amp;#x4F5C;&amp;#x7F13;&amp;#x5B58;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#xFF0C;&amp;#x6574;&amp;#x4E2A;ssd&amp;#x90FD;&amp;#x4F1A;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x518D;&amp;#x586B;&amp;#x5145;error&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x8BA4;&amp;#x4E3A;&amp;#x8FD9;&amp;#x4E2A;ssd&amp;#x574F;&amp;#x4E86;&amp;#x3002;&lt;br&gt;ssd group&amp;#x4E00;&amp;#x65E6;&amp;#x786E;&amp;#x5B9A;&amp;#x597D;&amp;#x4E86;&amp;#x6709;&amp;#x51E0;&amp;#x5757;ssd&amp;#x7EC4;&amp;#x6210;&amp;#xFF0C;&amp;#x540E;&amp;#x9762;&amp;#x5C31;&amp;#x4E0D;&amp;#x80FD;&amp;#x518D;&amp;#x589E;&amp;#x52A0;&amp;#x6216;&amp;#x5220;&amp;#x9664;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;group&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;group&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;group&quot;&gt;&lt;/a&gt;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;group&lt;/h2&gt;&lt;p&gt;&amp;#x4F7F;&amp;#x7528;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg create -g &amp;lt;group&amp;gt; -c &amp;lt;ssd device&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x8C03;&amp;#x7528;flashcache_create&amp;#x4EE5;hdd group&amp;#x548C;ssd device&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x591A;&amp;#x5757;ssd device&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x5148;&amp;#x628A;&amp;#x8FD9;&amp;#x51E0;&amp;#x4E2A;ssd&amp;#x68C0;&amp;#x67E5;device mapper&amp;#x8BBE;&amp;#x5907;ssd group&amp;#xFF0C;&amp;#x518D;&amp;#x4EE5;hdd group&amp;#x548C;ssd group&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x521B;&amp;#x5EFA;&amp;#x51FA;&amp;#x6765;&amp;#x7684;hdd group&amp;#x5C31;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;error&amp;#x8BBE;&amp;#x5907;&amp;#x6620;&amp;#x5C04;&amp;#x7684;&amp;#xFF0C;&amp;#x8FD8;&amp;#x6CA1;&amp;#x6709;&amp;#x4EFB;&amp;#x4F55;hdd&amp;#x52A0;&amp;#x5165;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2&amp;#xFF09;&amp;#x6DFB;&amp;#x52A0;&amp;#x78C1;&amp;#x76D8;&quot;&gt;&lt;a href=&quot;#2&amp;#xFF09;&amp;#x6DFB;&amp;#x52A0;&amp;#x78C1;&amp;#x76D8;&quot; class=&quot;headerlink&quot; title=&quot;2&amp;#xFF09;&amp;#x6DFB;&amp;#x52A0;&amp;#x78C1;&amp;#x76D8;&quot;&gt;&lt;/a&gt;2&amp;#xFF09;&amp;#x6DFB;&amp;#x52A0;&amp;#x78C1;&amp;#x76D8;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg add -g &amp;lt;group&amp;gt; -d &amp;lt;hdd device&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x9879;&amp;#x64CD;&amp;#x4F5C;&amp;#x5C31;&amp;#x662F;&amp;#x4FEE;&amp;#x6539;hdd group&amp;#x8FD9;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;&amp;#x6309;&amp;#x7167;&amp;#x5730;&amp;#x5740;&amp;#x7A7A;&amp;#x95F4;&amp;#x6620;&amp;#x5C04;&amp;#x5230;&amp;#x7ED9;&amp;#x5B9A;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#x4E0A;&amp;#x3002;&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4ECD;&amp;#x7136;&amp;#x4EE5;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x5728;hdd group&amp;#x8FD9;&amp;#x4E2A;&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4F7F;&amp;#x7528;device mapper&amp;#x7684;linear&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x4E00;&amp;#x4E2A;&amp;#x548C;&amp;#x7ED9;&amp;#x5B9A;&amp;#x7269;&amp;#x7406;&amp;#x78C1;&amp;#x76D8;&amp;#xFF08;&amp;#x6BD4;&amp;#x5982;/dev/sdb&amp;#xFF09;&amp;#x5927;&amp;#x5C0F;&amp;#x4E00;&amp;#x6837;&amp;#x7684;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;cdb&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x76F8;&amp;#x5F53;&amp;#x4E8E;cdb&amp;#x548C;sdb&amp;#x4E00;&amp;#x4E00;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;3&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x78C1;&amp;#x76D8;&quot;&gt;&lt;a href=&quot;#3&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x78C1;&amp;#x76D8;&quot; class=&quot;headerlink&quot; title=&quot;3&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x78C1;&amp;#x76D8;&quot;&gt;&lt;/a&gt;3&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x78C1;&amp;#x76D8;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#fcg remove -g &amp;lt;group&amp;gt; -d &amp;lt;disk&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x5220;&amp;#x9664;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#x4E5F;&amp;#x662F;&amp;#x4FEE;&amp;#x6539;hdd group&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;&amp;#x5C06;hdd group&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&lt;disk&gt;&amp;#x7684;&amp;#x90A3;&amp;#x6BB5;&amp;#x7A7A;&amp;#x95F4;&amp;#x66FF;&amp;#x6362;&amp;#x6210;error&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x8FD8;&amp;#x9700;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;flashcache_invalidate&amp;#x5C06;&amp;#x8FD9;&amp;#x4E2A;disk&amp;#x7F13;&amp;#x5B58;&amp;#x5728;ssd&amp;#x4E2D;&amp;#x7684;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7ED9;&amp;#x5931;&amp;#x6548;&amp;#x6389;.&lt;br&gt;&lt;br&gt;flashcache_invalidate&amp;#x8FD9;&amp;#x9879;&amp;#x64CD;&amp;#x4F5C;&amp;#x662F;&amp;#x4F5C;&amp;#x8005;&amp;#x4FEE;&amp;#x6539;flashcache&amp;#x4EE3;&amp;#x7801;&amp;#x589E;&amp;#x52A0;&amp;#x7684;&amp;#xFF0C;&amp;#x539F;&amp;#x7248;&amp;#x7684;&amp;#x662F;&amp;#x6CA1;&amp;#x6709;&amp;#x8FD9;&amp;#x4E2A;&amp;#x547D;&amp;#x4EE4;&amp;#x7684;&amp;#x3002;&lt;br&gt;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&amp;#x53C2;&amp;#x89C1;&lt;a href=&quot;https://github.com/anzigly/flashcache-invalid&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/anzigly/flashcache-invalid&lt;/a&gt;&lt;/disk&gt;&lt;/p&gt;
&lt;h2 id=&quot;4&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x574F;&amp;#x7684;ssd&quot;&gt;&lt;a href=&quot;#4&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x574F;&amp;#x7684;ssd&quot; class=&quot;headerlink&quot; title=&quot;4&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x574F;&amp;#x7684;ssd&quot;&gt;&lt;/a&gt;4&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x574F;&amp;#x7684;ssd&lt;/h2&gt;&lt;p&gt;&amp;#x66FF;&amp;#x6362;ssd&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#x662F;&amp;#x5148;&amp;#x4FDD;&amp;#x5B58;&amp;#x6240;&amp;#x6709;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;destroy&amp;#x6389;&amp;#x539F;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x6362;&amp;#x6210;&amp;#x65B0;&amp;#x7684;ssd&amp;#xFF0C;&amp;#x518D;&amp;#x4F7F;&amp;#x7528;&amp;#x4FDD;&amp;#x5B58;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x5173;&amp;#x7CFB;&amp;#x91CD;&amp;#x65B0;&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5BF9;&amp;#x5E94;writethrough&amp;#x548C;writearoud&amp;#x53EF;&amp;#x4EE5;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x5BF9;&amp;#x5E94;writeback&amp;#x6765;&amp;#x8BF4;&amp;#xFF0C;ssd&amp;#x574F;&amp;#x4E86;&amp;#xFF0C;&amp;#x6570;&amp;#x636E;&amp;#x4E5F;&amp;#x4E22;&amp;#x4E86;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x5DF2;&amp;#x7ECF;&amp;#x6570;&amp;#x636E;&amp;#x4E0D;&amp;#x4E00;&amp;#x81F4;&amp;#x4E86;&amp;#xFF0C;&amp;#x5373;&amp;#x4F7F;&amp;#x66FF;&amp;#x6362;&amp;#x4E86;ssd&amp;#x4E5F;&amp;#x4E0D;&amp;#x80FD;&amp;#x633D;&amp;#x56DE;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;group&quot;&gt;&lt;a href=&quot;#5&amp;#xFF09;&amp;#x5220;&amp;#x9664;group&quot; class=&quot;headerlink&quot; title=&quot;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;group&quot;&gt;&lt;/a&gt;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;group&lt;/h2&gt;&lt;p&gt;&amp;#x5220;&amp;#x9664;group&amp;#x5C31;&amp;#x662F;flashcache_destroy&amp;#x5220;&amp;#x9664;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x4EE5;&amp;#x53CA;&amp;#x6E05;&amp;#x7406;&amp;#x76F8;&amp;#x5173;&amp;#x7684;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;3-&amp;#x4EFF;fcg&amp;#x4F7F;&amp;#x7528;flashcache&quot;&gt;&lt;a href=&quot;#3-&amp;#x4EFF;fcg&amp;#x4F7F;&amp;#x7528;flashcache&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x4EFF;fcg&amp;#x4F7F;&amp;#x7528;flashcache&quot;&gt;&lt;/a&gt;3.&amp;#x4EFF;fcg&amp;#x4F7F;&amp;#x7528;flashcache&lt;/h1&gt;&lt;p&gt;&amp;#x5176;&amp;#x5B9E;fcg&amp;#x5B9E;&amp;#x73B0;&amp;#x7684;&amp;#x529F;&amp;#x80FD;&amp;#x4E5F;&amp;#x6BD4;&amp;#x8F83;&amp;#x7B80;&amp;#x5355;&amp;#xFF0C;&amp;#x800C;&amp;#x4E14;&amp;#x4EE3;&amp;#x7801;&amp;#x6709;bug&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x8003;&amp;#x8651;&amp;#x81EA;&amp;#x5DF1;&amp;#x5B9E;&amp;#x73B0;&amp;#x4E00;&amp;#x4E2A;&amp;#x7B80;&amp;#x5355;&amp;#x7684;&amp;#xFF0C;&amp;#x5148;&amp;#x7528;&amp;#x547D;&amp;#x4EE4;&amp;#x5B9E;&amp;#x73B0;&amp;#x6574;&amp;#x4E2A;&amp;#x8FC7;&amp;#x7A0B;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;1PB&amp;#x7684;linear&amp;#x903B;&amp;#x8F91;&amp;#x76D8;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7269;&amp;#x7406;&amp;#x76D8;-dev-vdb&amp;#xFF0C;-dev-vdc&amp;#xFF0C;&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4F7F;&amp;#x7528;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;1PB&amp;#x7684;linear&amp;#x903B;&amp;#x8F91;&amp;#x76D8;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7269;&amp;#x7406;&amp;#x76D8;-dev-vdb&amp;#xFF0C;-dev-vdc&amp;#xFF0C;&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4F7F;&amp;#x7528;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;1PB&amp;#x7684;linear&amp;#x903B;&amp;#x8F91;&amp;#x76D8;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7269;&amp;#x7406;&amp;#x76D8;/dev/vdb&amp;#xFF0C;/dev/vdc&amp;#xFF0C;&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4F7F;&amp;#x7528;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&quot;&gt;&lt;/a&gt;1&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;1PB&amp;#x7684;linear&amp;#x903B;&amp;#x8F91;&amp;#x76D8;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7269;&amp;#x7406;&amp;#x76D8;/dev/vdb&amp;#xFF0C;/dev/vdc&amp;#xFF0C;&amp;#x5269;&amp;#x4E0B;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4F7F;&amp;#x7528;error&amp;#x8BBE;&amp;#x5907;&amp;#x586B;&amp;#x5145;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dmsetup create hdd_group &amp;lt;&amp;lt;EOF&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0 104857600 linear /dev/vdb 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104857600 104857600 linear /dev/vdc 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209715200 2198813540352 error&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EOF&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;2-&amp;#x4F7F;&amp;#x7528;-dev-vde&amp;#x548C;hdd-group&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#2-&amp;#x4F7F;&amp;#x7528;-dev-vde&amp;#x548C;hdd-group&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;2)&amp;#x4F7F;&amp;#x7528;/dev/vde&amp;#x548C;hdd_group&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;2)&amp;#x4F7F;&amp;#x7528;/dev/vde&amp;#x548C;hdd_group&amp;#x521B;&amp;#x5EFA;flashcache&amp;#x8BBE;&amp;#x5907;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# flashcache_create -p back fcdev1 /dev/vde /dev/mapper/hdd_group&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cachedev fcdev1, ssd_devname /dev/vde, disk_devname /dev/mapper/hdd_group cache mode WRITE_BACK&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_size 8, md_block_size 8, cache_size 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Flashcache metadata will use 55MB of your 496MB main memory&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;3-&amp;#x5728;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4F7F;&amp;#x7528;linear&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x4E24;&amp;#x5757;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;a href=&quot;#3-&amp;#x5728;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4F7F;&amp;#x7528;linear&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x4E24;&amp;#x5757;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&quot; class=&quot;headerlink&quot; title=&quot;3)&amp;#x5728;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4F7F;&amp;#x7528;linear&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x4E24;&amp;#x5757;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&quot;&gt;&lt;/a&gt;3)&amp;#x5728;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x4F7F;&amp;#x7528;linear&amp;#x6620;&amp;#x5C04;&amp;#x51FA;&amp;#x4E24;&amp;#x5757;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#echo &amp;quot;0 104857600 linear /dev/mapper/fcdev1 0&amp;quot;|dmsetup create cached_vdb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#echo &amp;quot;0 104857600 linear /dev/mapper/fcdev1 104857600&amp;quot;|dmsetup create cached_vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dmsetup table&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cached_vdc: 0 104857600 linear 252:1 104857600&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cached_vdb: 0 104857600 linear 252:1 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdd_group: 0 104857600 linear 254:16 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdd_group: 104857600 104857600 linear 254:32 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdd_group: 209715200 2198813540352 error&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fcdev1: 0 2199023255552 flashcache conf:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ssd dev (/dev/vde), disk dev (/dev/mapper/hdd_group) cache mode(WRITE_BACK)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; capacity(10198M), associativity(512), data block size(4K) metadata block size(4096b)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; disk assoc(256K)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; skip sequential thresh(0K)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; total blocks(2610688), cached blocks(166), cache percent(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; dirty blocks(0), dirty percent(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; nr_queued(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Size Hist: 4096:258&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;4-&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;-dev-vdf-10G&quot;&gt;&lt;a href=&quot;#4-&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;-dev-vdf-10G&quot; class=&quot;headerlink&quot; title=&quot;4)&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;/dev/vdf,10G&quot;&gt;&lt;/a&gt;4)&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;/dev/vdf,10G&lt;/h2&gt;&lt;p&gt;&amp;#x6DFB;&amp;#x52A0;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x4FEE;&amp;#x6539;hdd_group&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;&amp;#x52A0;&amp;#x5230;&amp;#x4E4B;&amp;#x524D;&amp;#x7684;&amp;#x786C;&amp;#x76D8;&amp;#x4E4B;&amp;#x540E;&lt;br&gt;&amp;#x5907;&amp;#x4EFD;hdd_group&amp;#x7684;dm&amp;#x6620;&amp;#x5C04;&amp;#x8868;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#dmsetup table hdd_group &amp;gt;hdd_group.dm&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x51C6;&amp;#x5907;&amp;#x65B0;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;new.dm&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0 104857600 linear 254:16 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104857600 104857600 linear 254:32 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209715200 20971520 linear /dev/vdf 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230686720 2198792568832 error&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6302;&amp;#x8D77;hdd_group&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x65B0;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x66FF;&amp;#x6362;&amp;#x540E;&amp;#x518D;resume&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#dmsetup suspend hdd_group&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#cat new.dm | dmsetup reload hdd_group&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#dmsetup resume hdd_group&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7136;&amp;#x540E;&amp;#x5728;hdd_group&amp;#x4E0A;&amp;#x521B;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x540C;&amp;#x7B49;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;linear&amp;#x8BBE;&amp;#x5907;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo &amp;quot;0 20971520 linear /dev/mapper/hdd_group 209715200&amp;quot;|dmsetup create cached_vdf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&quot;&gt;&lt;a href=&quot;#5&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&quot; class=&quot;headerlink&quot; title=&quot;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&quot;&gt;&lt;/a&gt;5&amp;#xFF09;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&lt;/h2&gt;&lt;p&gt;&amp;#x4E00;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x628A;&amp;#x8FD9;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x5728;ssd&amp;#x4E2D;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x6570;&amp;#x636E;&amp;#x7ED9;&amp;#x5931;&amp;#x6548;&amp;#x6389;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x5931;&amp;#x6548;&amp;#xFF0C;&amp;#x5728;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x4F1A;&amp;#x62A5;&amp;#x9519;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;io error&amp;#x5E76;&amp;#x4E0D;&amp;#x4F1A;&amp;#x4F7F;&amp;#x8FD9;&amp;#x4E2A;flashcache&amp;#x8BBE;&amp;#x5907;&amp;#x4E0D;&amp;#x53EF;&amp;#x7528;&amp;#xFF0C;&amp;#x53EA;&amp;#x662F;&amp;#x628A;cache&amp;#x91CC;&amp;#x9762;&amp;#x5BF9;&amp;#x5E94;&amp;#x5757;pending&amp;#x7684;io&amp;#x90FD;&amp;#x5E72;&amp;#x6389;&amp;#xFF0C;&amp;#x589E;&amp;#x52A0;&amp;#x70B9;&amp;#x9519;&amp;#x8BEF;&amp;#x7EDF;&amp;#x8BA1;&amp;#x503C;&amp;#xFF0C;&amp;#x5176;&amp;#x4ED6;&amp;#x5565;&amp;#x4E5F;&amp;#x6CA1;&amp;#x5E72;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x53E6;&amp;#x4E00;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;dm zero&amp;#x8BBE;&amp;#x5907;&amp;#x66FF;&amp;#x6362;&amp;#x8FD9;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x4E0D;&amp;#x4F1A;io&amp;#x62A5;&amp;#x9519;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x8BDD;&amp;#xFF0C;&amp;#x65B0;&amp;#x52A0;&amp;#x786C;&amp;#x76D8;&amp;#x5C31;&amp;#x53EA;&amp;#x80FD;&amp;#x5F80;&amp;#x540E;&amp;#x6DFB;&amp;#x52A0;&amp;#xFF0C;1PB&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x6309;&amp;#x6BCF;&amp;#x5757;&amp;#x76D8;2TB&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x653E;50&amp;#x4E2A;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x771F;&amp;#x5230;&amp;#x4E86;&amp;#x4E0D;&amp;#x80FD;&amp;#x518D;&amp;#x653E;&amp;#x65B0;&amp;#x76D8;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#xFF0C;&amp;#x524D;&amp;#x9762;&amp;#x574F;&amp;#x76D8;&amp;#x6240;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7F13;&amp;#x5B58;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x4E5F;&amp;#x65E9;&amp;#x5DF2;&amp;#x7ECF;&amp;#x5237;&amp;#x4E0B;&amp;#x53BB;&amp;#x4E86;&amp;#xFF08;&amp;#x5237;&amp;#x5230;zero&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x524D;&amp;#x9762;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x56E0;&amp;#x4E3A;flashcache&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x63A7;&amp;#x5236;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x5237;&amp;#x7684;&amp;#x673A;&amp;#x5236;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A;&amp;#x662F;&amp;#x6BCF;&amp;#x4E2A;set&amp;#x91CC;&amp;#x7684;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x8D85;&amp;#x8FC7;&amp;#x9608;&amp;#x503C;&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x5237;&amp;#xFF1B;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x662F;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x8FC7;&amp;#x671F;&amp;#x65F6;&amp;#x95F4;(idle)&amp;#x8D85;&amp;#x8FC7;&amp;#x9608;&amp;#x503C;&amp;#xFF08;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;15&amp;#x5206;&amp;#x949F;&amp;#x8FC7;&amp;#x671F;&amp;#xFF09;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x3002;&lt;br&gt;&amp;#x56E0;&amp;#x4E3A;flashcache&amp;#x6709;&amp;#x4E24;&amp;#x4E2A;&amp;#x63A7;&amp;#x5236;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x5237;&amp;#x7684;&amp;#x673A;&amp;#x5236;&amp;#xFF1A;&amp;#x4E00;&amp;#x4E2A;&amp;#x662F;&amp;#x6BCF;&amp;#x4E2A;set&amp;#x91CC;&amp;#x7684;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x8D85;&amp;#x8FC7;&amp;#x9608;&amp;#x503C;&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x5237;&amp;#xFF1B;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x662F;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x8FC7;&amp;#x671F;&amp;#x65F6;&amp;#x95F4;(idle)&amp;#x8D85;&amp;#x8FC7;&amp;#x9608;&amp;#x503C;&amp;#xFF08;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;15&amp;#x5206;&amp;#x949F;&amp;#x8FC7;&amp;#x671F;&amp;#xFF09;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x5237;&amp;#x810F;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x65F6;&amp;#x673A;&amp;#x5206;&amp;#x522B;&amp;#x5BF9;&amp;#x5E94;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570;&amp;#xFF1A;dev.flashcache.\&lt;cachedev&gt;.dirty_thresh_pct&amp;#xFF0C;dev.flashcache.&lt;cachedev&gt;.fallow_delay&amp;#x3002;&lt;br&gt;&amp;#x5177;&amp;#x4F53;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570;&amp;#x7684;&amp;#x89E3;&amp;#x91CA;&amp;#x53C2;&amp;#x8003;&amp;#x5B98;&amp;#x65B9;&amp;#x8BF4;&amp;#x660E;&lt;a href=&quot;https://github.com/facebook/flashcache/blob/master/doc/flashcache-sa-guide.txt&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/facebook/flashcache/blob/master/doc/flashcache-sa-guide.txt&lt;/a&gt;&lt;/cachedev&gt;&lt;/cachedev&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5B9E;&amp;#x9645;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;cached_vdb&amp;#x5EFA;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x6302;&amp;#x8F7D;&amp;#x5230;&amp;#x672C;&amp;#x5730;&amp;#xFF0C;&amp;#x542F;&amp;#x52A8;mysql&amp;#xFF0C;&amp;#x5728;&amp;#x8FD9;&amp;#x5757;&amp;#x76D8;&amp;#x4E0A;&amp;#x8DD1;sysbench&amp;#xFF0C;&amp;#x8D1F;&amp;#x8F7D;&amp;#x4E0D;&amp;#x7528;&amp;#x5F88;&amp;#x9AD8;&amp;#x3002;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x5BF9;cached_vdc&amp;#x7528;fio&amp;#x5199;&amp;#x4E00;&amp;#x6BB5;&amp;#x65F6;&amp;#x95F4;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x540E;&amp;#x505C;&amp;#x6B62;&amp;#x3002;&lt;br&gt;&amp;#x8FD9;&amp;#x65F6;&amp;#x518D;&amp;#x5220;&amp;#x9664;&amp;#x7269;&amp;#x7406;&amp;#x76D8;vdc&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;dm zero&amp;#x8BBE;&amp;#x5907;&amp;#x66FF;&amp;#x6362;&amp;#x4E4B;&amp;#x524D;vdc&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x89C2;&amp;#x5BDF;cached_vdb&amp;#x4E0A;&amp;#x7684;mysql&amp;#xFF0C;sysbench&amp;#x662F;&amp;#x5426;&amp;#x6B63;&amp;#x5E38;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x66FF;&amp;#x6362;&amp;#x6210;zero&amp;#x8BBE;&amp;#x5907;&amp;#x65E0;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x66FF;&amp;#x6362;&amp;#x6210;error&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;sysbench&amp;#x6D4B;&amp;#x8BD5;&amp;#x7684;&amp;#x54CD;&amp;#x5E94;&amp;#x65F6;&amp;#x95F4;&amp;#x4F1A;&amp;#x98D9;&amp;#x5347;&amp;#xFF08;&amp;#x7531;&amp;#x539F;&amp;#x6765;&amp;#x7684;10ms&amp;#x5DE6;&amp;#x53F3;&amp;#x6DA8;&amp;#x5230;&amp;#x51E0;&amp;#x767E;&amp;#x751A;&amp;#x81F3;1000&amp;#x591A;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x5728;&amp;#x8FD9;&amp;#x8303;&amp;#x56F4;&amp;#x5185;&amp;#x6CE2;&amp;#x52A8;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;mysql&amp;#x548C;sysbench&amp;#x90FD;&amp;#x6CA1;&amp;#x6709;&amp;#x51FA;&amp;#x9519;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x4E0B;&amp;#x9762;&amp;#x662F;&amp;#x5220;&amp;#x9664;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#x6B65;&amp;#x9AA4;&amp;#xFF1A;&lt;br&gt;&lt;br&gt;&amp;#x6BD4;&amp;#x5982;&amp;#x9700;&amp;#x8981;&amp;#x5220;&amp;#x9664;&amp;#x7684;&amp;#x76D8;&amp;#x662F;/dev/vdc&amp;#xFF0C;&amp;#x5148;&amp;#x53D6;&amp;#x51FA;cached_vdc&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF08;&amp;#x6700;&amp;#x540E;&amp;#x8981;&amp;#x5220;&amp;#x6389;cached_vdc&amp;#x8FD9;&amp;#x5757;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0 104857600 linear 252:1 104857600&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x5BF9;&amp;#x5E94;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;start offset linear device cachedev_offset&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6839;&amp;#x636E;&amp;#x4EE5;&amp;#x4E0A;&amp;#x4FE1;&amp;#x606F;&amp;#x5728;hdd_group&amp;#x4E2D;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x627E;&amp;#x5230;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x5728;hdd_group&amp;#x4E2D;&amp;#x628A;/dev/vdc&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x90A3;&amp;#x6BB5;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x66FF;&amp;#x6362;&amp;#x6210;error&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&lt;br&gt;&amp;#x66FF;&amp;#x6362;&amp;#x524D;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0 104857600 linear 254:16 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104857600 104857600 linear 254:32 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209715200 20971520 linear 254:80 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230686720 2198792568832 error&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x66FF;&amp;#x6362;&amp;#x540E;&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#x4E3A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;0 104857600 linear 254:16 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104857600 104857600 zero&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;209715200 20971520 linear 254:80 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;230686720 2198792568832 error&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;6&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&quot;&gt;&lt;a href=&quot;#6&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&quot; class=&quot;headerlink&quot; title=&quot;6&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&quot;&gt;&lt;/a&gt;6&amp;#xFF09;&amp;#x66FF;&amp;#x6362;&amp;#x4E00;&amp;#x5757;&amp;#x7269;&amp;#x7406;&amp;#x76D8;&lt;/h2&gt;&lt;p&gt;&amp;#x5148;&amp;#x5220;&amp;#x9664;&amp;#x5F85;&amp;#x66FF;&amp;#x6362;&amp;#x7684;&amp;#x76D8;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x4F7F;&amp;#x7528;&amp;#x65B0;&amp;#x7684;&amp;#x76D8;&amp;#x66FF;&amp;#x6362;&amp;#x65E7;&amp;#x7684;&amp;#x76D8;&amp;#xFF0C;&amp;#x5373;&amp;#x4FEE;&amp;#x6539;hdd_group&amp;#x7684;&amp;#x6620;&amp;#x5C04;&amp;#x8868;&amp;#xFF0C;&amp;#x4E0D;&amp;#x8FC7;&amp;#x65B0;&amp;#x7684;&amp;#x76D8;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#x4E0D;&amp;#x80FD;&amp;#x5927;&amp;#x4E8E;&amp;#x65E7;&amp;#x76D8;&amp;#xFF0C;&amp;#x4E0D;&amp;#x7136;&amp;#x5C31;&amp;#x53EA;&amp;#x80FD;&amp;#x6620;&amp;#x5C04;&amp;#x65E7;&amp;#x76D8;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x5927;&amp;#x5C0F;&amp;#x3002;&lt;br&gt;&amp;#x5982;&amp;#x679C;&amp;#x65B0;&amp;#x76D8;&amp;#x5C0F;&amp;#x4E8E;&amp;#x65E7;&amp;#x76D8;&amp;#x7684;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x66FF;&amp;#x6362;&amp;#x540E;&amp;#x7684;hdd_group&amp;#x4E2D;&amp;#x95F4;&amp;#x5C31;&amp;#x4F1A;&amp;#x6709;&amp;#x7A7A;&amp;#x6D1E;&amp;#xFF0C;&amp;#x4E0D;&amp;#x4FBF;&amp;#x4E8E;&amp;#x7BA1;&amp;#x7406;&amp;#x3002;&lt;br&gt;&amp;#x6240;&amp;#x4EE5;&amp;#x6700;&amp;#x597D;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x76F8;&amp;#x540C;&amp;#x5BB9;&amp;#x91CF;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x76D8;&amp;#x8FDB;&amp;#x884C;&amp;#x66FF;&amp;#x6362;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;flashcachegroup&amp;#x80FD;&amp;#x591F;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x5757;&amp;#x6216;&amp;#x591A;&amp;#x5757;ssd&amp;#x6765;&amp;#x7F13;&amp;#x5B58;&amp;#x4E00;&amp;#x7EC4;hdd&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;&amp;#x786C;&amp;#x76D8;&amp;#x7EC4;&amp;#x80FD;&amp;#x591F;&amp;#x52A8;&amp;#x6001;&amp;#x589E;&amp;#x52A0;&amp;#x5220;&amp;#x9664;&amp;#x786C;&amp;#x76D8;&amp;#xFF0C;ssd&amp;#x7F13;&amp;#x5B58;&amp;#x80FD;&amp;#x591F;&amp;#x6574;&amp;#x4E2A;&amp;#x786C;&amp;#x76D8;&amp;#x7EC4;&amp;#x800C;&amp;#x4E0D;&amp;#x4EC5;&amp;#x4EC5;&amp;#x662F;&amp;#x4E00;&amp;#x5757;&amp;#x786C;&amp;#x76D8;&amp;#x3002;&lt;br&gt;&amp;#x5176;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x4E0B;&amp;#xFF0C;&amp;#x53C2;&amp;#x8003;&amp;#x5B98;&amp;#x65B9;&amp;#x8BF4;&amp;#x660E;&lt;a href=&quot;https://github.com/lihuiba/flashcachegroup&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;&amp;#x4ECB;&amp;#x7ECD;&amp;#x91CC;&amp;#x7684;&amp;#x7ED3;&amp;#x6784;&amp;#x56FE;&quot;&gt;https://github.com/lihuiba/flashcachegroup&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x501F;&amp;#x7528;&amp;#x4ECB;&amp;#x7ECD;&amp;#x91CC;&amp;#x7684;&amp;#x7ED3;&amp;#x6784;&amp;#x56FE;&lt;/a&gt;.&lt;br&gt;&lt;img src=&quot;/2016/05/05/flashcachegroup/fcg.png&quot; alt=&quot;fcg&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;1-&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot;&gt;&lt;a href=&quot;#1-&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&quot;&gt;&lt;/a&gt;1.&amp;#x5B89;&amp;#x88C5;&amp;#x4F7F;&amp;#x7528;flashcachegroup&lt;/h1&gt;&lt;h2 id=&quot;1&amp;#xFF09;-&amp;#x5B89;&amp;#x88C5;flashcache&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;-&amp;#x5B89;&amp;#x88C5;flashcache&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09; &amp;#x5B89;&amp;#x88C5;flashcache&quot;&gt;&lt;/a&gt;1&amp;#xFF09; &amp;#x5B89;&amp;#x88C5;flashcache&lt;/h2&gt;&lt;p&gt;&amp;#x9996;&amp;#x5148;&amp;#x9700;&amp;#x8981;&amp;#x5B89;&amp;#x88C5;flashcache&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x4F7F;&amp;#x7528;&amp;#x6E90;&amp;#x7801;&amp;#x5B89;&amp;#x88C5;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git clone https://github.com/facebook/flashcache.git&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#cd flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5207;&amp;#x6362;&amp;#x5230;&amp;#x7A33;&amp;#x5B9A;&amp;#x7248;stable_v3.1.1&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#git checkout stable_v3.1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;flashcache&amp;#x7F16;&amp;#x8BD1;&amp;#x9700;&amp;#x8981;&amp;#x4F9D;&amp;#x8D56;KERNE_TREE&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#make KERNEL_TREE=/usr/src/linux-headers-3.10.11-openstack-amd64/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#make install&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x52A0;&amp;#x8F7D;flashcache&amp;#x6A21;&amp;#x5757;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#modprobe flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#lsmod | grep flashcache&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
  </entry>
  
  <entry>
    <title>sheepdog中的erasure code实现机制</title>
    <link href="http://yoursite.com/2016/05/05/sheepdog-erasure-code/"/>
    <id>http://yoursite.com/2016/05/05/sheepdog-erasure-code/</id>
    <published>2016-05-05T03:13:25.000Z</published>
    <updated>2016-05-05T03:30:19.512Z</updated>
    
    <content type="html">&lt;h1 id=&quot;1-&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;1.&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;Erasure Coding(EC) &amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x5197;&amp;#x4F59;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x7EA0;&amp;#x5220;&amp;#x7801;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5197;&amp;#x4F59;&amp;#x5EA6;&amp;#x66F4;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5E76;&amp;#x80FD;&amp;#x83B7;&amp;#x5F97;&amp;#x66F4;&amp;#x9AD8;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x53EF;&amp;#x9760;&amp;#x6027;&amp;#x3002;&amp;#x7EA0;&amp;#x5220;&amp;#x7801;&amp;#x5305;&amp;#x542B;&amp;#x4E24;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x7F16;&amp;#x7801;&amp;#x548C;&amp;#x89E3;&amp;#x7801;&amp;#x3002;&amp;#x7F16;&amp;#x7801;&amp;#x65F6;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x4E9B;&amp;#x6570;&amp;#x636E;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x8BA1;&amp;#x7B97;&amp;#x51FA;&amp;#x4E00;&amp;#x4E9B;&amp;#x6821;&amp;#x9A8C;&amp;#x6570;&amp;#x636E;&amp;#xFF1B;&amp;#x5F53;&amp;#x6709;&amp;#x6570;&amp;#x636E;&amp;#x4E22;&amp;#x5931;&amp;#x65F6;&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x4F7F;&amp;#x7528;&amp;#x4F59;&amp;#x4E0B;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF08;&amp;#x6E90;&amp;#x6570;&amp;#x636E;&amp;#x548C;&amp;#x6821;&amp;#x9A8C;&amp;#x6570;&amp;#x636E;&amp;#xFF09;&amp;#x89E3;&amp;#x7801;&amp;#x51FA;&amp;#x4E22;&amp;#x5931;&amp;#x7684;&amp;#x90E8;&amp;#x5206;&amp;#x3002;sheepdog&amp;#x4E2D;&amp;#x4E5F;&amp;#x63D0;&amp;#x4F9B;&amp;#x4E86;EC&amp;#x7684;&amp;#x652F;&amp;#x6301;&amp;#x3002;&amp;#x6BD4;&amp;#x5982;&amp;#x4F7F;&amp;#x7528;8:3&amp;#x7684;&amp;#x7EA0;&amp;#x5220;&amp;#x7B56;&amp;#x7565;&amp;#xFF08;8&amp;#x5757;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#xFF0C;3&amp;#x5757;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#xFF09;&amp;#xFF0C;sheepdog&amp;#x5C31;&amp;#x80FD;&amp;#x591F;&amp;#x5BB9;&amp;#x9519;3&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5B95;&amp;#x6389;&amp;#xFF0C;&amp;#x4EC5;&amp;#x4EC5;&amp;#x53EA;&amp;#x6709;3/8=0.375&amp;#x500D;&amp;#x7684;&amp;#x989D;&amp;#x5916;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x800C;&amp;#x8981;&amp;#x8FBE;&amp;#x5230;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x6548;&amp;#x679C;&amp;#xFF0C;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#x5374;&amp;#x9700;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;4&amp;#x526F;&amp;#x672C;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x5E26;&amp;#x6765;&amp;#x4E86;&amp;#x989D;&amp;#x5916;3&amp;#x500D;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5F00;&amp;#x9500;&amp;#x3002;sheepdog&amp;#x4E2D;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;Erasure Code&amp;#x7684;&amp;#x5F00;&amp;#x6E90;&amp;#x5E93;zfec&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot;&gt;&lt;a href=&quot;#2-sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot; class=&quot;headerlink&quot; title=&quot;2.sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot;&gt;&lt;/a&gt;2.sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;1&amp;#xFF09;&amp;#x4E00;&amp;#x65E6;&amp;#x6307;&amp;#x5B9A;&amp;#x4E86;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x8BFB;&amp;#x5199;&amp;#x6570;&amp;#x636E;&amp;#x65F6;&amp;#x81EA;&amp;#x52A8;&amp;#x5730;&amp;#x4F7F;&amp;#x7528;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x989D;&amp;#x5916;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;2&amp;#xFF09;&amp;#x652F;&amp;#x6301;&amp;#x968F;&amp;#x673A;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x5C31;&amp;#x5730;&amp;#x66F4;&amp;#x65B0;&amp;#xFF0C;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;3&amp;#xFF09;&amp;#x652F;&amp;#x6301;&amp;#x4EFB;&amp;#x610F;&amp;#x7C7B;&amp;#x578B;&amp;#x7684;VM&amp;#x955C;&amp;#x50CF;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;4&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;VDI&amp;#x65F6;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x53EF;&amp;#x4EE5;&amp;#x81EA;&amp;#x5B9A;&amp;#x4E49;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;5&amp;#xFF09;&amp;#x76F8;&amp;#x5BF9;&amp;#x4E8E;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;EC&amp;#x80FD;&amp;#x591F;&amp;#x83B7;&amp;#x5F97;&amp;#x66F4;&amp;#x597D;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#x6027;&amp;#x80FD;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;6&amp;#xFF09;&amp;#x4E00;&amp;#x4E2A;&amp;#x96C6;&amp;#x7FA4;&amp;#x4E2D;&amp;#x65E2;&amp;#x80FD;&amp;#x6709;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7684;&amp;#x5377;&amp;#xFF0C;&amp;#x4E5F;&amp;#x80FD;&amp;#x6709;EC&amp;#x7684;&amp;#x5377;&amp;#x3002;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;3-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;a href=&quot;#3-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;/a&gt;3.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&lt;/h1&gt;&lt;p&gt;&amp;#x7528;&amp;#x6237;&amp;#x521B;&amp;#x5EFA;VDI&amp;#xFF08;&amp;#x865A;&amp;#x62DF;&amp;#x5377;&amp;#xFF09;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5B9A;EC&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;br&gt;$dogvdi create -c x:y vdi size # Create a erasure coded VDI&lt;br&gt;x&amp;#x8868;&amp;#x793A;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;x&amp;#x53EA;&amp;#x80FD;&amp;#x662F;{2,4,8,16}&amp;#xFF0C;y&amp;#x8868;&amp;#x793A;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;y&amp;#x53EF;&amp;#x4EE5;&amp;#x53D6;&amp;#x503C;1~15&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x5BB9;&amp;#x9519;y&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5B95;&amp;#x6389;&amp;#x3002;&lt;br&gt;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8282;&amp;#x70B9;&amp;#x4E2A;&amp;#x6570;&amp;#x5C0F;&amp;#x4E8E;x+y&amp;#xFF0C;&amp;#x6307;&amp;#x5B9A;&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x5C06;&amp;#x4F1A;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&lt;br&gt;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x96C6;&amp;#x7FA4;&amp;#x65F6;&amp;#xFF0C;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;EC&amp;#x4F5C;&amp;#x4E3A;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;br&gt;$ dog cluster format -c x:y&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;4-&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&quot;&gt;&lt;a href=&quot;#4-&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&quot; class=&quot;headerlink&quot; title=&quot;4.&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&quot;&gt;&lt;/a&gt;4.&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&lt;/h1&gt;&lt;p&gt;sheepdog&amp;#x4E2D;&amp;#x7684;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x5BF9;&amp;#x8C61;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;4M&amp;#xFF08;&amp;#x5BF9;&amp;#x5E94;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x7684;SD_DATA_OBJ_SIZE&amp;#xFF09;&amp;#xFF0C;&amp;#x5728;&amp;#x5404;&amp;#x4E2A;&amp;#x5B58;&amp;#x50A8;&amp;#x8282;&amp;#x70B9;&amp;#x7684;&amp;#x672C;&amp;#x5730;&amp;#x76EE;&amp;#x5F55;&amp;#x4E0B;&amp;#x5B58;&amp;#x7684;&amp;#x5BF9;&amp;#x8C61;&amp;#x90FD;&amp;#x662F;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x3002;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#x4E0B;&amp;#x7684;&amp;#xFF08;&amp;#x793A;&amp;#x4F8B;&amp;#x662F;3&amp;#x526F;&amp;#x672C;&amp;#xFF09;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/05/sheepdog-erasure-code/data_place.png&quot; alt=&quot;data_place&quot;&gt;&lt;br&gt;&amp;#x91C7;&amp;#x7528;Erasure code&amp;#x540E;&amp;#xFF0C;&amp;#x5377;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5206;&amp;#x5E03;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/05/05/sheepdog-erasure-code/data_place_ec.png&quot; alt=&quot;data_place_ec&quot;&gt;&lt;br&gt;EC&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x4E3A;X&amp;#xFF1A;Y&amp;#xFF0C;&amp;#x56FE;&amp;#x4E0A;&amp;#x793A;&amp;#x4F8B;&amp;#x662F;4:2&amp;#xFF0C;&amp;#x5373;4&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#xFF0C;2&amp;#x4E2A;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#xFF0C;&amp;#x5BF9;&amp;#x5E94;&amp;#x5377;&amp;#x7684;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x662F;&amp;#x5206;&amp;#x5E03;&amp;#x5230;x+y&amp;#xFF08;&amp;#x56FE;&amp;#x4E0A;&amp;#x4E3A;6&amp;#xFF09;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x7684;EC&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;4MB/X&amp;#xFF08;&amp;#x793A;&amp;#x4F8B;&amp;#x4E2D;&amp;#x662F;1MB&amp;#xFF09;&amp;#x3002;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;4:2&amp;#x7B56;&amp;#x7565;&amp;#x4E0B;&amp;#x5728;&amp;#x5404;&amp;#x8282;&amp;#x70B9;&amp;#x672C;&amp;#x5730;&amp;#x5B58;&amp;#x7684;EC&amp;#x5377;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x5927;&amp;#x5C0F;&amp;#x662F;1M&amp;#x3002;EC&amp;#x5757;&amp;#x7684;&amp;#x5206;&amp;#x5E03;&amp;#x7B56;&amp;#x7565;&amp;#x4E0E;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x65F6;&amp;#x5404;&amp;#x526F;&amp;#x672C;&amp;#x7684;&amp;#x5206;&amp;#x5E03;&amp;#x7B56;&amp;#x7565;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;&amp;#x90FD;&amp;#x662F;&amp;#x91C7;&amp;#x7528;&amp;#x4E00;&amp;#x81F4;&amp;#x6027;&amp;#x54C8;&amp;#x5E0C;&amp;#x7684;&amp;#x5206;&amp;#x5E03;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x56FE;&amp;#x4E0A;&amp;#x53EA;&amp;#x662F;&amp;#x753B;&amp;#x4E86;6&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;&amp;#x5927;&amp;#x4E8E;6&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x65F6;&amp;#xFF0C;EC&amp;#x7684;6&amp;#x4E2A;&amp;#x5757;&amp;#x5C31;&amp;#x4F1A;&amp;#x5206;&amp;#x5E03;&amp;#x5230;&amp;#x8FD9;&amp;#x4E9B;&amp;#x8282;&amp;#x70B9;&amp;#x4E2D;&amp;#x7684;6&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;&amp;#x5B9E;&amp;#x73B0;&amp;#x65F6;&amp;#xFF0C;&amp;#x662F;&amp;#x5207;&amp;#x5206;&amp;#x6210;&amp;#x66F4;&amp;#x7EC6;&amp;#x7684;&amp;#x7C92;&amp;#x5EA6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x5F15;&amp;#x5165;&amp;#x51E0;&amp;#x4E2A;&amp;#x6982;&amp;#x5FF5;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;EC OBJ&amp;#xFF1A;EC&amp;#x7684;&amp;#x5BF9;&amp;#x8C61;&amp;#x5757;&amp;#xFF08;&amp;#x793A;&amp;#x4F8B;&amp;#x4E2D;&amp;#x662F;1M&amp;#x5927;&amp;#x5C0F;&amp;#xFF09;&amp;#xFF0C;&amp;#x4E00;&amp;#x4E2A;EC OBJ&amp;#x7684;&amp;#x547D;&amp;#x540D;&amp;#x662F;&amp;#x4EE5;OBJ&amp;#x7684;id&amp;#xFF08;oid&amp;#xFF09;&amp;#x52A0;&amp;#x4E0A;index&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&amp;#x4E00;&amp;#x4E2A;oid&amp;#x662F; 007c2b2500000001&amp;#xFF0C;&amp;#x5219;EC OBJ&amp;#x662F;&amp;#x547D;&amp;#x540D;&amp;#x4E3A; 007c2b2500000001_1&amp;#x7684;&amp;#x5F62;&amp;#x5F0F;&amp;#x3002;&lt;/li&gt;
&lt;li&gt;stripe&amp;#xFF1A;&amp;#x6A2A;&amp;#x8DE8;&amp;#x591A;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x7684;EC&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;&amp;#x6761;&amp;#x5E26;&amp;#xFF0C;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;SD_EC_DATA_STRIPE_SIZE&amp;#xFF08;=1k&amp;#xFF09;&lt;/li&gt;
&lt;li&gt;strip&amp;#xFF1A;&amp;#x7EC4;&amp;#x6210;stripe&amp;#x7684;&amp;#x57FA;&amp;#x672C;&amp;#x5355;&amp;#x5143;&amp;#xFF0C;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;SD_EC_DATA_STRIPE_SIZE/X&amp;#xFF08;X&amp;#x4E3A;EC&amp;#x7B56;&amp;#x7565;X&amp;#xFF1A;Y&amp;#x4E2D;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x4E2A;&amp;#x6570;&amp;#xFF09;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;VDI&amp;#x7684;&amp;#x4E00;&amp;#x4E2A;4M&amp;#x7684;&amp;#x7A7A;&amp;#x95F4;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x662F;&amp;#x5206;&amp;#x5E03;&amp;#x5230;&amp;#x591A;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x7684;EC OBJ&amp;#x5171;&amp;#x540C;&amp;#x63D0;&amp;#x4F9B;&amp;#x7684;&amp;#x3002;&amp;#x4E86;&amp;#x89E3;raid&amp;#x7684;&amp;#x4EBA;&amp;#x5E94;&amp;#x8BE5;&amp;#x4E0D;&amp;#x96BE;&amp;#x7406;&amp;#x89E3;&amp;#xFF0C;&amp;#x5C31;&amp;#x8DDF;raid5/6&amp;#x4E2D;&amp;#x5757;&amp;#x5206;&amp;#x5E03;&amp;#x5230;&amp;#x591A;&amp;#x4E2A;&amp;#x78C1;&amp;#x76D8;&amp;#x7C7B;&amp;#x4F3C;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/05/sheepdog-erasure-code/stripe.png&quot; alt=&quot;stripe&quot;&gt;&lt;br&gt;&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x662F;1K&amp;#x800C;&amp;#x4E0D;&amp;#x662F;&amp;#x5176;&amp;#x4ED6;&amp;#x5927;&amp;#x5C0F;&amp;#x5462;&amp;#xFF1F;&lt;br&gt;&lt;br&gt;&amp;#x4ECE;&amp;#x793E;&amp;#x533A;&amp;#x53CA;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x5F97;&amp;#x77E5;&amp;#xFF0C;&amp;#x8BBE;&amp;#x5B9A;stripe&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;1K&amp;#x662F;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E86;&amp;#x4E00;&amp;#x4E9B;&amp;#x6D4B;&amp;#x8BD5;&amp;#x786E;&amp;#x5B9A;&amp;#x7684;&amp;#xFF0C;stripe&amp;#x5C0F;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;1k&amp;#x5BF9;&amp;#x4E8E;&amp;#x8FD0;&amp;#x884C;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x6765;&amp;#x8BF4;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B89;&amp;#x5168;&amp;#x7684;&amp;#x503C;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x5C3D;&amp;#x7BA1;&amp;#x5927;&amp;#x591A;&amp;#x6570;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7684;&amp;#x6587;&amp;#x4EF6;&amp;#x7CFB;&amp;#x7EDF;&amp;#x90FD;&amp;#x662F;&amp;#x5904;&amp;#x7406;4K&amp;#x7684;&amp;#x5757;&amp;#xFF0C;&amp;#x6709;&amp;#x4E9B;&amp;#x8F6F;&amp;#x4EF6;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;grub&amp;#x5C31;&amp;#x4F1A;&amp;#x64CD;&amp;#x4F5C;512&amp;#x5B57;&amp;#x8282;&amp;#xFF0C;linux&amp;#x5185;&amp;#x6838;&amp;#x672C;&amp;#x8EAB;&amp;#x4E5F;&amp;#x5076;&amp;#x5C14;&amp;#x4F1A;&amp;#x64CD;&amp;#x4F5C;1K&amp;#x7684;&amp;#x5757;&amp;#x3002;&lt;br&gt;&lt;br&gt;&amp;#x7ECF;&amp;#x8FC7;&amp;#x4E00;&amp;#x4E9B;&amp;#x6D4B;&amp;#x8BD5;&amp;#x8BA4;&amp;#x4E3A;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x60F3;&amp;#x5728;&amp;#x91C7;&amp;#x7528;EC&amp;#x7B56;&amp;#x7565;&amp;#x7684;&amp;#x5377;&amp;#x4E0A;&amp;#x8FD0;&amp;#x884C;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#xFF0C;1K&amp;#x662F;&amp;#x53EF;&amp;#x9009;&amp;#x62E9;&amp;#x7684;&amp;#x6700;&amp;#x5927;&amp;#x503C;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;5-&amp;#x8BFB;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;a href=&quot;#5-&amp;#x8BFB;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&quot; class=&quot;headerlink&quot; title=&quot;5.&amp;#x8BFB;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;/a&gt;5.&amp;#x8BFB;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x5904;&amp;#x7406;&lt;/h1&gt;&lt;p&gt;sheepdog&amp;#x4F7F;&amp;#x7528;&amp;#x7684;EC&amp;#x652F;&amp;#x6301;&amp;#x5BF9;&amp;#x9F50;&amp;#x548C;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x5BF9;&amp;#x9F50;&amp;#x662F;&amp;#x6307;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x504F;&amp;#x79FB;&amp;#x548C;&amp;#x5927;&amp;#x5C0F;&amp;#x90FD;&amp;#x4EE5;SD_EC_DATA_STRIPE_SIZE&amp;#x7684;&amp;#x5927;&amp;#x5C0F;1k&amp;#x4E3A;&amp;#x5BF9;&amp;#x9F50;&amp;#x3002;&lt;br&gt;&amp;#x5728;&amp;#x5904;&amp;#x7406;&amp;#x4E0A;&amp;#x5C42;&amp;#x5230;&amp;#x6765;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x65F6;&amp;#xFF0C;sheepdog&amp;#x662F;&amp;#x6309;&amp;#x7167;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x6765;&amp;#x5904;&amp;#x7406;&amp;#x7684;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#x4E0D;&amp;#x5927;&amp;#x4E8E;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;sheepdog&amp;#x8FD9;&amp;#x91CC;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF08;&amp;#x6BCF;&amp;#x4E2A;&amp;#x6570;&amp;#x636E;&amp;#x8BFB;&amp;#x5199;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6709;&amp;#x4E2A;oid&amp;#xFF0C;&amp;#x8868;&amp;#x793A;&amp;#x6570;&amp;#x636E;&amp;#x5BF9;&amp;#x8C61;&amp;#x7684;id&amp;#xFF09;&amp;#xFF0C;&amp;#x5927;&amp;#x4E8E;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x5728;&amp;#x5BA2;&amp;#x6237;&amp;#x7AEF;&amp;#x5C31;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x591A;&amp;#x4E2A;4M&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&amp;#x800C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6BCF;&amp;#x4E2A;4M&amp;#x5185;&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x6839;&amp;#x636E;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x504F;&amp;#x79FB;&amp;#x548C;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x6309;&amp;#x7167;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x591A;&amp;#x4E2A;&amp;#x5C0F;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x53D1;&amp;#x5230;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x53BB;&amp;#x8FDB;&amp;#x884C;&amp;#x8BFB;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E9B;&amp;#x5C0F;&amp;#x8BF7;&amp;#x6C42;&amp;#x90FD;&amp;#x6210;&amp;#x529F;&amp;#x540E;&amp;#x624D;&amp;#x7B97;&amp;#x6210;&amp;#x529F;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;1&amp;#xFF09;&amp;#x5BF9;&amp;#x9F50;&amp;#x65B9;&amp;#x5F0F;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;a href=&quot;#1&amp;#xFF09;&amp;#x5BF9;&amp;#x9F50;&amp;#x65B9;&amp;#x5F0F;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot; class=&quot;headerlink&quot; title=&quot;1&amp;#xFF09;&amp;#x5BF9;&amp;#x9F50;&amp;#x65B9;&amp;#x5F0F;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;/a&gt;1&amp;#xFF09;&amp;#x5BF9;&amp;#x9F50;&amp;#x65B9;&amp;#x5F0F;&amp;#x7684;&amp;#x5904;&amp;#x7406;&lt;/h2&gt;&lt;p&gt;&amp;#x4EE5;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E3A;&amp;#x4F8B;&amp;#x8FDB;&amp;#x884C;&amp;#x8BF4;&amp;#x660E;&amp;#xFF0C;&amp;#x8BE5;&amp;#x8BF7;&amp;#x6C42;offset&amp;#x4E3A;0&amp;#xFF08;&amp;#x521A;&amp;#x597D;&amp;#x5BF9;&amp;#x9F50;&amp;#x5230;&amp;#x67D0;&amp;#x4E2A;4M&amp;#x7684;&amp;#x8D77;&amp;#x59CB;&amp;#x4F4D;&amp;#x7F6E;&amp;#xFF09;&amp;#xFF0C;len&amp;#x4E3A;3K.&lt;br&gt;&lt;img src=&quot;/2016/05/05/sheepdog-erasure-code/align.png&quot; alt=&quot;align&quot;&gt;&lt;br&gt;&amp;#x8BE5;&amp;#x8BF7;&amp;#x6C42;&amp;#x88AB;&amp;#x62C6;&amp;#x5206;&amp;#x4E3A;6&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5206;&amp;#x522B;&amp;#x53BB;&amp;#x5BF9;&amp;#x5E94;&amp;#x8282;&amp;#x70B9;&amp;#x4E0A;&amp;#x53BB;&amp;#x8BFB;&amp;#x5199;&amp;#x76F8;&amp;#x5E94;&amp;#x7684;EC OBJ&amp;#x3002;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#x662F;&amp;#x5199;&amp;#x6210;&amp;#x529F;&amp;#x5C31;&amp;#x5B8C;&amp;#x4E86;&amp;#xFF0C;&amp;#x800C;&amp;#x8BFB;&amp;#x8BF7;&amp;#x6C42;&amp;#x9700;&amp;#x8981;&amp;#x628A;&amp;#x5404;&amp;#x81EA;&amp;#x8BFB;&amp;#x5230;&amp;#x7684;&amp;#x5185;&amp;#x5BB9;&amp;#x6309;&amp;#x7167;&amp;#x56FE;&amp;#x4E0A;&amp;#x7BAD;&amp;#x5934;&amp;#x7684;&amp;#x9006;&amp;#x8FC7;&amp;#x7A0B;&amp;#x62F7;&amp;#x8D1D;&amp;#x5230;&amp;#x7528;&amp;#x6237;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x7F13;&amp;#x51B2;&amp;#x533A;&amp;#x4E2D;&amp;#x3002;&amp;#x56FE;&amp;#x4E2D;&amp;#x6CA1;&amp;#x6709;&amp;#x533A;&amp;#x5206;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x548C;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#xFF0C;&amp;#x5176;&amp;#x5B9E;&amp;#x662F;&amp;#x6709;EC&amp;#x7684;&amp;#x7F16;&amp;#x7801;&amp;#x8FC7;&amp;#x7A0B;&amp;#x7684;&amp;#xFF08;&amp;#x6839;&amp;#x636E;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x7F16;&amp;#x7801;&amp;#x51FA;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#xFF09;&amp;#xFF0C;&amp;#x56FE;&amp;#x4E0A;&amp;#x5FFD;&amp;#x7565;&amp;#x4E86;&amp;#x8FD9;&amp;#x4E2A;&amp;#x8FC7;&amp;#x7A0B;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;2&amp;#xFF09;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;a href=&quot;#2&amp;#xFF09;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot; class=&quot;headerlink&quot; title=&quot;2&amp;#xFF09;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;/a&gt;2&amp;#xFF09;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5904;&amp;#x7406;&lt;/h2&gt;&lt;p&gt;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x8BFB;&amp;#x8BF7;&amp;#x6C42;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#x4E0E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x6CA1;&amp;#x6709;&amp;#x533A;&amp;#x522B;&amp;#x3002;&lt;br&gt;&amp;#x4F46;&amp;#x662F;&amp;#x5BF9;&amp;#x4E8E;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5199;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x5148;&amp;#x628A;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x90A3;&amp;#x4E2A;stripe&amp;#x8BFB;&amp;#x51FA;&amp;#x6765;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x9700;&amp;#x8981;&amp;#x8BA1;&amp;#x7B97;&amp;#x6821;&amp;#x9A8C;&amp;#x3002;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x6709;&amp;#x53EF;&amp;#x80FD;&amp;#x662F;&amp;#x504F;&amp;#x79FB;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x8BF7;&amp;#x6C42;&amp;#x5927;&amp;#x5C0F;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x4E24;&amp;#x8005;&amp;#x90FD;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#x3002;&amp;#x8FD9;&amp;#x91CC;&amp;#x4EE5;&amp;#x8BF7;&amp;#x6C42;&amp;#x5927;&amp;#x5C0F;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#x4E3A;&amp;#x4F8B;&amp;#x3002;&amp;#x8BF7;&amp;#x6C42;&amp;#x76F8;&amp;#x5BF9;&amp;#x504F;&amp;#x79FB;&amp;#x4E3A;0&amp;#xFF0C;&amp;#x8BF7;&amp;#x6C42;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;2560Byte&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/05/sheepdog-erasure-code/not_align.png&quot; alt=&quot;not_align&quot;&gt;&lt;br&gt;&amp;#x5148;&amp;#x8BFB;&amp;#x51FA;&amp;#x672A;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;stripe&amp;#xFF0C;&amp;#x548C;&amp;#x5F85;&amp;#x5199;&amp;#x6570;&amp;#x636E;&amp;#x4E00;&amp;#x8D77;&amp;#x7ECF;&amp;#x8FC7;EC&amp;#x7F16;&amp;#x7801;&amp;#x540E;&amp;#xFF0C;&amp;#x518D;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x591A;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x53D1;&amp;#x5230;&amp;#x5404;&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#x3002;&lt;br&gt;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x5199;&amp;#x6709;&amp;#x989D;&amp;#x5916;&amp;#x7684;&amp;#x8BFB;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x4F1A;&amp;#x8BFB;&amp;#x5199;&amp;#x6027;&amp;#x80FD;&amp;#x6709;&amp;#x6240;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x662F;&amp;#x4E0D;&amp;#x5EFA;&amp;#x8BAE;&amp;#x4F7F;&amp;#x7528;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;io&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;3&amp;#xFF09;&amp;#x9519;&amp;#x8BEF;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;a href=&quot;#3&amp;#xFF09;&amp;#x9519;&amp;#x8BEF;&amp;#x5904;&amp;#x7406;&quot; class=&quot;headerlink&quot; title=&quot;3&amp;#xFF09;&amp;#x9519;&amp;#x8BEF;&amp;#x5904;&amp;#x7406;&quot;&gt;&lt;/a&gt;3&amp;#xFF09;&amp;#x9519;&amp;#x8BEF;&amp;#x5904;&amp;#x7406;&lt;/h2&gt;&lt;p&gt;&amp;#x91C7;&amp;#x7528;erasure code&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;1&amp;#x4E2A;&amp;#x6216;&amp;#x591A;&amp;#x4E2A;&amp;#x5199;&amp;#x5165;&amp;#x5931;&amp;#x8D25;&amp;#x4E86;&amp;#x65F6;&amp;#x5982;&amp;#x4F55;&amp;#x5904;&amp;#x7406;&amp;#xFF1F;&lt;br&gt;&lt;br&gt;&amp;#x5047;&amp;#x8BBE;&amp;#x603B;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x6570;&amp;#x4E3A;n&amp;#xFF0C;ec&amp;#x7B56;&amp;#x7565;&amp;#x4E3A;x&amp;#xFF1A;y&amp;#xFF0C;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#x7528;fio&amp;#x8DD1;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;kill&amp;#x6740;&amp;#x6389;&amp;#x51E0;&amp;#x4E2A;sheep&amp;#x8282;&amp;#x70B9;&amp;#x8FDB;&amp;#x7A0B;&amp;#xFF0C;&amp;#x4ECE;log&amp;#x4E2D;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;&amp;#x6709;&amp;#x5931;&amp;#x8D25;&amp;#x7684;&amp;#x4FE1;&amp;#x606F;&amp;#xFF0C;&amp;#x4F46;&amp;#x662F;fio&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x62A5;&amp;#x9519;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x8FD8;&amp;#x6D3B;&amp;#x7740;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x6570;&amp;#x5927;&amp;#x4E8E;&amp;#x7B49;&amp;#x4E8E;x&amp;#xFF0C;&amp;#x5C31;&amp;#x8FD8;&amp;#x80FD;&amp;#x7EE7;&amp;#x7EED;&amp;#x5199;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;&amp;#x8BF4;&amp;#xFF0C;&amp;#x5199;&amp;#x5931;&amp;#x8D25;&amp;#x4E86;&amp;#x4F1A;&amp;#x91CD;&amp;#x8BD5;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6D3B;&amp;#x7740;&amp;#x7684;&amp;#x8282;&amp;#x70B9;&amp;#x6570;&amp;#x5C0F;&amp;#x4E8E;x&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5C31;&amp;#x4F1A;&amp;#x76F4;&amp;#x63A5;io &amp;#x62A5;&amp;#x9519;&amp;#x4E86;&amp;#x3002;&lt;br&gt;&lt;br&gt;erasure&amp;#x7684;&amp;#x8BFB;&amp;#x5931;&amp;#x8D25;&amp;#x65F6;&amp;#xFF0C;&amp;#x4E5F;&amp;#x4F1A;&amp;#x91CD;&amp;#x8BD5;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x8282;&amp;#x70B9;&amp;#x6302;&amp;#x4E86;&amp;#x5F15;&amp;#x8D77;&amp;#x7684;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E2A;&amp;#x91CD;&amp;#x8BD5;&amp;#x7684;&amp;#x8BFB;&amp;#x4F1A;&amp;#x7B49;&amp;#x5230;&amp;#x8BE5;data strip&amp;#x6062;&amp;#x590D;&amp;#x540E;&amp;#x624D;&amp;#x80FD;&amp;#x591F;&amp;#x8BFB;&amp;#x6210;&amp;#x529F;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;a href=&quot;#1-&amp;#x7B80;&amp;#x4ECB;&quot; class=&quot;headerlink&quot; title=&quot;1.&amp;#x7B80;&amp;#x4ECB;&quot;&gt;&lt;/a&gt;1.&amp;#x7B80;&amp;#x4ECB;&lt;/h1&gt;&lt;p&gt;Erasure Coding(EC) &amp;#x662F;&amp;#x4E00;&amp;#x79CD;&amp;#x6570;&amp;#x636E;&amp;#x5197;&amp;#x4F59;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x76F8;&amp;#x6BD4;&amp;#x4E8E;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x7EA0;&amp;#x5220;&amp;#x7801;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5197;&amp;#x4F59;&amp;#x5EA6;&amp;#x66F4;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5E76;&amp;#x80FD;&amp;#x83B7;&amp;#x5F97;&amp;#x66F4;&amp;#x9AD8;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x53EF;&amp;#x9760;&amp;#x6027;&amp;#x3002;&amp;#x7EA0;&amp;#x5220;&amp;#x7801;&amp;#x5305;&amp;#x542B;&amp;#x4E24;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x7F16;&amp;#x7801;&amp;#x548C;&amp;#x89E3;&amp;#x7801;&amp;#x3002;&amp;#x7F16;&amp;#x7801;&amp;#x65F6;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E00;&amp;#x4E9B;&amp;#x6570;&amp;#x636E;&amp;#x90E8;&amp;#x5206;&amp;#xFF0C;&amp;#x8BA1;&amp;#x7B97;&amp;#x51FA;&amp;#x4E00;&amp;#x4E9B;&amp;#x6821;&amp;#x9A8C;&amp;#x6570;&amp;#x636E;&amp;#xFF1B;&amp;#x5F53;&amp;#x6709;&amp;#x6570;&amp;#x636E;&amp;#x4E22;&amp;#x5931;&amp;#x65F6;&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x4F7F;&amp;#x7528;&amp;#x4F59;&amp;#x4E0B;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#xFF08;&amp;#x6E90;&amp;#x6570;&amp;#x636E;&amp;#x548C;&amp;#x6821;&amp;#x9A8C;&amp;#x6570;&amp;#x636E;&amp;#xFF09;&amp;#x89E3;&amp;#x7801;&amp;#x51FA;&amp;#x4E22;&amp;#x5931;&amp;#x7684;&amp;#x90E8;&amp;#x5206;&amp;#x3002;sheepdog&amp;#x4E2D;&amp;#x4E5F;&amp;#x63D0;&amp;#x4F9B;&amp;#x4E86;EC&amp;#x7684;&amp;#x652F;&amp;#x6301;&amp;#x3002;&amp;#x6BD4;&amp;#x5982;&amp;#x4F7F;&amp;#x7528;8:3&amp;#x7684;&amp;#x7EA0;&amp;#x5220;&amp;#x7B56;&amp;#x7565;&amp;#xFF08;8&amp;#x5757;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#xFF0C;3&amp;#x5757;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#xFF09;&amp;#xFF0C;sheepdog&amp;#x5C31;&amp;#x80FD;&amp;#x591F;&amp;#x5BB9;&amp;#x9519;3&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5B95;&amp;#x6389;&amp;#xFF0C;&amp;#x4EC5;&amp;#x4EC5;&amp;#x53EA;&amp;#x6709;3/8=0.375&amp;#x500D;&amp;#x7684;&amp;#x989D;&amp;#x5916;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x800C;&amp;#x8981;&amp;#x8FBE;&amp;#x5230;&amp;#x76F8;&amp;#x540C;&amp;#x7684;&amp;#x6548;&amp;#x679C;&amp;#xFF0C;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#x5374;&amp;#x9700;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;4&amp;#x526F;&amp;#x672C;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x5E26;&amp;#x6765;&amp;#x4E86;&amp;#x989D;&amp;#x5916;3&amp;#x500D;&amp;#x7684;&amp;#x6570;&amp;#x636E;&amp;#x5F00;&amp;#x9500;&amp;#x3002;sheepdog&amp;#x4E2D;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;Erasure Code&amp;#x7684;&amp;#x5F00;&amp;#x6E90;&amp;#x5E93;zfec&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;2-sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot;&gt;&lt;a href=&quot;#2-sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot; class=&quot;headerlink&quot; title=&quot;2.sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&quot;&gt;&lt;/a&gt;2.sheepdog&amp;#x4E2D;EC&amp;#x7684;&amp;#x7279;&amp;#x6027;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;1&amp;#xFF09;&amp;#x4E00;&amp;#x65E6;&amp;#x6307;&amp;#x5B9A;&amp;#x4E86;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x8BFB;&amp;#x5199;&amp;#x6570;&amp;#x636E;&amp;#x65F6;&amp;#x81EA;&amp;#x52A8;&amp;#x5730;&amp;#x4F7F;&amp;#x7528;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x989D;&amp;#x5916;&amp;#x7684;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;2&amp;#xFF09;&amp;#x652F;&amp;#x6301;&amp;#x968F;&amp;#x673A;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x5C31;&amp;#x5730;&amp;#x66F4;&amp;#x65B0;&amp;#xFF0C;&amp;#x975E;&amp;#x5BF9;&amp;#x9F50;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;3&amp;#xFF09;&amp;#x652F;&amp;#x6301;&amp;#x4EFB;&amp;#x610F;&amp;#x7C7B;&amp;#x578B;&amp;#x7684;VM&amp;#x955C;&amp;#x50CF;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;4&amp;#xFF09;&amp;#x4F7F;&amp;#x7528;VDI&amp;#x65F6;&amp;#xFF0C;&amp;#x7528;&amp;#x6237;&amp;#x53EF;&amp;#x4EE5;&amp;#x81EA;&amp;#x5B9A;&amp;#x4E49;EC&amp;#x7B56;&amp;#x7565;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;5&amp;#xFF09;&amp;#x76F8;&amp;#x5BF9;&amp;#x4E8E;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#xFF0C;EC&amp;#x80FD;&amp;#x591F;&amp;#x83B7;&amp;#x5F97;&amp;#x66F4;&amp;#x597D;&amp;#x7684;&amp;#x8BFB;&amp;#x5199;&amp;#x6027;&amp;#x80FD;&amp;#xFF1B;&lt;/li&gt;
&lt;li&gt;6&amp;#xFF09;&amp;#x4E00;&amp;#x4E2A;&amp;#x96C6;&amp;#x7FA4;&amp;#x4E2D;&amp;#x65E2;&amp;#x80FD;&amp;#x6709;&amp;#x591A;&amp;#x526F;&amp;#x672C;&amp;#x7684;&amp;#x5377;&amp;#xFF0C;&amp;#x4E5F;&amp;#x80FD;&amp;#x6709;EC&amp;#x7684;&amp;#x5377;&amp;#x3002;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;3-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;a href=&quot;#3-&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot; class=&quot;headerlink&quot; title=&quot;3.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&quot;&gt;&lt;/a&gt;3.&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x5F0F;&lt;/h1&gt;&lt;p&gt;&amp;#x7528;&amp;#x6237;&amp;#x521B;&amp;#x5EFA;VDI&amp;#xFF08;&amp;#x865A;&amp;#x62DF;&amp;#x5377;&amp;#xFF09;&amp;#x65F6;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x6307;&amp;#x5B9A;EC&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;br&gt;$dogvdi create -c x:y vdi size # Create a erasure coded VDI&lt;br&gt;x&amp;#x8868;&amp;#x793A;&amp;#x6570;&amp;#x636E;&amp;#x5757;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;x&amp;#x53EA;&amp;#x80FD;&amp;#x662F;{2,4,8,16}&amp;#xFF0C;y&amp;#x8868;&amp;#x793A;&amp;#x6821;&amp;#x9A8C;&amp;#x5757;&amp;#x7684;&amp;#x4E2A;&amp;#x6570;&amp;#xFF0C;y&amp;#x53EF;&amp;#x4EE5;&amp;#x53D6;&amp;#x503C;1~15&amp;#xFF0C;&amp;#x80FD;&amp;#x591F;&amp;#x5BB9;&amp;#x9519;y&amp;#x4E2A;&amp;#x8282;&amp;#x70B9;&amp;#x5B95;&amp;#x6389;&amp;#x3002;&lt;br&gt;&amp;#x5F53;&amp;#x7136;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8282;&amp;#x70B9;&amp;#x4E2A;&amp;#x6570;&amp;#x5C0F;&amp;#x4E8E;x+y&amp;#xFF0C;&amp;#x6307;&amp;#x5B9A;&amp;#x7684;&amp;#x7B56;&amp;#x7565;&amp;#x5C06;&amp;#x4F1A;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&lt;br&gt;&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x96C6;&amp;#x7FA4;&amp;#x65F6;&amp;#xFF0C;&amp;#x4E5F;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;EC&amp;#x4F5C;&amp;#x4E3A;&amp;#x9ED8;&amp;#x8BA4;&amp;#x7684;&amp;#x526F;&amp;#x672C;&amp;#x7B56;&amp;#x7565;&amp;#x3002;&lt;br&gt;$ dog cluster format -c x:y&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="sheepdog" scheme="http://yoursite.com/tags/sheepdog/"/>
    
  </entry>
  
  <entry>
    <title>systemtap分析软raid io拆分问题</title>
    <link href="http://yoursite.com/2016/05/03/systemtap-analysis-mdraid-io/"/>
    <id>http://yoursite.com/2016/05/03/systemtap-analysis-mdraid-io/</id>
    <published>2016-05-03T11:02:02.000Z</published>
    <updated>2016-05-03T12:01:47.060Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x4F7F;&amp;#x7528;linux &amp;#x8F6F;raid1&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x9047;&amp;#x5230;&amp;#x4E2A;&amp;#x5947;&amp;#x602A;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5F53;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x6BD4;&amp;#x5982;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x6765;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8BE5;&amp;#x8F6F;raid&amp;#x7684;&amp;#x5927;&amp;#x5757;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x90FD;&amp;#x4F1A;&amp;#x88AB;&amp;#x62C6;&amp;#x5206;&amp;#x4E3A;4k&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;io&amp;#xFF1B;&amp;#x800C;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x5982;sdb&amp;#xFF0C;sdc&amp;#xFF0C;vdb&amp;#xFF0C;vdc&amp;#x8FD9;&amp;#x79CD;&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x6765;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8BE5;&amp;#x8F6F;raid&amp;#x7684;&amp;#x5927;&amp;#x5757;&amp;#x8BFB;&amp;#x5199;&amp;#x5C31;&amp;#x4E0D;&amp;#x4F1A;&amp;#x6709;io&amp;#x62C6;&amp;#x5206;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x4F8B;&amp;#x5B50;&amp;#x8BF4;&amp;#x660E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x73B0;&amp;#x8C61;&amp;#xFF08;&amp;#x4EE5;raid1&amp;#xFF0C;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#x4E3A;&amp;#x4F8B;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot;&gt;&lt;a href=&quot;#&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot;&gt;&lt;/a&gt;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# mdadm &amp;#x2013;create /dev/md/md_test1 &amp;#x2013;run &amp;#x2013;force &amp;#x2013;metadata=0.9 &amp;#x2013;assume-clean &amp;#x2013;level=1 &amp;#x2013;raid-devices=2 /dev/vdb /dev/vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /proc/mdstat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Personalities : [raid1]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;md127 : active (auto-read-only) raid1 vdc[1] vdb[0]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      20971456 blocks [2/2] [UU]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;fio&amp;#x5BF9;&amp;#x8BE5;raid1&amp;#x8FDB;&amp;#x884C;&amp;#x968F;&amp;#x673A;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF08;&amp;#x987A;&amp;#x5E8F;&amp;#x5199;&amp;#x4E5F;&amp;#x662F;&amp;#x4E00;&amp;#x6837;&amp;#x7684;&amp;#xFF09;&amp;#xFF0C;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;64KB&amp;#xFF0C;fio&amp;#x7684;&amp;#x914D;&amp;#x7F6E;&amp;#x5982;&amp;#x4E0B;:&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[global]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rw=randwrite&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;direct=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;numjobs=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ioengine=sync&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bsrange=64k-64k&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rate_iops=60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time_based&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;runtime=120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;group_reporting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[disk00]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;filename=/dev/md127&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;fio&amp;#x5199;io&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;iostat&amp;#x67E5;&amp;#x770B;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#iostat -mx 2 md127 vdb vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/con1-iostat.png&quot; alt=&quot;con1-iostat&quot;&gt;&lt;br&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;avgrq-sz&amp;#x4E3A;128&amp;#xFF0C;&amp;#x5355;&amp;#x4F4D;&amp;#x662F;&amp;#x6247;&amp;#x533A;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;64KB&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x8FDB;&amp;#x884C;&amp;#x62C6;&amp;#x5206;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h1 id=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;device-mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;raid1&quot;&gt;&lt;a href=&quot;#&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;device-mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;raid1&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;raid1&quot;&gt;&lt;/a&gt;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x521B;&amp;#x5EFA;raid1&lt;/h1&gt;&lt;p&gt;&amp;#x8FD9;&amp;#x91CC;&amp;#x5148;&amp;#x7528;vdb&amp;#x548C;vdc&amp;#x5206;&amp;#x522B;&amp;#x521B;&amp;#x5EFA;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x518D;&amp;#x7528;&amp;#x8FD9;&amp;#x4E24;&amp;#x4E2A;dm&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;raid1&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#echo &amp;quot;0 41943040 linear /dev/vdb 0&amp;quot; | dmsetup create testdisk1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#echo &amp;quot;0 41943040 linear /dev/vdc 0&amp;quot; | dmsetup create testdisk2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#mdadm --create /dev/md/md_test1 --run --force --metadata=0.9 --assume-clean --level=1 --raid-devices=2  /dev/mapper/testdisk1 /dev/mapper/testdisk2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## cat /proc/mdstat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Personalities : [raid1]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;md127 : active (auto-read-only) raid1 dm-1[1] dm-0[0]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      20971456 blocks [2/2] [UU]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;fio&amp;#x914D;&amp;#x7F6E;&amp;#x6587;&amp;#x4EF6;&amp;#x4E0D;&amp;#x53D8;&amp;#xFF0C;&amp;#x5BF9;md127&amp;#x8FDB;&amp;#x884C;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;iostat&amp;#x67E5;&amp;#x770B;&amp;#x8BBE;&amp;#x5907;io&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#iostat -mx 2 md127 dm-0 dm-1 vdb vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/con2-iostat.png&quot; alt=&quot;con2-iostat&quot;&gt;&lt;br&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;md127&amp;#x548C;dm-0&amp;#xFF0C;dm-1&amp;#x4E0A;&amp;#x7684;io&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x90FD;&amp;#x662F;4KB&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x5BF9;md127&amp;#x53D1;&amp;#x7684;&amp;#x662F;64KB&amp;#x7684;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;io&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;io&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;&amp;#x62C6;&amp;#x5206;&amp;#x3002;&amp;#x53E6;&amp;#x5916;&amp;#xFF0C;vdb&amp;#x548C;vdc&amp;#x4E0A;&amp;#x7684;io&amp;#x5757;&amp;#x5927;&amp;#x5C0F;64KB&amp;#x4E0E;fio&amp;#x53D1;&amp;#x7684;io&amp;#x5927;&amp;#x5C0F;&amp;#x4E00;&amp;#x81F4;&amp;#xFF0C;io&amp;#x53C8;&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x540E;&amp;#x9762;&amp;#x4F1A;&amp;#x89E3;&amp;#x91CA;&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x4F1A;&amp;#x662F;&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x60C5;&amp;#x51B5;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;systemtap&amp;#x5206;&amp;#x6790;io&amp;#x6808;&quot;&gt;&lt;a href=&quot;#systemtap&amp;#x5206;&amp;#x6790;io&amp;#x6808;&quot; class=&quot;headerlink&quot; title=&quot;systemtap&amp;#x5206;&amp;#x6790;io&amp;#x6808;&quot;&gt;&lt;/a&gt;systemtap&amp;#x5206;&amp;#x6790;io&amp;#x6808;&lt;/h1&gt;&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x5F04;&amp;#x6E05;&amp;#x695A;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;raid&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;io&amp;#x4F1A;&amp;#x8FDB;&amp;#x884C;&amp;#x62C6;&amp;#x5206;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x80FD;&amp;#x591F;&amp;#x770B;&amp;#x5230;&amp;#x5757;io&amp;#x6BCF;&amp;#x4E00;&amp;#x5C42;&amp;#x6B21;&amp;#x8C03;&amp;#x7528;&amp;#x65F6;&amp;#x7684;io&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x77E5;&amp;#x9053;&amp;#x5728;&amp;#x54EA;&amp;#x4E00;&amp;#x5C42;&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;&amp;#x62C6;&amp;#x5206;&amp;#x3002;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x796D;&amp;#x51FA;&amp;#x795E;&amp;#x5668;systemtap&amp;#x3002;&amp;#x4E0D;&amp;#x8FC7;&amp;#x8981;&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x8FD8;&amp;#x5F97;&amp;#x5BF9;&amp;#x5185;&amp;#x6838;&amp;#x6709;&amp;#x4E00;&amp;#x5B9A;&amp;#x7684;&amp;#x4E86;&amp;#x89E3;&amp;#xFF0C;&amp;#x4E00;&amp;#x65F6;&amp;#x534A;&amp;#x4F1A;&amp;#x8981;&amp;#x5F04;&amp;#x6E05;&amp;#x695A;linux&amp;#x5185;&amp;#x6838;&amp;#x7684;&amp;#x67D0;&amp;#x4E00;&amp;#x5757;&amp;#x5F88;&amp;#x8270;&amp;#x96BE;&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x5C31;&amp;#x53EA;&amp;#x80FD;&amp;#x5BF9;&amp;#x7167;&amp;#x7740;&amp;#x5185;&amp;#x6838;&amp;#x4EE3;&amp;#x7801;&amp;#xFF0C;&amp;#x67E5;&amp;#x627E;&amp;#x5173;&amp;#x952E;&amp;#x51FD;&amp;#x6570;&amp;#x7684;&amp;#x8C03;&amp;#x7528;&amp;#x5904;&amp;#x6765;&amp;#x8FDB;&amp;#x884C;&amp;#x5206;&amp;#x6790;&amp;#x3002;&amp;#x6700;&amp;#x597D;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0E;&amp;#x7CFB;&amp;#x7EDF;&amp;#x7248;&amp;#x672C;&amp;#x4E00;&amp;#x81F4;&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#x6E90;&amp;#x7801;&amp;#xFF0C;&amp;#x8FD9;&amp;#x6837;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x66F4;&amp;#x597D;&amp;#x5730;&amp;#x5229;&amp;#x7528;systemtap&amp;#x7684;kernel.statement&amp;#x8FDB;&amp;#x884C;&amp;#x63A2;&amp;#x6D4B;&amp;#x3002;&amp;#x6211;&amp;#x7684;&amp;#x865A;&amp;#x62DF;&amp;#x673A;&amp;#x7CFB;&amp;#x7EDF;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x662F;3.2.54&amp;#x7248;&amp;#x672C;&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x4E0B;&amp;#x9762;&amp;#x7684;&amp;#x5206;&amp;#x6790;&amp;#x5C31;&amp;#x662F;&amp;#x4EE5;3.2.54&amp;#x5185;&amp;#x6838;&amp;#x4EE3;&amp;#x7801;&amp;#x4E3A;&amp;#x51C6;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65E2;&amp;#x7136;&amp;#x662F;&amp;#x5BF9;&amp;#x8F6F;raid&amp;#x5199;io&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x53D1;&amp;#x73B0;io&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;&amp;#x62C6;&amp;#x5206;&amp;#xFF0C;&amp;#x9996;&amp;#x5148;&amp;#x5C31;&amp;#x4ECE;md raid&amp;#x8FD9;&amp;#x4E00;&amp;#x5C42;&amp;#x5165;&amp;#x624B;&amp;#xFF0C;io&amp;#x8FDB;&amp;#x5165;&amp;#x8F6F;raid&amp;#x4F1A;&amp;#x7ECF;&amp;#x8FC7;md_make_request&amp;#xFF08;md.c&amp;#x4E2D;&amp;#xFF09;&amp;#x8FDB;&amp;#x884C;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5728;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x91CC;&amp;#x4F1A;&amp;#x6839;&amp;#x636E;raid&amp;#x7684;&amp;#x4E0D;&amp;#x540C;&amp;#x7EA7;&amp;#x522B;&amp;#x8C03;&amp;#x7528;&amp;#x4E0D;&amp;#x540C;make_request&amp;#xFF08;&amp;#x5982;raid1.c&amp;#x4E2D;&amp;#x7684;make_request&amp;#xFF09;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;&amp;#x5148;&amp;#x67E5;&amp;#x770B;md_make_request&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x6808;&amp;#xFF0C;md_make_request&amp;#x662F;&amp;#x8F6F;raid&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#x6A21;&amp;#x5757;md_mod&amp;#x4E2D;&amp;#x7684;&amp;#x3002;&amp;#x5728;&amp;#x4F7F;&amp;#x7528;fio&amp;#x5BF9;&amp;#x8F6F;raid&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#x65F6;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0B;&amp;#x9762;&amp;#x7684;systemtap&amp;#x811A;&amp;#x672C;&amp;#x63A2;&amp;#x6D4B;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&amp;#x6CE8;&amp;#x610F;&amp;#xFF1A;&amp;#x8FD9;&amp;#x91CC;&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x8981;&amp;#x52A0;&amp;#x4E0A;&amp;#x2013;all-modules&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x52A0;&amp;#x4E0A;&amp;#xFF0C;&amp;#x53EF;&amp;#x80FD;&amp;#x4F1A;&amp;#x5BFC;&amp;#x81F4;&amp;#x6253;&amp;#x5370;&amp;#x7684;&amp;#x51FD;&amp;#x6570;&amp;#x6808;&amp;#x4E0D;&amp;#x5168;&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#stap --all-modules -e &amp;apos;probe module(&amp;quot;md_mod&amp;quot;).function(&amp;quot;md_make_request&amp;quot;){printf(&amp;quot;======================\n&amp;quot;);print_backtrace()}&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;======================&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffffa0102c59 : md_make_request+0x0/0x1db [md_mod]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811993d2 : generic_make_request+0x90/0xcf [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811994e4 : submit_bio+0xd3/0xf1 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff811236a4 : dio_bio_submit+0x6e/0x8d [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8112399d : dio_send_cur_page+0x79/0xa4 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81123a6b : submit_page_section+0xa3/0xf8 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff8112435f : __blockdev_direct_IO+0x751/0xa67 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81122312 : blkdev_direct_IO+0x4e/0x53 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810b5e1c : generic_file_direct_write+0xdc/0x14c [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810b6020 : __generic_file_aio_write+0x194/0x278 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81122629 : blkdev_aio_write+0x1f/0x61 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810fa378 : &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;_sync_write+0xb4/0xec [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810faa69 : vfs_write+0xa2/0xe9 [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff810fac46 : sys_write+0x45/0x6b [kernel]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; 0xffffffff81354d92 : system_call_fastpath+0x16/0x1b [kernel]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&quot;systemtap&amp;#x7684;&amp;#x51E0;&amp;#x70B9;&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;&quot;&gt;&lt;a href=&quot;#systemtap&amp;#x7684;&amp;#x51E0;&amp;#x70B9;&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;&quot; class=&quot;headerlink&quot; title=&quot;systemtap&amp;#x7684;&amp;#x51E0;&amp;#x70B9;&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;&quot;&gt;&lt;/a&gt;systemtap&amp;#x7684;&amp;#x51E0;&amp;#x70B9;&amp;#x4F7F;&amp;#x7528;&amp;#x65B9;&amp;#x6CD5;&lt;/h1&gt;&lt;p&gt;&amp;#x6709;&amp;#x4E86;&amp;#x8FD9;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x8C03;&amp;#x7528;&amp;#x5173;&amp;#x7CFB;&amp;#xFF0C;&amp;#x5C31;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BF9;&amp;#x6BCF;&amp;#x4E2A;&amp;#x51FD;&amp;#x6570;&amp;#x63A2;&amp;#x6D4B;&amp;#xFF0C;&amp;#x67E5;&amp;#x770B;io&amp;#x5927;&amp;#x5C0F;&amp;#xFF0C;&amp;#x8FD9;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x5BF9;&amp;#x7167;&amp;#x7740;&amp;#x5185;&amp;#x6838;&amp;#x4EE3;&amp;#x7801;&amp;#x67E5;&amp;#x770B;&amp;#x51FD;&amp;#x6570;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x4E2D;io&amp;#x5927;&amp;#x5C0F;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;generic_file_direct_write&amp;#x4E2D;&amp;#x7684;count&lt;br&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/generic_file_direct_write.png&quot; alt=&quot;generic_file_direct_write&quot;&gt;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;stap -L &amp;#x2018;kernel.function(&amp;#x201C;function&amp;#x201D;)&amp;#x2019;&amp;#x67E5;&amp;#x770B;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x6709;&amp;#x54EA;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#x53EF;&amp;#x4EE5;&amp;#x63A2;&amp;#x6D4B;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stap -L &amp;apos;kernel.function(&amp;quot;generic_file_direct_write&amp;quot;)&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;generic_file_direct_write@/build/linux-FpPMO6/linux-3.2.54/mm/filemap.c:2266&amp;quot;&lt;/span&gt;) &lt;span class=&quot;variable&quot;&gt;$iocb&lt;/span&gt;:struct kiocb* &lt;span class=&quot;variable&quot;&gt;$iov&lt;/span&gt;:struct iovec const* &lt;span class=&quot;variable&quot;&gt;$nr_segs&lt;/span&gt;:long unsigned int* &lt;span class=&quot;variable&quot;&gt;$pos&lt;/span&gt;:loff_t &lt;span class=&quot;variable&quot;&gt;$ppos&lt;/span&gt;:loff_t* &lt;span class=&quot;variable&quot;&gt;$count&lt;/span&gt;:size_t &lt;span class=&quot;variable&quot;&gt;$ocount&lt;/span&gt;:size_t &lt;span class=&quot;variable&quot;&gt;$file&lt;/span&gt;:struct file* &lt;span class=&quot;variable&quot;&gt;$write_len&lt;/span&gt;:size_t&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x53C2;&amp;#x6570;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;&amp;#x7ED3;&amp;#x6784;&amp;#x4F53;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x7701;&amp;#x53BB;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x6BB5;&amp;#x4E00;&amp;#x4E2A;&amp;#x5B57;&amp;#x6BB5;&amp;#x53BB;&amp;#x6253;&amp;#x5370;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;$var$$&amp;#x8FD9;&amp;#x6837;&amp;#x7684;&amp;#x65B9;&amp;#x5F0F;&amp;#x628A;&amp;#x6574;&amp;#x4E2A;&amp;#x7ED3;&amp;#x6784;&amp;#x4F53;&amp;#x90FD;&amp;#x6253;&amp;#x5370;&amp;#x51FA;&amp;#x6765;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stap -e &amp;apos;probe kernel.function(&amp;quot;__blockdev_direct_IO&amp;quot;){printf(&amp;quot;[__blockdev_direct_IO] nr_segs:%d, iov:%s\n&amp;quot;, $nr_segs, $iov$$)}&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x21ff000, .iov_len=65536}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x21ff000, .iov_len=65536}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x21ff000, .iov_len=65536}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x6709;&amp;#x7684;&amp;#x5185;&amp;#x6838;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;&amp;#x53EF;&amp;#x63A2;&amp;#x6D4B;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x65F6;&amp;#xFF0C;&amp;#x6BD4;&amp;#x5982;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stap -L &amp;apos;kernel.function(&amp;quot;dio_send_cur_page&amp;quot;)&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;dio_send_cur_page@/build/linux-FpPMO6/linux-3.2.54/fs/direct-io.c:693&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x4ECD;&amp;#x7136;&amp;#x53BB;&amp;#x6253;&amp;#x5370;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x7684;&amp;#x53C2;&amp;#x6570;&amp;#x65F6;&amp;#x5C31;&amp;#x4F1A;&amp;#x62A5;&amp;#x9519;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#stap -e &amp;apos;probe kernel.function(&amp;quot;dio_send_cur_page&amp;quot;){printf(&amp;quot;[dio_send_cur_page] sdio:%s\n&amp;quot;, $sdio$$)}&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;semantic error: unable to find &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;apos;sdio&amp;apos;&lt;/span&gt;, [man error::dwarf] dieoffset 0x13b5772 &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; kernel, near pc 0xffffffff811239c1 &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; dio_send_cur_page /build/linux-FpPMO6/linux-3.2.54/fs/direct-io.c (&amp;lt;no alternatives&amp;gt;): identifier &lt;span class=&quot;string&quot;&gt;&amp;apos;$sdio$$&amp;apos;&lt;/span&gt; at &amp;lt;input&amp;gt;:1:87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt;: probe kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;dio_send_cur_page&amp;quot;&lt;/span&gt;){&lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[dio_send_cur_page] sdio:%s\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$sdio&lt;/span&gt;$$)}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                                                                      ^&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x4E2A;&amp;#x65F6;&amp;#x5019;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x6362;&amp;#x4E00;&amp;#x79CD;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;kernel.statement&amp;#x63A2;&amp;#x6D4B;&amp;#x67D0;&amp;#x4E00;&amp;#x884C;&amp;#x7684;&amp;#x53D8;&amp;#x91CF;&lt;br&gt;dio_send_cur_page&amp;#x51FD;&amp;#x6570;&amp;#x5728;fs/direct-io.c&amp;#x4E2D;693&amp;#x884C;&amp;#x5F00;&amp;#x59CB;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x53EF;&amp;#x4EE5;&amp;#x5BF9;&amp;#x8BE5;&amp;#x51FD;&amp;#x6570;&amp;#x5185;&amp;#x7684;&amp;#x67D0;&amp;#x4E00;&amp;#x884C;&amp;#x7684;&amp;#x53D8;&amp;#x91CF;&amp;#x8FDB;&amp;#x884C;&amp;#x6253;&amp;#x5370;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# stap -e &amp;apos;probe kernel.statement(&amp;quot;*@fs/direct-io.c:700&amp;quot;){printf(&amp;quot;[dio_send_cur_page] bio size:%d\n&amp;quot;, $sdio-&amp;gt;bio-&amp;gt;bi_size)}&amp;apos;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bio size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bio size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] bio size:4096&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;systemtap&amp;#x5206;&amp;#x6790;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x548C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&quot;&gt;&lt;a href=&quot;#systemtap&amp;#x5206;&amp;#x6790;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x548C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&quot; class=&quot;headerlink&quot; title=&quot;systemtap&amp;#x5206;&amp;#x6790;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x548C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&quot;&gt;&lt;/a&gt;systemtap&amp;#x5206;&amp;#x6790;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x548C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&lt;/h1&gt;&lt;p&gt;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;systemtap&amp;#x811A;&amp;#x672C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;generic_file_direct_write&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[generic_file_direct_write] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$count&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;__blockdev_direct_IO&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[__blockdev_direct_IO] nr_segs:%d, iov:%s\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$nr_segs&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$iov&lt;/span&gt;$)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/direct-io.c:774&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$sdio&lt;/span&gt;-&amp;gt;bio)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[submit_page_section] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$sdio&lt;/span&gt;-&amp;gt;bio-&amp;gt;bi_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/direct-io.c:700&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[dio_send_cur_page] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$sdio&lt;/span&gt;-&amp;gt;bio-&amp;gt;bi_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;dio_bio_submit&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[dio_bio_submit] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$sdio&lt;/span&gt;-&amp;gt;bio-&amp;gt;bi_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.function(&lt;span class=&quot;string&quot;&gt;&amp;quot;submit_bio&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[submit_bio] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$bio&lt;/span&gt;-&amp;gt;bi_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe module(&lt;span class=&quot;string&quot;&gt;&amp;quot;md_mod&amp;quot;&lt;/span&gt;).function(&lt;span class=&quot;string&quot;&gt;&amp;quot;md_make_request&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;[md_make_request] size:%d\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$bio&lt;/span&gt;-&amp;gt;bi_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;systemtap&amp;#x811A;&amp;#x672C;&amp;#x5206;&amp;#x522B;&amp;#x5BF9;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x548C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x8FDB;&amp;#x884C;&amp;#x63A2;&amp;#x6D4B;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;32KB&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&lt;/strong&gt;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0xcd0000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0xcd0000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;........&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7ED3;&amp;#x679C;&amp;#x4E2D;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x51FA;&amp;#x5728;__blockdev_direct_IO&amp;#x91CC;&amp;#x8FDB;&amp;#x884C;&amp;#x4E86;io&amp;#x62C6;&amp;#x5206;&amp;#xFF0C;&amp;#x672C;&amp;#x6765;&amp;#x662F;32KB&amp;#x7684;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;io&amp;#xFF0C;&amp;#x62C6;&amp;#x5206;&amp;#x6210;&amp;#x4E86;4KB&amp;#x7684;io&amp;#xFF08;&amp;#x6B63;&amp;#x597D;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;page&amp;#xFF09;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;dio_bio_submit&amp;#xFF0C;submit_bio&amp;#xFF0C;md_make_request&amp;#x90FD;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;8&amp;#x6B21;&amp;#xFF08;32KB/4KB=8)&amp;#xFF0C;&amp;#x800C;dio_send_cur_page&amp;#x53EA;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;7&amp;#x6B21;&amp;#xFF0C;&amp;#x5C11;&amp;#x4E86;&amp;#x4E00;&amp;#x6B21;&amp;#xFF0C;&amp;#x5E94;&amp;#x8BE5;&amp;#x662F;&amp;#x7B2C;&amp;#x516B;&amp;#x6B21;&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x76F4;&amp;#x63A5;&amp;#x8C03;&amp;#x7528;&amp;#x4E86;dio_bio_submit&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&lt;strong&gt;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&lt;/strong&gt;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x2139000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:8192&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:12288&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:16384&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:20480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:20480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:24576&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:24576&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:28672&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0x2139000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;........&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;dio_send_cur_page&amp;#x6BCF;&amp;#x8C03;&amp;#x7528;&amp;#x4E00;&amp;#x6B21;&amp;#xFF0C;size&amp;#x90FD;&amp;#x53D8;&amp;#x5927;&amp;#x4E86;&amp;#xFF0C;&amp;#x521A;&amp;#x597D;&amp;#x6BCF;&amp;#x6B21;&amp;#x589E;&amp;#x52A0;4KB&amp;#xFF0C;&amp;#x731C;&amp;#x6D4B;&amp;#x662F;&amp;#x5728;__blockdev_direct_IO&amp;#x6309;page&amp;#x5927;&amp;#x5C0F;&amp;#x5C06;io&amp;#x62C6;&amp;#x5206;&amp;#xFF0C;&amp;#x7136;&amp;#x540E;&amp;#x5728;dio_send_cur_page&amp;#x8FDB;&amp;#x884C;io&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x5408;&amp;#x5E76;&amp;#x540E;&amp;#x4E0B;&amp;#x53D1;&amp;#x5230;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x4E0A;&amp;#x7684;io&amp;#x7531;&amp;#x53D8;&amp;#x6210;&amp;#x4E86;32KB&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;io&amp;#x5408;&amp;#x5E76;&amp;#x95EE;&amp;#x9898;&quot;&gt;&lt;a href=&quot;#&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;io&amp;#x5408;&amp;#x5E76;&amp;#x95EE;&amp;#x9898;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;io&amp;#x5408;&amp;#x5E76;&amp;#x95EE;&amp;#x9898;&quot;&gt;&lt;/a&gt;&amp;#x6DF1;&amp;#x5165;&amp;#x5206;&amp;#x6790;io&amp;#x5408;&amp;#x5E76;&amp;#x95EE;&amp;#x9898;&lt;/h1&gt;&lt;p&gt;&amp;#x63A5;&amp;#x4E0B;&amp;#x6765;&amp;#x5C31;&amp;#x662F;&amp;#x8981;&amp;#x5F04;&amp;#x6E05;&amp;#x695A;&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x4E2D;&amp;#xFF0C;dio_send_cur_page&amp;#x4E2D;&amp;#x5408;&amp;#x5E76;&amp;#x9875;&amp;#x4F1A;&amp;#x5931;&amp;#x8D25;&amp;#x3002;&lt;br&gt;&amp;#x5728;dio_send_cur_page&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x4F1A;&amp;#x5224;&amp;#x65AD;&amp;#x524D;&amp;#x4E00;&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x4E0E;&amp;#x5F53;&amp;#x524D;&amp;#x8BF7;&amp;#x6C42;&amp;#x662F;&amp;#x5426;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;&amp;#x5C31;&amp;#x4F1A;&amp;#x8C03;&amp;#x7528;dio_bio_add_page&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x4E0D;&amp;#x662F;&amp;#x5C31;&amp;#x4F1A;&amp;#x76F4;&amp;#x63A5;&amp;#x8C03;&amp;#x7528;dio_bio_submit&amp;#x4E0B;&amp;#x53D1;&amp;#x8BF7;&amp;#x6C42;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x6D4B;&amp;#x8BD5;&amp;#x65F6;&amp;#x6BCF;&amp;#x6B21;&amp;#x7528;fio&amp;#x53D1;32KB&amp;#x7684;&amp;#x8BF7;&amp;#x6C42;&amp;#xFF0C;&amp;#x5230;dio_send_cur_page&amp;#x8FD9;&amp;#x4E00;&amp;#x5C42;&amp;#x53D8;&amp;#x6210;4KB&amp;#xFF0C;&amp;#x56E0;&amp;#x6B64;&amp;#x6BCF;8&amp;#x4E2A;&amp;#x8BF7;&amp;#x6C42;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#xFF08;&amp;#x4ECE;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x7684;&amp;#x5206;&amp;#x6790;&amp;#x7ED3;&amp;#x679C;&amp;#x4E2D;&amp;#x4E5F;&amp;#x80FD;&amp;#x770B;&amp;#x51FA;&amp;#x6765;&amp;#xFF09;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5E94;&amp;#x8BE5;&amp;#x662F;&amp;#x8FDE;&amp;#x7EED;&amp;#x7684;&amp;#x624D;&amp;#x5BF9;&amp;#xFF0C;&amp;#x53EF;&amp;#x662F;&amp;#x7ED3;&amp;#x679C;&amp;#x5374;&amp;#x662F;dio_send_cur_page&amp;#x8FD9;&amp;#x91CC;&amp;#x6CA1;&amp;#x6709;&amp;#x5408;&amp;#x5E76;&amp;#x5176;&amp;#x4ED6;&amp;#x76F8;&amp;#x90BB;&amp;#x7684;io&amp;#x6216;&amp;#x8005;&amp;#x662F;&amp;#x5408;&amp;#x5E76;&amp;#x5931;&amp;#x8D25;&amp;#x4E86;&amp;#xFF0C;dio_send_cur_page&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x6709;&amp;#x8FD9;&amp;#x4E48;&amp;#x4E00;&amp;#x5904;&amp;#x4EE3;&amp;#x7801;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/dio_bio_add_page.png&quot; alt=&quot;dio_bio_add_page&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8C03;&amp;#x7528;dio_bio_add_page&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x5408;&amp;#x5E76;&amp;#x5931;&amp;#x8D25;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x76F4;&amp;#x63A5;&amp;#x8C03;&amp;#x7528;dio_bio_submit&amp;#x628A;&amp;#x5F53;&amp;#x524D;&amp;#x8BF7;&amp;#x6C42;&amp;#x63D0;&amp;#x4EA4;&amp;#x3002;&lt;br&gt;&amp;#x6000;&amp;#x7591;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x4E2D;&amp;#x662F;&amp;#x56E0;&amp;#x4E3A;&amp;#x8FD9;&amp;#x4E2A;&amp;#x5730;&amp;#x65B9;&amp;#x5408;&amp;#x5E76;&amp;#x5931;&amp;#x8D25;&amp;#x4E86;&amp;#x3002;&lt;br&gt;dio_bio_add_page&amp;#x4E2D;&amp;#x53C8;&amp;#x662F;&amp;#x8C03;&amp;#x7528;bio_add_page&amp;#x8FDB;&amp;#x884C;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;bio_add_page&amp;#x8C03;&amp;#x7528;&lt;strong&gt;bio_add_page&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8FD9;&amp;#x91CC;&amp;#x6CE8;&amp;#x610F;&amp;#x5173;&amp;#x6CE8;&lt;/strong&gt;bio_add_page&amp;#x8FD4;&amp;#x56DE;&amp;#x5931;&amp;#x8D25;&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#x3002;&amp;#x6709;&amp;#x51E0;&amp;#x5904;return 0&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#xFF0C;&amp;#x4E3A;&amp;#x4E86;&amp;#x5FEB;&amp;#x901F;&amp;#x627E;&amp;#x51FA;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x662F;&amp;#x5728;&amp;#x54EA;&amp;#x4E00;&amp;#x5904;return 0&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5206;&amp;#x522B;&amp;#x5728;&amp;#x8FD9;&amp;#x51E0;&amp;#x5904;return 0&amp;#x7684;&amp;#x5730;&amp;#x65B9;&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x63A2;&amp;#x6D4B;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5C06;&amp;#x4E0B;&amp;#x9762;&amp;#x7684;&amp;#x811A;&amp;#x672C;&amp;#x52A0;&amp;#x5230;&amp;#x4E0A;&amp;#x9762;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;systemtap&amp;#x811A;&amp;#x672C;&amp;#x4E2D;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/bio.c:530&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;aaaaaaaaaaaaaaaaaaaaaaaaaaa\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/bio.c:561&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;cccccccccccccccccccccc\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/bio.c:581&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;ddddddddddddddddddddddd\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/bio.c:616&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;eeeeeeeeeeeeeeeeeeeeee\n&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x6267;&amp;#x884C;&amp;#x7684;&amp;#x7ED3;&amp;#x679C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[generic_file_direct_write] size:32768&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[__blockdev_direct_IO] nr_segs:1, iov:{.iov_base=0xccd000, .iov_len=32768}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ddddddddddddddddddddddd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ddddddddddddddddddddddd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_bio_submit] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_bio] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[md_make_request] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[submit_page_section] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[dio_send_cur_page] size:4096&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;........&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8BF4;&amp;#x660E;&amp;#x662F;&amp;#x5728;bio.c&amp;#x4E2D;&amp;#x7684;581&amp;#x884C;&amp;#x5904;return&amp;#x7684;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E00;&amp;#x5904;&amp;#x7684;&amp;#x4EE3;&amp;#x7801;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/blk_recount_segments.png&quot; alt=&quot;blk_recount_segments&quot;&gt;&lt;br&gt;&amp;#x5176;&amp;#x4E2D;queue_max_segments(q)&amp;#x5C31;&amp;#x662F;q-&amp;gt;limits.max_segments&lt;br&gt;&amp;#x518D;&amp;#x4F7F;&amp;#x7528;systemtap&amp;#x628A;bio-&amp;gt;bi_phys_segments&amp;#x548C;q-&amp;gt;limits.max_segments&amp;#x7684;&amp;#x503C;&amp;#x90FD;&amp;#x6253;&amp;#x5370;&amp;#x51FA;&amp;#x6765;&amp;#x4E86;&amp;#xFF0C;&amp;#x8FD9;&amp;#x91CC;&amp;#x662F;&amp;#x628A;q-&amp;gt;limits&amp;#x6574;&amp;#x4E2A;&amp;#x7ED3;&amp;#x6784;&amp;#x4F53;&amp;#x90FD;&amp;#x6253;&amp;#x5370;&amp;#x51FA;&amp;#x6765;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;probe kernel.statement(&lt;span class=&quot;string&quot;&gt;&amp;quot;*@fs/bio.c:581&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;printf&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;ddddddddddddddddddddddd bio-&amp;gt;bi_phys_segments:%d, q-&amp;gt;limits:%s\n&amp;quot;&lt;/span&gt;, &lt;span class=&quot;variable&quot;&gt;$bio&lt;/span&gt;-&amp;gt;bi_phys_segments, &lt;span class=&quot;variable&quot;&gt;$q&lt;/span&gt;-&amp;gt;limits$$)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x7ED3;&amp;#x679C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ddddddddddddddddddddddd bio-&amp;gt;bi_phys_segments:1, q-&amp;gt;limits:{.bounce_pfn=4503599627370495, .seg_boundary_mask=4095, .max_hw_sectors=255, .max_sectors=255, .max_segment_size=65536, .physical_block_size=512, .alignment_offset=0, .io_min=512, .io_opt=0, .max_discard_sectors=0, .discard_granularity=0, .discard_alignment=0, .logical_block_size=512, .max_segments=1, .max_integrity_segments=0, .misaligned=&lt;span class=&quot;string&quot;&gt;&amp;apos;\000&amp;apos;&lt;/span&gt;, .discard_misaligned=&lt;span class=&quot;string&quot;&gt;&amp;apos;\000&amp;apos;&lt;/span&gt;, .cluster=&lt;span class=&quot;string&quot;&gt;&amp;apos;\001&amp;apos;&lt;/span&gt;, .discard_zeroes_data=&lt;span class=&quot;string&quot;&gt;&amp;apos;\000&amp;apos;&lt;/span&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;bio-&amp;gt;bi_phys_segments=1&amp;#xFF0C;q-&amp;gt;limits.max_segments=1&amp;#xFF0C;&lt;br&gt;&amp;#x5206;&amp;#x6790;&amp;#x4EE3;&amp;#x7801;&amp;#x5728;578&amp;#x884C;&amp;#x6EE1;&amp;#x8DB3;while&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;&amp;#x8FDB;&amp;#x5165;&amp;#x5FAA;&amp;#x73AF;&amp;#x540E;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;retried_segments&amp;#x521D;&amp;#x59CB;&amp;#x5316;&amp;#x4E3A;0&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x8DF3;&amp;#x8FC7;if&amp;#x5224;&amp;#x65AD;&amp;#xFF0C;&amp;#x5C06;retried_segments&amp;#x8D4B;&amp;#x503C;&amp;#x4E3A;1&amp;#xFF0C;&amp;#x4E0B;&amp;#x6B21;&amp;#x518D;&amp;#x5FAA;&amp;#x73AF;&amp;#x65F6;&amp;#x5C31;&amp;#x6EE1;&amp;#x8DB3;if&amp;#x5224;&amp;#x65AD;&amp;#x6761;&amp;#x4EF6;&amp;#xFF0C;return&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x5176;&amp;#x4E2D;q-&amp;gt;limits&amp;#x53CD;&amp;#x6620;&amp;#x5230;sysfs&amp;#x4E2D;&amp;#x5C31;&amp;#x662F;/sys/block/xxx/queue/&amp;#x4E0B;&amp;#x9762;&amp;#x7684;&amp;#x4E00;&amp;#x4E9B;&amp;#x53C2;&amp;#x6570;&amp;#x3002;&lt;br&gt;&amp;#x67E5;&amp;#x770B;md127&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/md127/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x800C;&amp;#x5176;&amp;#x4ED6;&amp;#x8BBE;&amp;#x5907;&amp;#x5982;vdc&amp;#xFF0C;vdd&amp;#x8FD9;&amp;#x4E2A;&amp;#x503C;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/vdc/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x4E3A;&amp;#x4EC0;&amp;#x4E48;&amp;#x8FD9;&amp;#x4E2A;md&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#x4E3A;1&amp;#x5462;&amp;#xFF1F;&amp;#x662F;&amp;#x6240;&amp;#x6709;&amp;#x7684;md&amp;#x8BBE;&amp;#x5907;&amp;#x90FD;&amp;#x4F1A;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;1&amp;#x5417;&amp;#xFF1F;&lt;br&gt;&amp;#x5207;&amp;#x6362;&amp;#x5230;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x4E0B;&amp;#xFF08;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;raid1&amp;#xFF09;&amp;#xFF0C;&amp;#x67E5;&amp;#x770B;&amp;#x6B64;&amp;#x65F6;&amp;#x7684;md127&amp;#x7684;max_segments.&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /sys/block/md127/queue/max_segments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5C45;&amp;#x7136;&amp;#x662F;126&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x662F;1&amp;#xFF01;&amp;#xFF01;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD9;&amp;#x79CD;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#x5C31;&amp;#x9700;&amp;#x8981;&amp;#x77E5;&amp;#x9053;&amp;#x5728;&amp;#x54EA;&amp;#x91CC;&amp;#x628A;max_segments&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;1&amp;#x4E86;&amp;#xFF0C;&amp;#x76F4;&amp;#x63A5;&amp;#x5728;linux&amp;#x5185;&amp;#x6838;&amp;#x4EE3;&amp;#x7801;&amp;#x4E2D;&amp;#x641C;&amp;#x201D;max_segments&amp;#x201D;&amp;#xFF0C;&amp;#x6700;&amp;#x540E;&amp;#x627E;&amp;#x5230;&amp;#x5728;raid1.c&amp;#x4E2D;run&amp;#x51FD;&amp;#x6570;&amp;#x4E2D;&amp;#x4F1A;&amp;#x5224;&amp;#x65AD;&amp;#x7EC4;&amp;#x6210;raid&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x5426;&amp;#x6709;merge_bvec_fn&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#xFF0C;&amp;#x5C31;&amp;#x4F1A;&amp;#x5C06;md&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#x8BBE;&amp;#x7F6E;&amp;#x4E3A;1&amp;#x3002;&amp;#x800C;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;&amp;#x4E2D;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x6765;&amp;#x521B;&amp;#x5EFA;&amp;#x7684;&amp;#x8F6F;raid1&amp;#xFF0C;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x6709;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;merge_bvec_fn&amp;#x51FD;&amp;#x6570;&amp;#xFF1B;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#x662F;&amp;#x4F7F;&amp;#x7528;&amp;#x7684;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x6CA1;&amp;#x6709;merge_bvec_fn&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x5C31;&amp;#x4E0D;&amp;#x4FEE;&amp;#x6539;max_segments&amp;#x7684;&amp;#x503C;&amp;#x3002;&amp;#x4E4B;&amp;#x6240;&amp;#x4EE5;&amp;#x4F1A;&amp;#x8FD9;&amp;#x6837;&amp;#x505A;&amp;#xFF0C;&amp;#x662F;&amp;#x56E0;&amp;#x4E3A;&amp;#x7CFB;&amp;#x7EDF;&amp;#x8BA4;&amp;#x4E3A;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x5982;&amp;#x679C;&amp;#x6709;&amp;#x81EA;&amp;#x5DF1;&amp;#x7684;io&amp;#x5408;&amp;#x5E76;&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;&amp;#x5728;&amp;#x4E0A;&amp;#x5C42;&amp;#x5C31;&amp;#x4E0D;&amp;#x9700;&amp;#x8981;&amp;#x5408;&amp;#x5E76;&amp;#xFF0C;&amp;#x4EA4;&amp;#x7ED9;&amp;#x8BE5;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#x81EA;&amp;#x5DF1;&amp;#x5408;&amp;#x5E76;io&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/raid1_run.png&quot; alt=&quot;raid1_run&quot;&gt;&lt;br&gt;&amp;#x53E6;&amp;#x5916;&amp;#x9700;&amp;#x8981;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x4E00;&amp;#x70B9;&amp;#xFF1A;/sys/block/xxx/queue/max_segments &amp;#x8FD9;&amp;#x662F;&amp;#x4E2A;&amp;#x53EA;&amp;#x8BFB;&amp;#x7684;&amp;#xFF0C;&amp;#x5C1D;&amp;#x8BD5;&amp;#x53BB;&amp;#x4FEE;&amp;#x6539;&amp;#x4F1A;&amp;#x62A5;&amp;#x9519;&amp;#x7684;&amp;#x3002;&lt;br&gt;&amp;#x81F3;&amp;#x6B64;&amp;#xFF0C;&amp;#x7EC8;&amp;#x4E8E;&amp;#x627E;&amp;#x5230;&amp;#x60C5;&amp;#x5F62;&amp;#x4E8C;io&amp;#x88AB;&amp;#x62C6;&amp;#x5206;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&amp;#x4E86;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;device-mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max-segments&quot;&gt;&lt;a href=&quot;#device-mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max-segments&quot; class=&quot;headerlink&quot; title=&quot;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&quot;&gt;&lt;/a&gt;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&lt;/h1&gt;&lt;p&gt;&amp;#x53E6;&amp;#x4E00;&amp;#x4E2A;&amp;#x95EE;&amp;#x9898;&amp;#xFF1A;&amp;#x4EE5;md&amp;#x8BBE;&amp;#x5907;&amp;#x5EFA;&amp;#x6210;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x8FD9;&amp;#x4E2A;md&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#x4E3A;1&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x8FD9;&amp;#x4E2A;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#x4E5F;&amp;#x662F;1&amp;#xFF1B;&amp;#x5982;&amp;#x679C;md&amp;#x8BBE;&amp;#x5907;max_segments&amp;#x4E3A;126&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x7684;max_segments&amp;#x4E5F;&amp;#x4E3A;126&amp;#xFF0C;&lt;br&gt;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;&amp;#x628A;queue limits&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;&amp;#x9ED8;&amp;#x8BA4;&amp;#x503C;&amp;#x7684;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;max_segments&amp;#x7684;&amp;#x9ED8;&amp;#x8BA4;&amp;#x662F;128&amp;#xFF0C;&lt;br&gt;&amp;#x7136;&amp;#x540E;&amp;#x5728;bdev_stack_limits&amp;#x4E2D;&amp;#x4F1A;&amp;#x6BD4;&amp;#x8F83;&amp;#x81EA;&amp;#x8EAB;&amp;#x7684;queue limits&amp;#x548C;device mapper&amp;#x4E0B;&amp;#x9762;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;queue limits&amp;#xFF0C;&amp;#x4E24;&amp;#x8005;&amp;#x53D6;&amp;#x6700;&amp;#x5C0F;&amp;#x503C;&amp;#xFF0C;&amp;#x56E0;&amp;#x4E3A;&amp;#x73B0;&amp;#x5728;&amp;#x4E0B;&amp;#x9762;&amp;#x7684;&amp;#x8BBE;&amp;#x5907;&amp;#x662F;&amp;#x4E00;&amp;#x4E2A;md&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x8FD9;&amp;#x4E2A;md&amp;#x8BBE;&amp;#x5907;&amp;#x73B0;&amp;#x5728;&amp;#x7684;max_segments&amp;#x662F;1&amp;#xFF09;&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x6700;&amp;#x7EC8;&amp;#x4F1A;&amp;#x628A;&amp;#x8FD9;&amp;#x4E2A;device mapper&amp;#x7684;max_segments&amp;#x8BBE;&amp;#x7F6E;&amp;#x6210;1&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x65B0;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;device mapper&amp;#x7684;&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#x7684;&amp;#x6700;&amp;#x540E;&amp;#x4E00;&amp;#x6B65;&amp;#x662F;&amp;#x8C03;&amp;#x7528;do_resume&amp;#x51FD;&amp;#x6570;&amp;#xFF0C;device mapper&amp;#x7684;&amp;#x521B;&amp;#x5EFA;&amp;#x903B;&amp;#x8F91;&amp;#x53C2;&amp;#x8003;&lt;a href=&quot;http://www.ibm.com/developerworks/cn/linux/l-devmapper/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&amp;#x521B;&amp;#x5EFA;device mapper&lt;/a&gt;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;do_resume(drivers/md/dm-ioctl.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    |--dm_swap_table(drivers/md/dm.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            |--dm_calculate_queue_limits(drivers/md/dm-table.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   |--ti-&amp;gt;type-&amp;gt;iterate_devices(ti, dm_set_device_limits,&amp;amp;ti_limits)  &amp;#x5BF9;&amp;#x5E94;linear&amp;#x4E2D;&amp;#x7684;linear_iterate_devices&amp;#xFF08;drivers/md/dm-linear.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            |--dm_set_device_limits(drivers/md/dm-table.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                    |--bdev_stack_limits(block/blk-setting.c)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                           |--blk_stack_limits(block/blk-setting.c)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#x603B;&amp;#x7ED3;&quot;&gt;&lt;a href=&quot;#&amp;#x603B;&amp;#x7ED3;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x603B;&amp;#x7ED3;&quot;&gt;&lt;/a&gt;&amp;#x603B;&amp;#x7ED3;&lt;/h1&gt;&lt;p&gt;&amp;#x4ECE;&amp;#x4E0A;&amp;#x9762;&amp;#x7684;&amp;#x5206;&amp;#x6790;&amp;#x770B;&amp;#x51FA;&amp;#xFF0C;max_segments&amp;#x8FD9;&amp;#x4E2A;&amp;#x53C2;&amp;#x6570;&amp;#x5F71;&amp;#x54CD;&amp;#x4E86;io&amp;#x7684;&amp;#x5408;&amp;#x5E76;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x4F7F;&amp;#x7528;linux &amp;#x8F6F;raid1&amp;#x7684;&amp;#x65F6;&amp;#x5019;&amp;#x9047;&amp;#x5230;&amp;#x4E2A;&amp;#x5947;&amp;#x602A;&amp;#x7684;&amp;#x95EE;&amp;#x9898;&amp;#xFF0C;&amp;#x5C31;&amp;#x662F;&amp;#x5F53;&amp;#x4F7F;&amp;#x7528;&amp;#x903B;&amp;#x8F91;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x6BD4;&amp;#x5982;device mapper&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x6765;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8BE5;&amp;#x8F6F;raid&amp;#x7684;&amp;#x5927;&amp;#x5757;&amp;#x8BFB;&amp;#x5199;&amp;#xFF0C;&amp;#x90FD;&amp;#x4F1A;&amp;#x88AB;&amp;#x62C6;&amp;#x5206;&amp;#x4E3A;4k&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x7684;io&amp;#xFF1B;&amp;#x800C;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#xFF08;&amp;#x5982;sdb&amp;#xFF0C;sdc&amp;#xFF0C;vdb&amp;#xFF0C;vdc&amp;#x8FD9;&amp;#x79CD;&amp;#x8BBE;&amp;#x5907;&amp;#xFF09;&amp;#x6765;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid&amp;#x8BBE;&amp;#x5907;&amp;#x65F6;&amp;#xFF0C;&amp;#x5BF9;&amp;#x8BE5;&amp;#x8F6F;raid&amp;#x7684;&amp;#x5927;&amp;#x5757;&amp;#x8BFB;&amp;#x5199;&amp;#x5C31;&amp;#x4E0D;&amp;#x4F1A;&amp;#x6709;io&amp;#x62C6;&amp;#x5206;&amp;#x95EE;&amp;#x9898;&amp;#x3002;&amp;#x4E0B;&amp;#x9762;&amp;#x4EE5;&amp;#x4F8B;&amp;#x5B50;&amp;#x8BF4;&amp;#x660E;&amp;#x8FD9;&amp;#x4E2A;&amp;#x73B0;&amp;#x8C61;&amp;#xFF08;&amp;#x4EE5;raid1&amp;#xFF0C;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#x4E3A;&amp;#x4F8B;&amp;#xFF09;&amp;#x3002;&lt;/p&gt;
&lt;h1 id=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot;&gt;&lt;a href=&quot;#&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&quot;&gt;&lt;/a&gt;&amp;#x60C5;&amp;#x5F62;&amp;#x4E00;&amp;#xFF1A;&amp;#x4F7F;&amp;#x7528;&amp;#x88F8;&amp;#x8BBE;&amp;#x5907;&amp;#x521B;&amp;#x5EFA;&amp;#x8F6F;raid1&lt;/h1&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# mdadm &amp;#x2013;create /dev/md/md_test1 &amp;#x2013;run &amp;#x2013;force &amp;#x2013;metadata=0.9 &amp;#x2013;assume-clean &amp;#x2013;level=1 &amp;#x2013;raid-devices=2 /dev/vdb /dev/vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cat /proc/mdstat&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Personalities : [raid1]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;md127 : active (auto-read-only) raid1 vdc[1] vdb[0]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      20971456 blocks [2/2] [UU]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x4F7F;&amp;#x7528;fio&amp;#x5BF9;&amp;#x8BE5;raid1&amp;#x8FDB;&amp;#x884C;&amp;#x968F;&amp;#x673A;&amp;#x5199;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF08;&amp;#x987A;&amp;#x5E8F;&amp;#x5199;&amp;#x4E5F;&amp;#x662F;&amp;#x4E00;&amp;#x6837;&amp;#x7684;&amp;#xFF09;&amp;#xFF0C;&amp;#x5757;&amp;#x5927;&amp;#x5C0F;&amp;#x4E3A;64KB&amp;#xFF0C;fio&amp;#x7684;&amp;#x914D;&amp;#x7F6E;&amp;#x5982;&amp;#x4E0B;:&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[global]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rw=randwrite&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;direct=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;numjobs=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ioengine=sync&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bsrange=64k-64k&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rate_iops=60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time_based&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;runtime=120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;group_reporting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[disk00]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;filename=/dev/md127&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;fio&amp;#x5199;io&amp;#x8FC7;&amp;#x7A0B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x4F7F;&amp;#x7528;iostat&amp;#x67E5;&amp;#x770B;&amp;#x8BBE;&amp;#x5907;&amp;#x7684;io&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#iostat -mx 2 md127 vdb vdc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/05/03/systemtap-analysis-mdraid-io/con1-iostat.png&quot; alt=&quot;con1-iostat&quot;&gt;&lt;br&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x770B;&amp;#x5230;avgrq-sz&amp;#x4E3A;128&amp;#xFF0C;&amp;#x5355;&amp;#x4F4D;&amp;#x662F;&amp;#x6247;&amp;#x533A;&amp;#xFF0C;&amp;#x4E5F;&amp;#x5C31;&amp;#x662F;64KB&amp;#xFF0C;&amp;#x8BF4;&amp;#x660E;io&amp;#x5E76;&amp;#x6CA1;&amp;#x6709;&amp;#x8FDB;&amp;#x884C;&amp;#x62C6;&amp;#x5206;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="storage" scheme="http://yoursite.com/categories/storage/"/>
    
    
      <category term="storage" scheme="http://yoursite.com/tags/storage/"/>
    
      <category term="mdraid" scheme="http://yoursite.com/tags/mdraid/"/>
    
  </entry>
  
</feed>
